[["visu.html", "第 6 章 数据可视化 6.1 从一个可以画恐龙的包说起 6.2 数据可视化的目的 6.3 图形语法（Grammar of Graphics） 6.4 ggplot2 6.5 ggplot2辅助 6.6 动图 6.7 大屏", " 第 6 章 数据可视化 人都是视觉动物。 6.1 从一个可以画恐龙的包说起 在闲逛R论坛的时候，偶然发现有人贴了一段如下的代码，这个代码可以画出一个恐龙。 # install.packages(&quot;datasauRus&quot;) library(&quot;datasauRus&quot;) library(ggplot2) ggplot(subset(datasaurus_dozen, dataset==&#39;dino&#39;), aes(x, y)) + geom_point() 太神奇了吧，居然有人写了个包来画恐龙！但是仔细一想，这事儿可能没有那么简单。事出非常必有妖，谁会闲到辛辛苦苦发布一个R包就为了画个恐龙呢。 果然datasauRus是一个非常有名的数据包，他包括了若干组描述性统计完全一致，但是分布却截然不同的数据集，恰恰说明了可视化的必要性。 详情可见论文，*Same Stats, Different Graphs: Generating Datasets with Varied Appearance and Identical Statistics through Simulated Annealing** library(datasauRus) library(dplyr) ## ## Attaching package: &#39;dplyr&#39; ## The following objects are masked from &#39;package:stats&#39;: ## ## filter, lag ## The following objects are masked from &#39;package:base&#39;: ## ## intersect, setdiff, setequal, union datasaurus_dozen %&gt;% dplyr::group_by(dataset) %&gt;% dplyr::summarise( mean_x = mean(x), mean_y = mean(y), std_dev_x = sd(x), std_dev_y = sd(y), corr_x_y = cor(x, y)) ## # A tibble: 13 × 6 ## dataset mean_x mean_y std_dev_x std_dev_y corr_x_y ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 away 54.3 47.8 16.8 26.9 -0.0641 ## 2 bullseye 54.3 47.8 16.8 26.9 -0.0686 ## 3 circle 54.3 47.8 16.8 26.9 -0.0683 ## 4 dino 54.3 47.8 16.8 26.9 -0.0645 ## 5 dots 54.3 47.8 16.8 26.9 -0.0603 ## 6 h_lines 54.3 47.8 16.8 26.9 -0.0617 ## 7 high_lines 54.3 47.8 16.8 26.9 -0.0685 ## 8 slant_down 54.3 47.8 16.8 26.9 -0.0690 ## 9 slant_up 54.3 47.8 16.8 26.9 -0.0686 ## 10 star 54.3 47.8 16.8 26.9 -0.0630 ## 11 v_lines 54.3 47.8 16.8 26.9 -0.0694 ## 12 wide_lines 54.3 47.8 16.8 26.9 -0.0666 ## 13 x_shape 54.3 47.8 16.8 26.9 -0.0656 6.2 数据可视化的目的 数据可视化的目的是直观地向读者传递数据中包含的信息。重要的事情说三遍，传递信息、传递信息、传递信息！ 因此，一个优秀的可视化应该具备以下的特征。 重点突出。要让读者第一眼就能发现你要传达的主要信息，而不是暗戳戳的隐藏起来，等待别人发现。 表意清晰。主要信息的传递要明确清晰，不要产生歧义，让读者自行发挥。充分利用注释、标题等来避免歧义。 信息量大。图形的标题、注释都可以传达信息，在有限的图形内，尽可能传递更多信息。 逻辑完整。数据传递的信息要有逻辑，能够独立阅读。 美观。尽可能增强图形的美学水平，让读者愿意看，看着舒服，愿意分享。 6.3 图形语法（Grammar of Graphics） 图形语法（Grammar of Graphics，简称GG）是Leland Wilkinson开发的一套用来描述所有统计图表深层特性的语法规则，该语法回答了什么是统计图表这一问题，以自底向上的方式组织最基本的元素形成更高级的元素。在GG看来，一张图就是从数据到几何标记对象的图形属性的一组映射，此外图形中还可能包含数据的统计变换，最后绘制在某个特定的坐标系中。此时，科学绘图就会非常接近画油画，绘图的过程就是在一张空白的画布上，一层一层地叠加图形要素。 粗略地，GG拆解的主要图形要素可以分为三大类：几何对象、美术属性与标签注释。 几何对象指的是将数据映射到图形之后的几何类型，包括点（point）、线（line）、直方（histgram）、柱（bar）等。 美术属性指的是几何对象呈现在图形中的属性，例如颜色（color）、形状（shape）、尺寸（size）、透明度（alpha）等。属性让同一类几何对象传递更加丰富的信息。 标签注释包括标题（title）、轴标题（x/y title）、轴标签（xlab/ylab）、文本标签（text label）、注释（note）、图例（legend）等。可以进一步丰富图形传达的信息。 通过图形语法可以实现统计绘图的自动化，满足可复现原则与一次原则。 更多关于GG的内容，可以参考Wilkinson的著作The Grammar of Graphics。 6.4 ggplot2 讲GG在R语言中实现的又是我们熟悉的大神Wickham，他设计了ggplot2包，ggplot2及其家族现在已经成为统制图的最佳工具。 我们看下发表在经济学人杂志的一篇文章中的图片，图片来源http://www.economist.com/node/21541178。 这幅图首先在视觉呈现非常美观，然后信息传达非常丰富，几乎所有的图形要素都被利用了起来。可以分类总结如下。 本节的任务就是逐步学习ggplot2的要素，并画出此图。教学材料源自哈佛大学IQSS。 6.5 ggplot2辅助 6.5.1 调色板 选择优雅的颜色是高质量数据可视化的保障。如果不是艺术造诣很高的话，选择成熟的配色是最安全的选择。ggthemes包封装了多种成熟的主题，ggsci则包括了多种杂志的配色方案，我们可以使用scales包的show_col函数来查看色号。 例如，我们要查看并使用经济学人杂志的调色板，可以用下面的代码 library(ggthemes) library(scales) library(ggsci) show_col(economist_pal()(9)) economist_pal()(9) ## [1] &quot;#6794a7&quot; &quot;#014d64&quot; &quot;#01a2d9&quot; &quot;#7ad2f6&quot; &quot;#00887d&quot; &quot;#76c0c1&quot; &quot;#7c260b&quot; ## [8] &quot;#ee8f71&quot; &quot;#adadad&quot; 如果要使用science杂志的配色，可以用下面的代码。 show_col(pal_aaas()(9)) pal_aaas()(9) ## [1] &quot;#3B4992FF&quot; &quot;#EE0000FF&quot; &quot;#008B45FF&quot; &quot;#631879FF&quot; &quot;#008280FF&quot; &quot;#BB0021FF&quot; ## [7] &quot;#5F559BFF&quot; &quot;#A20056FF&quot; &quot;#808180FF&quot; 当然，艺术造诣和编程能力并不是互斥的技能点。例如，R语言社区资深开发者（ggplot2包的作者）、计算认知科学家Danielle Navarro就是一名计算艺术家（computational artist）。下面是她的作品Dancer，更多作品可以浏览https://art.djnavarro.net/。 6.6 动图 6.7 大屏 6.7.1 交互式 "]]
