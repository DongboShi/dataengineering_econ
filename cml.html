<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>第 10 章 命令行 | 数据工程讲义：经济学分册</title>
  <meta name="description" content="适用于数据工程与数据科学课程的教材。" />
  <meta name="generator" content="bookdown 0.30 and GitBook 2.6.7" />

  <meta property="og:title" content="第 10 章 命令行 | 数据工程讲义：经济学分册" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="适用于数据工程与数据科学课程的教材。" />
  <meta name="github-repo" content="yihui/bookdown-chinese" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="第 10 章 命令行 | 数据工程讲义：经济学分册" />
  
  <meta name="twitter:description" content="适用于数据工程与数据科学课程的教材。" />
  

<meta name="author" content="史冬波 续本达" />


<meta name="date" content="2023-11-26" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="regexp.html"/>
<link rel="next" href="web.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.10/grViz.js"></script>
<script src="libs/plotly-binding-4.10.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.5.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">数据工程讲义</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>前言</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#致谢"><i class="fa fa-check"></i>致谢</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="author.html"><a href="author.html"><i class="fa fa-check"></i>作者简介</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> 写在前面</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#为什么写本书"><i class="fa fa-check"></i><b>1.1</b> 为什么写本书</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#如何使用本书"><i class="fa fa-check"></i><b>1.2</b> 如何使用本书</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="flow.html"><a href="flow.html"><i class="fa fa-check"></i><b>2</b> 数据工程：重塑经济学研究的流程</a>
<ul>
<li class="chapter" data-level="2.1" data-path="flow.html"><a href="flow.html#人工智能时代的社会科学研究机遇与挑战"><i class="fa fa-check"></i><b>2.1</b> 人工智能时代的社会科学研究：机遇与挑战</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="flow.html"><a href="flow.html#社会科学的三圈分类"><i class="fa fa-check"></i><b>2.1.1</b> 社会科学的三圈分类</a></li>
<li class="chapter" data-level="2.1.2" data-path="flow.html"><a href="flow.html#ai智能发展的三要素"><i class="fa fa-check"></i><b>2.1.2</b> AI智能发展的三要素</a></li>
<li class="chapter" data-level="2.1.3" data-path="flow.html"><a href="flow.html#ai对社会科学研究的冲击"><i class="fa fa-check"></i><b>2.1.3</b> AI对社会科学研究的冲击</a></li>
<li class="chapter" data-level="2.1.4" data-path="flow.html"><a href="flow.html#ai为社会科学研究创造的机遇"><i class="fa fa-check"></i><b>2.1.4</b> AI为社会科学研究创造的机遇</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="flow.html"><a href="flow.html#数据工程与数据科学"><i class="fa fa-check"></i><b>2.2</b> 数据工程与数据科学</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="flow.html"><a href="flow.html#数据工程的灵魂数据流"><i class="fa fa-check"></i><b>2.2.1</b> 数据工程的灵魂：数据流</a></li>
<li class="chapter" data-level="2.2.2" data-path="flow.html"><a href="flow.html#数据工程的钥匙数据结构"><i class="fa fa-check"></i><b>2.2.2</b> 数据工程的钥匙：数据结构</a></li>
<li class="chapter" data-level="2.2.3" data-path="flow.html"><a href="flow.html#数据工程师的工具箱"><i class="fa fa-check"></i><b>2.2.3</b> 数据工程师的工具箱</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="flow.html"><a href="flow.html#数据工程的四个指导原则"><i class="fa fa-check"></i><b>2.3</b> 数据工程的四个指导原则</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="flow.html"><a href="flow.html#可复现性原则"><i class="fa fa-check"></i><b>2.3.1</b> 可复现性原则</a></li>
<li class="chapter" data-level="2.3.2" data-path="flow.html"><a href="flow.html#模块化与正交分解原则"><i class="fa fa-check"></i><b>2.3.2</b> 模块化与正交分解原则</a></li>
<li class="chapter" data-level="2.3.3" data-path="flow.html"><a href="flow.html#最佳工具原则"><i class="fa fa-check"></i><b>2.3.3</b> 最佳工具原则</a></li>
<li class="chapter" data-level="2.3.4" data-path="flow.html"><a href="flow.html#一次原则"><i class="fa fa-check"></i><b>2.3.4</b> 一次原则</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="flow.html"><a href="flow.html#gnu-环境"><i class="fa fa-check"></i><b>2.4</b> GNU 环境</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="flow.html"><a href="flow.html#posix"><i class="fa fa-check"></i><b>2.4.1</b> POSIX</a></li>
<li class="chapter" data-level="2.4.2" data-path="flow.html"><a href="flow.html#gnu"><i class="fa fa-check"></i><b>2.4.2</b> GNU</a></li>
<li class="chapter" data-level="2.4.3" data-path="flow.html"><a href="flow.html#命令行"><i class="fa fa-check"></i><b>2.4.3</b> 命令行</a></li>
<li class="chapter" data-level="2.4.4" data-path="flow.html"><a href="flow.html#编辑器"><i class="fa fa-check"></i><b>2.4.4</b> 编辑器</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="flow.html"><a href="flow.html#版本控制"><i class="fa fa-check"></i><b>2.5</b> 版本控制</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="flow.html"><a href="flow.html#git"><i class="fa fa-check"></i><b>2.5.1</b> Git</a></li>
<li class="chapter" data-level="2.5.2" data-path="flow.html"><a href="flow.html#git的三种状态"><i class="fa fa-check"></i><b>2.5.2</b> Git的三种状态</a></li>
<li class="chapter" data-level="2.5.3" data-path="flow.html"><a href="flow.html#git仓库"><i class="fa fa-check"></i><b>2.5.3</b> Git仓库</a></li>
<li class="chapter" data-level="2.5.4" data-path="flow.html"><a href="flow.html#git命令实践"><i class="fa fa-check"></i><b>2.5.4</b> Git命令实践</a></li>
<li class="chapter" data-level="2.5.5" data-path="flow.html"><a href="flow.html#git目前的局限性"><i class="fa fa-check"></i><b>2.5.5</b> Git目前的局限性</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="basic.html"><a href="basic.html"><i class="fa fa-check"></i><b>3</b> R语言基础</a>
<ul>
<li class="chapter" data-level="3.1" data-path="basic.html"><a href="basic.html#r语言简介"><i class="fa fa-check"></i><b>3.1</b> R语言简介</a></li>
<li class="chapter" data-level="3.2" data-path="basic.html"><a href="basic.html#r语言的特点"><i class="fa fa-check"></i><b>3.2</b> R语言的特点</a></li>
<li class="chapter" data-level="3.3" data-path="basic.html"><a href="basic.html#r与rtudio的安装"><i class="fa fa-check"></i><b>3.3</b> R与Rtudio的安装</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="basic.html"><a href="basic.html#安装r"><i class="fa fa-check"></i><b>3.3.1</b> 安装R</a></li>
<li class="chapter" data-level="3.3.2" data-path="basic.html"><a href="basic.html#在wsl上安装r语言"><i class="fa fa-check"></i><b>3.3.2</b> 在WSL上安装R语言</a></li>
<li class="chapter" data-level="3.3.3" data-path="basic.html"><a href="basic.html#r安装rstudio"><i class="fa fa-check"></i><b>3.3.3</b> R安装RStudio</a></li>
<li class="chapter" data-level="3.3.4" data-path="basic.html"><a href="basic.html#组织r代码的三种方式"><i class="fa fa-check"></i><b>3.3.4</b> 组织R代码的三种方式</a></li>
<li class="chapter" data-level="3.3.5" data-path="basic.html"><a href="basic.html#r代码的组成"><i class="fa fa-check"></i><b>3.3.5</b> R代码的组成</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="basic.html"><a href="basic.html#r对文件和路径的相关操作"><i class="fa fa-check"></i><b>3.4</b> R对文件和路径的相关操作</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="basic.html"><a href="basic.html#路径操作"><i class="fa fa-check"></i><b>3.4.1</b> 路径操作</a></li>
<li class="chapter" data-level="3.4.2" data-path="basic.html"><a href="basic.html#文件操作"><i class="fa fa-check"></i><b>3.4.2</b> 文件操作</a></li>
<li class="chapter" data-level="3.4.3" data-path="basic.html"><a href="basic.html#特殊路径"><i class="fa fa-check"></i><b>3.4.3</b> 特殊路径</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="basic.html"><a href="basic.html#数据类型"><i class="fa fa-check"></i><b>3.5</b> 数据类型</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="basic.html"><a href="basic.html#数值型"><i class="fa fa-check"></i><b>3.5.1</b> 数值型</a></li>
<li class="chapter" data-level="3.5.2" data-path="basic.html"><a href="basic.html#逻辑型布尔型"><i class="fa fa-check"></i><b>3.5.2</b> 逻辑型/布尔型</a></li>
<li class="chapter" data-level="3.5.3" data-path="basic.html"><a href="basic.html#字符型"><i class="fa fa-check"></i><b>3.5.3</b> 字符型</a></li>
<li class="chapter" data-level="3.5.4" data-path="basic.html"><a href="basic.html#缺失值"><i class="fa fa-check"></i><b>3.5.4</b> 缺失值</a></li>
<li class="chapter" data-level="3.5.5" data-path="basic.html"><a href="basic.html#数据类型判断与转换"><i class="fa fa-check"></i><b>3.5.5</b> 数据类型判断与转换</a></li>
<li class="chapter" data-level="3.5.6" data-path="basic.html"><a href="basic.html#运算"><i class="fa fa-check"></i><b>3.5.6</b> 运算</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="basic.html"><a href="basic.html#变量"><i class="fa fa-check"></i><b>3.6</b> 变量</a></li>
<li class="chapter" data-level="3.7" data-path="basic.html"><a href="basic.html#数据结构"><i class="fa fa-check"></i><b>3.7</b> 数据结构</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="basic.html"><a href="basic.html#向量"><i class="fa fa-check"></i><b>3.7.1</b> 向量</a></li>
<li class="chapter" data-level="3.7.2" data-path="basic.html"><a href="basic.html#因子"><i class="fa fa-check"></i><b>3.7.2</b> 因子</a></li>
<li class="chapter" data-level="3.7.3" data-path="basic.html"><a href="basic.html#矩阵"><i class="fa fa-check"></i><b>3.7.3</b> 矩阵</a></li>
<li class="chapter" data-level="3.7.4" data-path="basic.html"><a href="basic.html#数据框"><i class="fa fa-check"></i><b>3.7.4</b> 数据框</a></li>
<li class="chapter" data-level="3.7.5" data-path="basic.html"><a href="basic.html#列表"><i class="fa fa-check"></i><b>3.7.5</b> 列表</a></li>
<li class="chapter" data-level="3.7.6" data-path="basic.html"><a href="basic.html#数据结构之间的转化"><i class="fa fa-check"></i><b>3.7.6</b> 数据结构之间的转化</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="basic.html"><a href="basic.html#数据读写"><i class="fa fa-check"></i><b>3.8</b> 数据读写</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="basic.html"><a href="basic.html#csv文件"><i class="fa fa-check"></i><b>3.8.1</b> csv文件</a></li>
<li class="chapter" data-level="3.8.2" data-path="basic.html"><a href="basic.html#hdf5"><i class="fa fa-check"></i><b>3.8.2</b> HDF5</a></li>
<li class="chapter" data-level="3.8.3" data-path="basic.html"><a href="basic.html#xml"><i class="fa fa-check"></i><b>3.8.3</b> XML</a></li>
<li class="chapter" data-level="3.8.4" data-path="basic.html"><a href="basic.html#json"><i class="fa fa-check"></i><b>3.8.4</b> JSON</a></li>
<li class="chapter" data-level="3.8.5" data-path="basic.html"><a href="basic.html#yaml"><i class="fa fa-check"></i><b>3.8.5</b> YAML</a></li>
<li class="chapter" data-level="3.8.6" data-path="basic.html"><a href="basic.html#专用数据文件"><i class="fa fa-check"></i><b>3.8.6</b> 专用数据文件</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="basic.html"><a href="basic.html#流程控制"><i class="fa fa-check"></i><b>3.9</b> 流程控制</a>
<ul>
<li class="chapter" data-level="3.9.1" data-path="basic.html"><a href="basic.html#条件判断"><i class="fa fa-check"></i><b>3.9.1</b> 条件判断</a></li>
<li class="chapter" data-level="3.9.2" data-path="basic.html"><a href="basic.html#循环"><i class="fa fa-check"></i><b>3.9.2</b> 循环</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="basic.html"><a href="basic.html#函数与包"><i class="fa fa-check"></i><b>3.10</b> 函数与包</a>
<ul>
<li class="chapter" data-level="3.10.1" data-path="basic.html"><a href="basic.html#函数的定义与调用"><i class="fa fa-check"></i><b>3.10.1</b> 函数的定义与调用</a></li>
<li class="chapter" data-level="3.10.2" data-path="basic.html"><a href="basic.html#变量作用域"><i class="fa fa-check"></i><b>3.10.2</b> 变量作用域</a></li>
<li class="chapter" data-level="3.10.3" data-path="basic.html"><a href="basic.html#函数模块化"><i class="fa fa-check"></i><b>3.10.3</b> 函数模块化</a></li>
<li class="chapter" data-level="3.10.4" data-path="basic.html"><a href="basic.html#包"><i class="fa fa-check"></i><b>3.10.4</b> 包</a></li>
</ul></li>
<li class="chapter" data-level="3.11" data-path="basic.html"><a href="basic.html#向量化"><i class="fa fa-check"></i><b>3.11</b> 向量化</a>
<ul>
<li class="chapter" data-level="3.11.1" data-path="basic.html"><a href="basic.html#apply"><i class="fa fa-check"></i><b>3.11.1</b> apply</a></li>
<li class="chapter" data-level="3.11.2" data-path="basic.html"><a href="basic.html#lapply"><i class="fa fa-check"></i><b>3.11.2</b> lapply</a></li>
<li class="chapter" data-level="3.11.3" data-path="basic.html"><a href="basic.html#sapply"><i class="fa fa-check"></i><b>3.11.3</b> sapply</a></li>
<li class="chapter" data-level="3.11.4" data-path="basic.html"><a href="basic.html#vapply"><i class="fa fa-check"></i><b>3.11.4</b> vapply</a></li>
<li class="chapter" data-level="3.11.5" data-path="basic.html"><a href="basic.html#mapply"><i class="fa fa-check"></i><b>3.11.5</b> mapply</a></li>
<li class="chapter" data-level="3.11.6" data-path="basic.html"><a href="basic.html#其他"><i class="fa fa-check"></i><b>3.11.6</b> 其他</a></li>
</ul></li>
<li class="chapter" data-level="3.12" data-path="basic.html"><a href="basic.html#代码风格"><i class="fa fa-check"></i><b>3.12</b> 代码风格</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="rmd.html"><a href="rmd.html"><i class="fa fa-check"></i><b>4</b> 文学式编程</a>
<ul>
<li class="chapter" data-level="4.1" data-path="rmd.html"><a href="rmd.html#什么是文学式编程"><i class="fa fa-check"></i><b>4.1</b> 什么是文学式编程</a></li>
<li class="chapter" data-level="4.2" data-path="rmd.html"><a href="rmd.html#markdown格式"><i class="fa fa-check"></i><b>4.2</b> Markdown格式</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="rmd.html"><a href="rmd.html#标题"><i class="fa fa-check"></i><b>4.2.1</b> 标题</a></li>
<li class="chapter" data-level="4.2.2" data-path="rmd.html"><a href="rmd.html#段落文本"><i class="fa fa-check"></i><b>4.2.2</b> 段落文本</a></li>
<li class="chapter" data-level="4.2.3" data-path="rmd.html"><a href="rmd.html#表格"><i class="fa fa-check"></i><b>4.2.3</b> 表格</a></li>
<li class="chapter" data-level="4.2.4" data-path="rmd.html"><a href="rmd.html#图片"><i class="fa fa-check"></i><b>4.2.4</b> 图片</a></li>
<li class="chapter" data-level="4.2.5" data-path="rmd.html"><a href="rmd.html#代码块"><i class="fa fa-check"></i><b>4.2.5</b> 代码块</a></li>
<li class="chapter" data-level="4.2.6" data-path="rmd.html"><a href="rmd.html#数学公式"><i class="fa fa-check"></i><b>4.2.6</b> 数学公式</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="rmd.html"><a href="rmd.html#rmarkdown"><i class="fa fa-check"></i><b>4.3</b> Rmarkdown</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="rmd.html"><a href="rmd.html#yaml头文件"><i class="fa fa-check"></i><b>4.3.1</b> YAML头文件</a></li>
<li class="chapter" data-level="4.3.2" data-path="rmd.html"><a href="rmd.html#代码块控制"><i class="fa fa-check"></i><b>4.3.2</b> 代码块控制</a></li>
<li class="chapter" data-level="4.3.3" data-path="rmd.html"><a href="rmd.html#rmarkdown特殊语法"><i class="fa fa-check"></i><b>4.3.3</b> Rmarkdown特殊语法</a></li>
<li class="chapter" data-level="4.3.4" data-path="rmd.html"><a href="rmd.html#格式转换"><i class="fa fa-check"></i><b>4.3.4</b> 格式转换</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="rmd.html"><a href="rmd.html#xaringan"><i class="fa fa-check"></i><b>4.4</b> Xaringan</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="rmd.html"><a href="rmd.html#安装与模板"><i class="fa fa-check"></i><b>4.4.1</b> 安装与模板</a></li>
<li class="chapter" data-level="4.4.2" data-path="rmd.html"><a href="rmd.html#其他学习资源"><i class="fa fa-check"></i><b>4.4.2</b> 其他学习资源</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="rmd.html"><a href="rmd.html#leanr"><i class="fa fa-check"></i><b>4.5</b> leanr</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="rmd.html"><a href="rmd.html#安装与模板-1"><i class="fa fa-check"></i><b>4.5.1</b> 安装与模板</a></li>
<li class="chapter" data-level="4.5.2" data-path="rmd.html"><a href="rmd.html#互动代码模块"><i class="fa fa-check"></i><b>4.5.2</b> 互动代码模块</a></li>
<li class="chapter" data-level="4.5.3" data-path="rmd.html"><a href="rmd.html#测试题"><i class="fa fa-check"></i><b>4.5.3</b> 测试题</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="rmd.html"><a href="rmd.html#bookdownblogdown以及pagedown"><i class="fa fa-check"></i><b>4.6</b> bookdown、blogdown以及pagedown</a></li>
<li class="chapter" data-level="4.7" data-path="rmd.html"><a href="rmd.html#quarto"><i class="fa fa-check"></i><b>4.7</b> Quarto</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="manipulate.html"><a href="manipulate.html"><i class="fa fa-check"></i><b>5</b> 数据整理</a>
<ul>
<li class="chapter" data-level="5.1" data-path="manipulate.html"><a href="manipulate.html#整齐数据tidydata"><i class="fa fa-check"></i><b>5.1</b> 整齐数据tidydata</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="manipulate.html"><a href="manipulate.html#分析单位unit-of-analysis"><i class="fa fa-check"></i><b>5.1.1</b> 分析单位(unit of analysis)</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="manipulate.html"><a href="manipulate.html#整齐数据"><i class="fa fa-check"></i><b>5.2</b> 整齐数据</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="manipulate.html"><a href="manipulate.html#整齐数据的缘起"><i class="fa fa-check"></i><b>5.2.1</b> 整齐数据的缘起</a></li>
<li class="chapter" data-level="5.2.2" data-path="manipulate.html"><a href="manipulate.html#整齐数据的定义"><i class="fa fa-check"></i><b>5.2.2</b> 整齐数据的定义</a></li>
<li class="chapter" data-level="5.2.3" data-path="manipulate.html"><a href="manipulate.html#数据的凌乱点"><i class="fa fa-check"></i><b>5.2.3</b> 数据的凌乱点</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="manipulate.html"><a href="manipulate.html#关系代数"><i class="fa fa-check"></i><b>5.3</b> 关系代数</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="manipulate.html"><a href="manipulate.html#sql语言"><i class="fa fa-check"></i><b>5.3.1</b> SQL语言</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="manipulate.html"><a href="manipulate.html#sqlite3"><i class="fa fa-check"></i><b>5.4</b> SQLite3</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="manipulate.html"><a href="manipulate.html#安装"><i class="fa fa-check"></i><b>5.4.1</b> 安装</a></li>
<li class="chapter" data-level="5.4.2" data-path="manipulate.html"><a href="manipulate.html#数据类型-1"><i class="fa fa-check"></i><b>5.4.2</b> 数据类型</a></li>
<li class="chapter" data-level="5.4.3" data-path="manipulate.html"><a href="manipulate.html#新建数据库与表格"><i class="fa fa-check"></i><b>5.4.3</b> 新建数据库与表格</a></li>
<li class="chapter" data-level="5.4.4" data-path="manipulate.html"><a href="manipulate.html#集合运算"><i class="fa fa-check"></i><b>5.4.4</b> 集合运算</a></li>
<li class="chapter" data-level="5.4.5" data-path="manipulate.html"><a href="manipulate.html#线性运算"><i class="fa fa-check"></i><b>5.4.5</b> 线性运算</a></li>
<li class="chapter" data-level="5.4.6" data-path="manipulate.html"><a href="manipulate.html#数据连接"><i class="fa fa-check"></i><b>5.4.6</b> 数据连接</a></li>
<li class="chapter" data-level="5.4.7" data-path="manipulate.html"><a href="manipulate.html#数据分组与汇总"><i class="fa fa-check"></i><b>5.4.7</b> 数据分组与汇总</a></li>
<li class="chapter" data-level="5.4.8" data-path="manipulate.html"><a href="manipulate.html#其他-1"><i class="fa fa-check"></i><b>5.4.8</b> 其他</a></li>
<li class="chapter" data-level="5.4.9" data-path="manipulate.html"><a href="manipulate.html#数据读写-1"><i class="fa fa-check"></i><b>5.4.9</b> 数据读写</a></li>
<li class="chapter" data-level="5.4.10" data-path="manipulate.html"><a href="manipulate.html#索引与键"><i class="fa fa-check"></i><b>5.4.10</b> 索引与键</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="manipulate.html"><a href="manipulate.html#mysql"><i class="fa fa-check"></i><b>5.5</b> MySQL</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="manipulate.html"><a href="manipulate.html#基本命令"><i class="fa fa-check"></i><b>5.5.1</b> 基本命令</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="manipulate.html"><a href="manipulate.html#postgresql"><i class="fa fa-check"></i><b>5.6</b> Postgresql</a></li>
<li class="chapter" data-level="5.7" data-path="manipulate.html"><a href="manipulate.html#dplyr"><i class="fa fa-check"></i><b>5.7</b> dplyr</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="manipulate.html"><a href="manipulate.html#集合运算-1"><i class="fa fa-check"></i><b>5.7.1</b> 集合运算</a></li>
<li class="chapter" data-level="5.7.2" data-path="manipulate.html"><a href="manipulate.html#线性运算-1"><i class="fa fa-check"></i><b>5.7.2</b> 线性运算</a></li>
<li class="chapter" data-level="5.7.3" data-path="manipulate.html"><a href="manipulate.html#管道"><i class="fa fa-check"></i><b>5.7.3</b> 管道</a></li>
<li class="chapter" data-level="5.7.4" data-path="manipulate.html"><a href="manipulate.html#数据连接-1"><i class="fa fa-check"></i><b>5.7.4</b> 数据连接</a></li>
<li class="chapter" data-level="5.7.5" data-path="manipulate.html"><a href="manipulate.html#数据分组与汇总-1"><i class="fa fa-check"></i><b>5.7.5</b> 数据分组与汇总</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="manipulate.html"><a href="manipulate.html#宽数据与长数据的转换"><i class="fa fa-check"></i><b>5.8</b> 宽数据与长数据的转换</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="manipulate.html"><a href="manipulate.html#宽数据转长数据"><i class="fa fa-check"></i><b>5.8.1</b> 宽数据转长数据</a></li>
<li class="chapter" data-level="5.8.2" data-path="manipulate.html"><a href="manipulate.html#长数据转宽数据"><i class="fa fa-check"></i><b>5.8.2</b> 长数据转宽数据</a></li>
<li class="chapter" data-level="5.8.3" data-path="manipulate.html"><a href="manipulate.html#联系人数据表的案例"><i class="fa fa-check"></i><b>5.8.3</b> 联系人数据表的案例</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="manipulate.html"><a href="manipulate.html#其他定制操作"><i class="fa fa-check"></i><b>5.9</b> 其他定制操作</a>
<ul>
<li class="chapter" data-level="5.9.1" data-path="manipulate.html"><a href="manipulate.html#排序"><i class="fa fa-check"></i><b>5.9.1</b> 排序</a></li>
<li class="chapter" data-level="5.9.2" data-path="manipulate.html"><a href="manipulate.html#抽样"><i class="fa fa-check"></i><b>5.9.2</b> 抽样</a></li>
<li class="chapter" data-level="5.9.3" data-path="manipulate.html"><a href="manipulate.html#去重复"><i class="fa fa-check"></i><b>5.9.3</b> 去重复</a></li>
<li class="chapter" data-level="5.9.4" data-path="manipulate.html"><a href="manipulate.html#缺失值处理"><i class="fa fa-check"></i><b>5.9.4</b> 缺失值处理</a></li>
<li class="chapter" data-level="5.9.5" data-path="manipulate.html"><a href="manipulate.html#拆分与合并数据列"><i class="fa fa-check"></i><b>5.9.5</b> 拆分与合并数据列</a></li>
<li class="chapter" data-level="5.9.6" data-path="manipulate.html"><a href="manipulate.html#合并数据"><i class="fa fa-check"></i><b>5.9.6</b> 合并数据</a></li>
</ul></li>
<li class="chapter" data-level="5.10" data-path="manipulate.html"><a href="manipulate.html#数据库的连接"><i class="fa fa-check"></i><b>5.10</b> 数据库的连接</a>
<ul>
<li class="chapter" data-level="5.10.1" data-path="manipulate.html"><a href="manipulate.html#r与数据库"><i class="fa fa-check"></i><b>5.10.1</b> R与数据库</a></li>
<li class="chapter" data-level="5.10.2" data-path="manipulate.html"><a href="manipulate.html#python与数据库"><i class="fa fa-check"></i><b>5.10.2</b> Python与数据库</a></li>
</ul></li>
<li class="chapter" data-level="5.11" data-path="manipulate.html"><a href="manipulate.html#data.table"><i class="fa fa-check"></i><b>5.11</b> data.table</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="visu.html"><a href="visu.html"><i class="fa fa-check"></i><b>6</b> 数据可视化</a>
<ul>
<li class="chapter" data-level="6.1" data-path="visu.html"><a href="visu.html#从一个可以画恐龙的包说起"><i class="fa fa-check"></i><b>6.1</b> 从一个可以画恐龙的包说起</a></li>
<li class="chapter" data-level="6.2" data-path="visu.html"><a href="visu.html#数据可视化的目的"><i class="fa fa-check"></i><b>6.2</b> 数据可视化的目的</a></li>
<li class="chapter" data-level="6.3" data-path="visu.html"><a href="visu.html#图形语法grammar-of-graphics"><i class="fa fa-check"></i><b>6.3</b> 图形语法（Grammar of Graphics）</a></li>
<li class="chapter" data-level="6.4" data-path="visu.html"><a href="visu.html#ggplot2"><i class="fa fa-check"></i><b>6.4</b> <code>ggplot2</code></a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="visu.html"><a href="visu.html#几何对象"><i class="fa fa-check"></i><b>6.4.1</b> 几何对象</a></li>
<li class="chapter" data-level="6.4.2" data-path="visu.html"><a href="visu.html#美术属性"><i class="fa fa-check"></i><b>6.4.2</b> 美术属性</a></li>
<li class="chapter" data-level="6.4.3" data-path="visu.html"><a href="visu.html#统计变换"><i class="fa fa-check"></i><b>6.4.3</b> 统计变换</a></li>
<li class="chapter" data-level="6.4.4" data-path="visu.html"><a href="visu.html#标尺"><i class="fa fa-check"></i><b>6.4.4</b> 标尺</a></li>
<li class="chapter" data-level="6.4.5" data-path="visu.html"><a href="visu.html#坐标系"><i class="fa fa-check"></i><b>6.4.5</b> 坐标系</a></li>
<li class="chapter" data-level="6.4.6" data-path="visu.html"><a href="visu.html#分面"><i class="fa fa-check"></i><b>6.4.6</b> 分面</a></li>
<li class="chapter" data-level="6.4.7" data-path="visu.html"><a href="visu.html#标签与图例"><i class="fa fa-check"></i><b>6.4.7</b> 标签与图例</a></li>
<li class="chapter" data-level="6.4.8" data-path="visu.html"><a href="visu.html#主题"><i class="fa fa-check"></i><b>6.4.8</b> 主题</a></li>
<li class="chapter" data-level="6.4.9" data-path="visu.html"><a href="visu.html#图例"><i class="fa fa-check"></i><b>6.4.9</b> 图例</a></li>
<li class="chapter" data-level="6.4.10" data-path="visu.html"><a href="visu.html#图形组合"><i class="fa fa-check"></i><b>6.4.10</b> 图形组合</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="visu.html"><a href="visu.html#调色板"><i class="fa fa-check"></i><b>6.5</b> 调色板</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="visu.html"><a href="visu.html#ggsci"><i class="fa fa-check"></i><b>6.5.1</b> ggsci</a></li>
<li class="chapter" data-level="6.5.2" data-path="visu.html"><a href="visu.html#colorspace"><i class="fa fa-check"></i><b>6.5.2</b> colorspace</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="visu.html"><a href="visu.html#动图"><i class="fa fa-check"></i><b>6.6</b> 动图</a></li>
<li class="chapter" data-level="6.7" data-path="visu.html"><a href="visu.html#交互图"><i class="fa fa-check"></i><b>6.7</b> 交互图</a></li>
<li class="chapter" data-level="6.8" data-path="visu.html"><a href="visu.html#数据大屏dashboard"><i class="fa fa-check"></i><b>6.8</b> 数据大屏Dashboard</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="visu.html"><a href="visu.html#flexdashboard安装"><i class="fa fa-check"></i><b>6.8.1</b> flexdashboard安装</a></li>
<li class="chapter" data-level="6.8.2" data-path="visu.html"><a href="visu.html#新建dashboard"><i class="fa fa-check"></i><b>6.8.2</b> 新建dashboard</a></li>
<li class="chapter" data-level="6.8.3" data-path="visu.html"><a href="visu.html#dashboard布局"><i class="fa fa-check"></i><b>6.8.3</b> dashboard布局</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="visu.html"><a href="visu.html#其他参考资料"><i class="fa fa-check"></i><b>6.9</b> 其他参考资料</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="reg.html"><a href="reg.html"><i class="fa fa-check"></i><b>7</b> 回归</a>
<ul>
<li class="chapter" data-level="7.1" data-path="reg.html"><a href="reg.html#一般线性回归"><i class="fa fa-check"></i><b>7.1</b> 一般线性回归</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="reg.html"><a href="reg.html#基础模型"><i class="fa fa-check"></i><b>7.1.1</b> 基础模型</a></li>
<li class="chapter" data-level="7.1.2" data-path="reg.html"><a href="reg.html#稳健性标准误"><i class="fa fa-check"></i><b>7.1.2</b> 稳健性标准误</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="reg.html"><a href="reg.html#因果推断的反事实框架"><i class="fa fa-check"></i><b>7.2</b> 因果推断的反事实框架</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="reg.html"><a href="reg.html#定义因果关系"><i class="fa fa-check"></i><b>7.2.1</b> 定义因果关系</a></li>
<li class="chapter" data-level="7.2.2" data-path="reg.html"><a href="reg.html#cef三定理"><i class="fa fa-check"></i><b>7.2.2</b> CEF三定理</a></li>
<li class="chapter" data-level="7.2.3" data-path="reg.html"><a href="reg.html#交互项还是分组回归"><i class="fa fa-check"></i><b>7.2.3</b> 交互项还是分组回归</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="reg.html"><a href="reg.html#匹配"><i class="fa fa-check"></i><b>7.3</b> 匹配</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="reg.html"><a href="reg.html#原理"><i class="fa fa-check"></i><b>7.3.1</b> 原理</a></li>
<li class="chapter" data-level="7.3.2" data-path="reg.html"><a href="reg.html#案例"><i class="fa fa-check"></i><b>7.3.2</b> 案例</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="reg.html"><a href="reg.html#工具变量"><i class="fa fa-check"></i><b>7.4</b> 工具变量</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="reg.html"><a href="reg.html#原理-1"><i class="fa fa-check"></i><b>7.4.1</b> 原理</a></li>
<li class="chapter" data-level="7.4.2" data-path="reg.html"><a href="reg.html#案例-1"><i class="fa fa-check"></i><b>7.4.2</b> 案例</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="reg.html"><a href="reg.html#双重差分"><i class="fa fa-check"></i><b>7.5</b> 双重差分</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="reg.html"><a href="reg.html#原理-2"><i class="fa fa-check"></i><b>7.5.1</b> 原理</a></li>
<li class="chapter" data-level="7.5.2" data-path="reg.html"><a href="reg.html#案例-2"><i class="fa fa-check"></i><b>7.5.2</b> 案例</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="reg.html"><a href="reg.html#断点回归"><i class="fa fa-check"></i><b>7.6</b> 断点回归</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="reg.html"><a href="reg.html#原理-3"><i class="fa fa-check"></i><b>7.6.1</b> 原理</a></li>
<li class="chapter" data-level="7.6.2" data-path="reg.html"><a href="reg.html#案例-3"><i class="fa fa-check"></i><b>7.6.2</b> 案例</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="reg.html"><a href="reg.html#包含高维分类变量的回归"><i class="fa fa-check"></i><b>7.7</b> 包含高维分类变量的回归</a></li>
<li class="chapter" data-level="7.8" data-path="reg.html"><a href="reg.html#formula-公式对象"><i class="fa fa-check"></i><b>7.8</b> formula (公式)对象</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="reg.html"><a href="reg.html#公式的生成"><i class="fa fa-check"></i><b>7.8.1</b> 公式的生成</a></li>
<li class="chapter" data-level="7.8.2" data-path="reg.html"><a href="reg.html#生成公式的运算符"><i class="fa fa-check"></i><b>7.8.2</b> 生成公式的运算符</a></li>
<li class="chapter" data-level="7.8.3" data-path="reg.html"><a href="reg.html#公式与字符串之间的转换"><i class="fa fa-check"></i><b>7.8.3</b> 公式与字符串之间的转换</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="reg.html"><a href="reg.html#表达式expression"><i class="fa fa-check"></i><b>7.9</b> 表达式expression</a></li>
<li class="chapter" data-level="7.10" data-path="reg.html"><a href="reg.html#表达式的生成与执行"><i class="fa fa-check"></i><b>7.10</b> 表达式的生成与执行</a></li>
<li class="chapter" data-level="7.11" data-path="reg.html"><a href="reg.html#表达式与字符串的转换"><i class="fa fa-check"></i><b>7.11</b> 表达式与字符串的转换</a></li>
<li class="chapter" data-level="7.12" data-path="reg.html"><a href="reg.html#使用stargazer输出表格"><i class="fa fa-check"></i><b>7.12</b> 使用stargazer输出表格</a>
<ul>
<li class="chapter" data-level="7.12.1" data-path="reg.html"><a href="reg.html#标准回归表"><i class="fa fa-check"></i><b>7.12.1</b> 标准回归表</a></li>
<li class="chapter" data-level="7.12.2" data-path="reg.html"><a href="reg.html#默认格式"><i class="fa fa-check"></i><b>7.12.2</b> 默认格式</a></li>
<li class="chapter" data-level="7.12.3" data-path="reg.html"><a href="reg.html#表格表头"><i class="fa fa-check"></i><b>7.12.3</b> 表格表头</a></li>
<li class="chapter" data-level="7.12.4" data-path="reg.html"><a href="reg.html#表格正文"><i class="fa fa-check"></i><b>7.12.4</b> 表格正文</a></li>
<li class="chapter" data-level="7.12.5" data-path="reg.html"><a href="reg.html#添加变量信息"><i class="fa fa-check"></i><b>7.12.5</b> 添加变量信息</a></li>
<li class="chapter" data-level="7.12.6" data-path="reg.html"><a href="reg.html#选择统计量"><i class="fa fa-check"></i><b>7.12.6</b> 选择统计量</a></li>
<li class="chapter" data-level="7.12.7" data-path="reg.html"><a href="reg.html#表格注释"><i class="fa fa-check"></i><b>7.12.7</b> 表格注释</a></li>
<li class="chapter" data-level="7.12.8" data-path="reg.html"><a href="reg.html#整体布局"><i class="fa fa-check"></i><b>7.12.8</b> 整体布局</a></li>
<li class="chapter" data-level="7.12.9" data-path="reg.html"><a href="reg.html#其他-2"><i class="fa fa-check"></i><b>7.12.9</b> 其他</a></li>
<li class="chapter" data-level="7.12.10" data-path="reg.html"><a href="reg.html#描述性统计表"><i class="fa fa-check"></i><b>7.12.10</b> 描述性统计表</a></li>
</ul></li>
<li class="chapter" data-level="7.13" data-path="reg.html"><a href="reg.html#回归结果的可视化"><i class="fa fa-check"></i><b>7.13</b> 回归结果的可视化</a>
<ul>
<li class="chapter" data-level="7.13.1" data-path="reg.html"><a href="reg.html#使用ggcoefstats可视化回归结果"><i class="fa fa-check"></i><b>7.13.1</b> 使用ggcoefstats可视化回归结果</a></li>
<li class="chapter" data-level="7.13.2" data-path="reg.html"><a href="reg.html#使用"><i class="fa fa-check"></i><b>7.13.2</b> 使用</a></li>
<li class="chapter" data-level="7.13.3" data-path="reg.html"><a href="reg.html#双重差分模型的可视化"><i class="fa fa-check"></i><b>7.13.3</b> 双重差分模型的可视化</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="py.html"><a href="py.html"><i class="fa fa-check"></i><b>8</b> Python基础</a>
<ul>
<li class="chapter" data-level="8.1" data-path="py.html"><a href="py.html#python简介"><i class="fa fa-check"></i><b>8.1</b> Python简介</a></li>
<li class="chapter" data-level="8.2" data-path="py.html"><a href="py.html#python安装与pycharm"><i class="fa fa-check"></i><b>8.2</b> Python安装与Pycharm</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="py.html"><a href="py.html#安装-2"><i class="fa fa-check"></i><b>8.2.1</b> 安装</a></li>
<li class="chapter" data-level="8.2.2" data-path="py.html"><a href="py.html#编辑器-1"><i class="fa fa-check"></i><b>8.2.2</b> 编辑器</a></li>
<li class="chapter" data-level="8.2.3" data-path="py.html"><a href="py.html#pycharm的安装与教育许可证"><i class="fa fa-check"></i><b>8.2.3</b> Pycharm的安装与教育许可证</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="py.html"><a href="py.html#变量-1"><i class="fa fa-check"></i><b>8.3</b> 变量</a></li>
<li class="chapter" data-level="8.4" data-path="py.html"><a href="py.html#数据类型-2"><i class="fa fa-check"></i><b>8.4</b> 数据类型</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="py.html"><a href="py.html#类型转换"><i class="fa fa-check"></i><b>8.4.1</b> 类型转换</a></li>
<li class="chapter" data-level="8.4.2" data-path="py.html"><a href="py.html#算术运算"><i class="fa fa-check"></i><b>8.4.2</b> 算术运算</a></li>
<li class="chapter" data-level="8.4.3" data-path="py.html"><a href="py.html#布尔运算"><i class="fa fa-check"></i><b>8.4.3</b> 布尔运算</a></li>
<li class="chapter" data-level="8.4.4" data-path="py.html"><a href="py.html#字符串"><i class="fa fa-check"></i><b>8.4.4</b> 字符串</a></li>
<li class="chapter" data-level="8.4.5" data-path="py.html"><a href="py.html#字符串的替换"><i class="fa fa-check"></i><b>8.4.5</b> 字符串的替换</a></li>
<li class="chapter" data-level="8.4.6" data-path="py.html"><a href="py.html#字符串的切片"><i class="fa fa-check"></i><b>8.4.6</b> 字符串的切片</a></li>
<li class="chapter" data-level="8.4.7" data-path="py.html"><a href="py.html#标准字符串操作"><i class="fa fa-check"></i><b>8.4.7</b> 标准字符串操作</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="py.html"><a href="py.html#标准输入输出"><i class="fa fa-check"></i><b>8.5</b> 标准输入输出</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="py.html"><a href="py.html#标准输入"><i class="fa fa-check"></i><b>8.5.1</b> 标准输入</a></li>
<li class="chapter" data-level="8.5.2" data-path="py.html"><a href="py.html#命令执行"><i class="fa fa-check"></i><b>8.5.2</b> 命令执行</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="py.html"><a href="py.html#数据结构-1"><i class="fa fa-check"></i><b>8.6</b> 数据结构</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="py.html"><a href="py.html#列表-1"><i class="fa fa-check"></i><b>8.6.1</b> 列表</a></li>
<li class="chapter" data-level="8.6.2" data-path="py.html"><a href="py.html#元组"><i class="fa fa-check"></i><b>8.6.2</b> 元组</a></li>
<li class="chapter" data-level="8.6.3" data-path="py.html"><a href="py.html#字典"><i class="fa fa-check"></i><b>8.6.3</b> 字典</a></li>
<li class="chapter" data-level="8.6.4" data-path="py.html"><a href="py.html#数据结构之间的转化-1"><i class="fa fa-check"></i><b>8.6.4</b> 数据结构之间的转化</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="py.html"><a href="py.html#流程控制-1"><i class="fa fa-check"></i><b>8.7</b> 流程控制</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="py.html"><a href="py.html#条件判断-1"><i class="fa fa-check"></i><b>8.7.1</b> 条件判断</a></li>
<li class="chapter" data-level="8.7.2" data-path="py.html"><a href="py.html#循环-1"><i class="fa fa-check"></i><b>8.7.2</b> 循环</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="py.html"><a href="py.html#函数与模块"><i class="fa fa-check"></i><b>8.8</b> 函数与模块</a>
<ul>
<li class="chapter" data-level="8.8.1" data-path="py.html"><a href="py.html#批量调用"><i class="fa fa-check"></i><b>8.8.1</b> 批量调用</a></li>
<li class="chapter" data-level="8.8.2" data-path="py.html"><a href="py.html#无名函数"><i class="fa fa-check"></i><b>8.8.2</b> 无名函数</a></li>
<li class="chapter" data-level="8.8.3" data-path="py.html"><a href="py.html#函数文档"><i class="fa fa-check"></i><b>8.8.3</b> 函数文档</a></li>
<li class="chapter" data-level="8.8.4" data-path="py.html"><a href="py.html#模块"><i class="fa fa-check"></i><b>8.8.4</b> 模块</a></li>
</ul></li>
<li class="chapter" data-level="8.9" data-path="py.html"><a href="py.html#数据读写与文件操作"><i class="fa fa-check"></i><b>8.9</b> 数据读写与文件操作</a>
<ul>
<li class="chapter" data-level="8.9.1" data-path="py.html"><a href="py.html#读入文件"><i class="fa fa-check"></i><b>8.9.1</b> 读入文件</a></li>
<li class="chapter" data-level="8.9.2" data-path="py.html"><a href="py.html#写出文件"><i class="fa fa-check"></i><b>8.9.2</b> 写出文件</a></li>
<li class="chapter" data-level="8.9.3" data-path="py.html"><a href="py.html#with关键字"><i class="fa fa-check"></i><b>8.9.3</b> with关键字</a></li>
</ul></li>
<li class="chapter" data-level="8.10" data-path="py.html"><a href="py.html#os模块"><i class="fa fa-check"></i><b>8.10</b> os模块</a></li>
<li class="chapter" data-level="8.11" data-path="py.html"><a href="py.html#python的环境配置"><i class="fa fa-check"></i><b>8.11</b> Python的环境配置</a></li>
<li class="chapter" data-level="8.12" data-path="py.html"><a href="py.html#案例获取高德地图地址信息"><i class="fa fa-check"></i><b>8.12</b> 案例：获取高德地图地址信息</a></li>
<li class="chapter" data-level="8.13" data-path="py.html"><a href="py.html#面向对象单独成一章"><i class="fa fa-check"></i><b>8.13</b> 面向对象单独成一章</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="regexp.html"><a href="regexp.html"><i class="fa fa-check"></i><b>9</b> 正则表达式</a>
<ul>
<li class="chapter" data-level="9.1" data-path="regexp.html"><a href="regexp.html#语法要素"><i class="fa fa-check"></i><b>9.1</b> 语法要素</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="regexp.html"><a href="regexp.html#元字符"><i class="fa fa-check"></i><b>9.1.1</b> 元字符</a></li>
<li class="chapter" data-level="9.1.2" data-path="regexp.html"><a href="regexp.html#重复"><i class="fa fa-check"></i><b>9.1.2</b> 重复</a></li>
<li class="chapter" data-level="9.1.3" data-path="regexp.html"><a href="regexp.html#常用字符集"><i class="fa fa-check"></i><b>9.1.3</b> 常用字符集</a></li>
<li class="chapter" data-level="9.1.4" data-path="regexp.html"><a href="regexp.html#分组"><i class="fa fa-check"></i><b>9.1.4</b> 分组</a></li>
<li class="chapter" data-level="9.1.5" data-path="regexp.html"><a href="regexp.html#非捕获组与断言"><i class="fa fa-check"></i><b>9.1.5</b> 非捕获组与断言</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="regexp.html"><a href="regexp.html#grep命令"><i class="fa fa-check"></i><b>9.2</b> grep命令</a></li>
<li class="chapter" data-level="9.3" data-path="regexp.html"><a href="regexp.html#sed命令"><i class="fa fa-check"></i><b>9.3</b> sed命令</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="regexp.html"><a href="regexp.html#应用情景"><i class="fa fa-check"></i><b>9.3.1</b> 应用情景</a></li>
<li class="chapter" data-level="9.3.2" data-path="regexp.html"><a href="regexp.html#文本替换"><i class="fa fa-check"></i><b>9.3.2</b> 文本替换</a></li>
<li class="chapter" data-level="9.3.3" data-path="regexp.html"><a href="regexp.html#定位行"><i class="fa fa-check"></i><b>9.3.3</b> 定位行</a></li>
<li class="chapter" data-level="9.3.4" data-path="regexp.html"><a href="regexp.html#替代"><i class="fa fa-check"></i><b>9.3.4</b> 替代</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="regexp.html"><a href="regexp.html#awk命令"><i class="fa fa-check"></i><b>9.4</b> awk命令</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="regexp.html"><a href="regexp.html#入门"><i class="fa fa-check"></i><b>9.4.1</b> 入门</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="regexp.html"><a href="regexp.html#r语言stringr包"><i class="fa fa-check"></i><b>9.5</b> R语言stringr包</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="regexp.html"><a href="regexp.html#stringr包"><i class="fa fa-check"></i><b>9.5.1</b> stringr包</a></li>
<li class="chapter" data-level="9.5.2" data-path="regexp.html"><a href="regexp.html#应用案例wos数据分析"><i class="fa fa-check"></i><b>9.5.2</b> 应用案例：wos数据分析</a></li>
<li class="chapter" data-level="9.5.3" data-path="regexp.html"><a href="regexp.html#应用案例数据合并与校对"><i class="fa fa-check"></i><b>9.5.3</b> 应用案例：数据合并与校对</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="regexp.html"><a href="regexp.html#python的re模块"><i class="fa fa-check"></i><b>9.6</b> Python的re模块</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="regexp.html"><a href="regexp.html#原生字符串"><i class="fa fa-check"></i><b>9.6.1</b> 原生字符串</a></li>
<li class="chapter" data-level="9.6.2" data-path="regexp.html"><a href="regexp.html#编译"><i class="fa fa-check"></i><b>9.6.2</b> 编译</a></li>
<li class="chapter" data-level="9.6.3" data-path="regexp.html"><a href="regexp.html#匹配-1"><i class="fa fa-check"></i><b>9.6.3</b> 匹配</a></li>
<li class="chapter" data-level="9.6.4" data-path="regexp.html"><a href="regexp.html#分割"><i class="fa fa-check"></i><b>9.6.4</b> 分割</a></li>
<li class="chapter" data-level="9.6.5" data-path="regexp.html"><a href="regexp.html#替换"><i class="fa fa-check"></i><b>9.6.5</b> 替换</a></li>
<li class="chapter" data-level="9.6.6" data-path="regexp.html"><a href="regexp.html#命名组"><i class="fa fa-check"></i><b>9.6.6</b> 命名组</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="cml.html"><a href="cml.html"><i class="fa fa-check"></i><b>10</b> 命令行</a>
<ul>
<li class="chapter" data-level="10.1" data-path="cml.html"><a href="cml.html#命令的基本概念"><i class="fa fa-check"></i><b>10.1</b> 命令的基本概念</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="cml.html"><a href="cml.html#fish"><i class="fa fa-check"></i><b>10.1.1</b> fish</a></li>
<li class="chapter" data-level="10.1.2" data-path="cml.html"><a href="cml.html#常用命令"><i class="fa fa-check"></i><b>10.1.2</b> 常用命令</a></li>
<li class="chapter" data-level="10.1.3" data-path="cml.html"><a href="cml.html#标准输入与输出"><i class="fa fa-check"></i><b>10.1.3</b> 标准输入与输出</a></li>
<li class="chapter" data-level="10.1.4" data-path="cml.html"><a href="cml.html#管道与进程管理"><i class="fa fa-check"></i><b>10.1.4</b> 管道与进程管理</a></li>
<li class="chapter" data-level="10.1.5" data-path="cml.html"><a href="cml.html#别名"><i class="fa fa-check"></i><b>10.1.5</b> 别名</a></li>
<li class="chapter" data-level="10.1.6" data-path="cml.html"><a href="cml.html#脚本"><i class="fa fa-check"></i><b>10.1.6</b> 脚本</a></li>
<li class="chapter" data-level="10.1.7" data-path="cml.html"><a href="cml.html#传参"><i class="fa fa-check"></i><b>10.1.7</b> 传参</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="cml.html"><a href="cml.html#变量与数据结构"><i class="fa fa-check"></i><b>10.2</b> 变量与数据结构</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="cml.html"><a href="cml.html#路径变量"><i class="fa fa-check"></i><b>10.2.1</b> 路径变量</a></li>
<li class="chapter" data-level="10.2.2" data-path="cml.html"><a href="cml.html#数组"><i class="fa fa-check"></i><b>10.2.2</b> 数组</a></li>
<li class="chapter" data-level="10.2.3" data-path="cml.html"><a href="cml.html#字典-1"><i class="fa fa-check"></i><b>10.2.3</b> 字典</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="cml.html"><a href="cml.html#运算-1"><i class="fa fa-check"></i><b>10.3</b> 运算</a></li>
<li class="chapter" data-level="10.4" data-path="cml.html"><a href="cml.html#控制流程"><i class="fa fa-check"></i><b>10.4</b> 控制流程</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="cml.html"><a href="cml.html#选择结构"><i class="fa fa-check"></i><b>10.4.1</b> 选择结构</a></li>
<li class="chapter" data-level="10.4.2" data-path="cml.html"><a href="cml.html#循环-2"><i class="fa fa-check"></i><b>10.4.2</b> 循环</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="cml.html"><a href="cml.html#函数"><i class="fa fa-check"></i><b>10.5</b> 函数</a></li>
<li class="chapter" data-level="10.6" data-path="cml.html"><a href="cml.html#linux文件与目录管理"><i class="fa fa-check"></i><b>10.6</b> Linux文件与目录管理</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="cml.html"><a href="cml.html#linux-链接"><i class="fa fa-check"></i><b>10.6.1</b> Linux 链接</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="cml.html"><a href="cml.html#应用案例"><i class="fa fa-check"></i><b>10.7</b> 应用案例</a></li>
<li class="chapter" data-level="10.8" data-path="cml.html"><a href="cml.html#通配符与bash内建正则表达式"><i class="fa fa-check"></i><b>10.8</b> 通配符与bash内建正则表达式</a></li>
<li class="chapter" data-level="10.9" data-path="cml.html"><a href="cml.html#grep命令-1"><i class="fa fa-check"></i><b>10.9</b> grep命令</a></li>
<li class="chapter" data-level="10.10" data-path="cml.html"><a href="cml.html#sed命令-1"><i class="fa fa-check"></i><b>10.10</b> sed命令</a>
<ul>
<li class="chapter" data-level="10.10.1" data-path="cml.html"><a href="cml.html#应用情景-1"><i class="fa fa-check"></i><b>10.10.1</b> 应用情景</a></li>
<li class="chapter" data-level="10.10.2" data-path="cml.html"><a href="cml.html#sed命令基本结构"><i class="fa fa-check"></i><b>10.10.2</b> sed命令基本结构</a></li>
<li class="chapter" data-level="10.10.3" data-path="cml.html"><a href="cml.html#s命令substitute"><i class="fa fa-check"></i><b>10.10.3</b> s命令（substitute）</a></li>
<li class="chapter" data-level="10.10.4" data-path="cml.html"><a href="cml.html#d命令deletep命令print和n命令next"><i class="fa fa-check"></i><b>10.10.4</b> d命令（delete）、p命令（print）和n命令（next）</a></li>
<li class="chapter" data-level="10.10.5" data-path="cml.html"><a href="cml.html#地址规范"><i class="fa fa-check"></i><b>10.10.5</b> 地址规范</a></li>
<li class="chapter" data-level="10.10.6" data-path="cml.html"><a href="cml.html#q和q命令quit"><i class="fa fa-check"></i><b>10.10.6</b> q和Q命令（quit）</a></li>
<li class="chapter" data-level="10.10.7" data-path="cml.html"><a href="cml.html#y命令"><i class="fa fa-check"></i><b>10.10.7</b> y命令</a></li>
<li class="chapter" data-level="10.10.8" data-path="cml.html"><a href="cml.html#ia和c命令insert-append-change"><i class="fa fa-check"></i><b>10.10.8</b> i、a和c命令（insert, append, change）</a></li>
<li class="chapter" data-level="10.10.9" data-path="cml.html"><a href="cml.html#命令l命令和z命令zap"><i class="fa fa-check"></i><b>10.10.9</b> =命令、l命令和z命令（zap）</a></li>
</ul></li>
<li class="chapter" data-level="10.11" data-path="cml.html"><a href="cml.html#awk命令-1"><i class="fa fa-check"></i><b>10.11</b> awk命令</a>
<ul>
<li class="chapter" data-level="10.11.1" data-path="cml.html"><a href="cml.html#awk入门"><i class="fa fa-check"></i><b>10.11.1</b> awk入门</a></li>
<li class="chapter" data-level="10.11.2" data-path="cml.html"><a href="cml.html#awk工作原理"><i class="fa fa-check"></i><b>10.11.2</b> awk工作原理</a></li>
<li class="chapter" data-level="10.11.3" data-path="cml.html"><a href="cml.html#awk分隔符"><i class="fa fa-check"></i><b>10.11.3</b> awk分隔符</a></li>
<li class="chapter" data-level="10.11.4" data-path="cml.html"><a href="cml.html#awk变量"><i class="fa fa-check"></i><b>10.11.4</b> awk变量</a></li>
<li class="chapter" data-level="10.11.5" data-path="cml.html"><a href="cml.html#printf输出格式化"><i class="fa fa-check"></i><b>10.11.5</b> printf输出格式化</a></li>
<li class="chapter" data-level="10.11.6" data-path="cml.html"><a href="cml.html#awk模式"><i class="fa fa-check"></i><b>10.11.6</b> awk模式</a></li>
<li class="chapter" data-level="10.11.7" data-path="cml.html"><a href="cml.html#流程控制-2"><i class="fa fa-check"></i><b>10.11.7</b> 流程控制</a></li>
<li class="chapter" data-level="10.11.8" data-path="cml.html"><a href="cml.html#awk数组"><i class="fa fa-check"></i><b>10.11.8</b> awk数组</a></li>
<li class="chapter" data-level="10.11.9" data-path="cml.html"><a href="cml.html#awk内置函数"><i class="fa fa-check"></i><b>10.11.9</b> awk内置函数</a></li>
<li class="chapter" data-level="10.11.10" data-path="cml.html"><a href="cml.html#排序函数"><i class="fa fa-check"></i><b>10.11.10</b> 排序函数</a></li>
</ul></li>
<li class="chapter" data-level="10.12" data-path="cml.html"><a href="cml.html#数据驱动的编程"><i class="fa fa-check"></i><b>10.12</b> 数据驱动的编程</a></li>
<li class="chapter" data-level="10.13" data-path="cml.html"><a href="cml.html#r的命令行选项"><i class="fa fa-check"></i><b>10.13</b> R的命令行选项</a>
<ul>
<li class="chapter" data-level="10.13.1" data-path="cml.html"><a href="cml.html#linuxunix-shebang"><i class="fa fa-check"></i><b>10.13.1</b> Linux/Unix Shebang</a></li>
<li class="chapter" data-level="10.13.2" data-path="cml.html"><a href="cml.html#argparse包实例"><i class="fa fa-check"></i><b>10.13.2</b> argparse包实例</a></li>
</ul></li>
<li class="chapter" data-level="10.14" data-path="cml.html"><a href="cml.html#关于命令行与ide"><i class="fa fa-check"></i><b>10.14</b> 关于命令行与IDE</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="web.html"><a href="web.html"><i class="fa fa-check"></i><b>11</b> 网络数据采集</a>
<ul>
<li class="chapter" data-level="11.1" data-path="web.html"><a href="web.html#网络数据格式"><i class="fa fa-check"></i><b>11.1</b> 网络数据格式</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="web.html"><a href="web.html#csv"><i class="fa fa-check"></i><b>11.1.1</b> CSV</a></li>
<li class="chapter" data-level="11.1.2" data-path="web.html"><a href="web.html#xml-1"><i class="fa fa-check"></i><b>11.1.2</b> XML</a></li>
<li class="chapter" data-level="11.1.3" data-path="web.html"><a href="web.html#json-1"><i class="fa fa-check"></i><b>11.1.3</b> JSON</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="web.html"><a href="web.html#html"><i class="fa fa-check"></i><b>11.2</b> HTML</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="web.html"><a href="web.html#html的基本语法"><i class="fa fa-check"></i><b>11.2.1</b> HTML的基本语法</a></li>
<li class="chapter" data-level="11.2.2" data-path="web.html"><a href="web.html#常见html标签"><i class="fa fa-check"></i><b>11.2.2</b> 常见HTML标签</a></li>
<li class="chapter" data-level="11.2.3" data-path="web.html"><a href="web.html#dom树形数据结构"><i class="fa fa-check"></i><b>11.2.3</b> DOM树形数据结构</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="web.html"><a href="web.html#css"><i class="fa fa-check"></i><b>11.3</b> CSS</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="web.html"><a href="web.html#css的基本语法"><i class="fa fa-check"></i><b>11.3.1</b> CSS的基本语法</a></li>
<li class="chapter" data-level="11.3.2" data-path="web.html"><a href="web.html#id选择器"><i class="fa fa-check"></i><b>11.3.2</b> id选择器</a></li>
<li class="chapter" data-level="11.3.3" data-path="web.html"><a href="web.html#类选择器"><i class="fa fa-check"></i><b>11.3.3</b> 类选择器</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="web.html"><a href="web.html#javascript"><i class="fa fa-check"></i><b>11.4</b> JavaScript</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="web.html"><a href="web.html#javascript案例"><i class="fa fa-check"></i><b>11.4.1</b> JavaScript案例</a></li>
<li class="chapter" data-level="11.4.2" data-path="web.html"><a href="web.html#javascript的基本语法"><i class="fa fa-check"></i><b>11.4.2</b> JavaScript的基本语法</a></li>
<li class="chapter" data-level="11.4.3" data-path="web.html"><a href="web.html#ajax"><i class="fa fa-check"></i><b>11.4.3</b> AJAX</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="web.html"><a href="web.html#开发者工具"><i class="fa fa-check"></i><b>11.5</b> 开发者工具</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="web.html"><a href="web.html#打开开发者工具"><i class="fa fa-check"></i><b>11.5.1</b> 打开开发者工具</a></li>
<li class="chapter" data-level="11.5.2" data-path="web.html"><a href="web.html#查看器与样式"><i class="fa fa-check"></i><b>11.5.2</b> 查看器与样式</a></li>
<li class="chapter" data-level="11.5.3" data-path="web.html"><a href="web.html#其他功能"><i class="fa fa-check"></i><b>11.5.3</b> 其他功能</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="web.html"><a href="web.html#xpath"><i class="fa fa-check"></i><b>11.6</b> Xpath</a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="web.html"><a href="web.html#基本查询"><i class="fa fa-check"></i><b>11.6.1</b> 基本查询</a></li>
</ul></li>
<li class="chapter" data-level="11.7" data-path="web.html"><a href="web.html#http"><i class="fa fa-check"></i><b>11.7</b> HTTP</a>
<ul>
<li class="chapter" data-level="11.7.1" data-path="web.html"><a href="web.html#http常见方法"><i class="fa fa-check"></i><b>11.7.1</b> HTTP常见方法</a></li>
</ul></li>
<li class="chapter" data-level="11.8" data-path="web.html"><a href="web.html#静态爬虫"><i class="fa fa-check"></i><b>11.8</b> 静态爬虫</a></li>
<li class="chapter" data-level="11.9" data-path="web.html"><a href="web.html#使用rselenium的动态爬虫"><i class="fa fa-check"></i><b>11.9</b> 使用RSelenium的动态爬虫</a>
<ul>
<li class="chapter" data-level="11.9.1" data-path="web.html"><a href="web.html#rselenium简介与安装"><i class="fa fa-check"></i><b>11.9.1</b> RSelenium简介与安装</a></li>
<li class="chapter" data-level="11.9.2" data-path="web.html"><a href="web.html#安装docker"><i class="fa fa-check"></i><b>11.9.2</b> 安装Docker</a></li>
<li class="chapter" data-level="11.9.3" data-path="web.html"><a href="web.html#rselenum语法"><i class="fa fa-check"></i><b>11.9.3</b> RSelenum语法</a></li>
<li class="chapter" data-level="11.9.4" data-path="web.html"><a href="web.html#案例1在链家搜索并获取相关信息"><i class="fa fa-check"></i><b>11.9.4</b> 案例1:在链家搜索并获取相关信息</a></li>
<li class="chapter" data-level="11.9.5" data-path="web.html"><a href="web.html#案例2登录豆瓣"><i class="fa fa-check"></i><b>11.9.5</b> 案例2:登录豆瓣</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="geo.html"><a href="geo.html"><i class="fa fa-check"></i><b>12</b> 地理计算</a>
<ul>
<li class="chapter" data-level="12.1" data-path="geo.html"><a href="geo.html#r中地理计算"><i class="fa fa-check"></i><b>12.1</b> R中地理计算</a></li>
<li class="chapter" data-level="12.2" data-path="geo.html"><a href="geo.html#地理数据结构"><i class="fa fa-check"></i><b>12.2</b> 地理数据结构</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="geo.html"><a href="geo.html#向量vector"><i class="fa fa-check"></i><b>12.2.1</b> 向量（Vector）</a></li>
<li class="chapter" data-level="12.2.2" data-path="geo.html"><a href="geo.html#栅格raster"><i class="fa fa-check"></i><b>12.2.2</b> 栅格（Raster）</a></li>
<li class="chapter" data-level="12.2.3" data-path="geo.html"><a href="geo.html#坐标系coordinate-reference-system"><i class="fa fa-check"></i><b>12.2.3</b> 坐标系（coordinate reference system）</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="geo.html"><a href="geo.html#地理数据操纵"><i class="fa fa-check"></i><b>12.3</b> 地理数据操纵</a></li>
<li class="chapter" data-level="12.4" data-path="geo.html"><a href="geo.html#地理数据可视化"><i class="fa fa-check"></i><b>12.4</b> 地理数据可视化</a></li>
<li class="chapter" data-level="12.5" data-path="geo.html"><a href="geo.html#地理数据运算"><i class="fa fa-check"></i><b>12.5</b> 地理数据运算</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="geo.html"><a href="geo.html#取子集"><i class="fa fa-check"></i><b>12.5.1</b> 取子集</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="geo.html"><a href="geo.html#地理数据读写"><i class="fa fa-check"></i><b>12.6</b> 地理数据读写</a></li>
<li class="chapter" data-level="12.7" data-path="geo.html"><a href="geo.html#地理数据计算"><i class="fa fa-check"></i><b>12.7</b> 地理数据计算</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="make.html"><a href="make.html"><i class="fa fa-check"></i><b>13</b> GUN Make的数据生产线</a>
<ul>
<li class="chapter" data-level="13.1" data-path="make.html"><a href="make.html#使用make的必要性"><i class="fa fa-check"></i><b>13.1</b> 使用Make的必要性</a></li>
<li class="chapter" data-level="13.2" data-path="make.html"><a href="make.html#数据流水线的构造目标"><i class="fa fa-check"></i><b>13.2</b> 数据流水线的构造目标</a></li>
<li class="chapter" data-level="13.3" data-path="make.html"><a href="make.html#make安装"><i class="fa fa-check"></i><b>13.3</b> Make安装</a></li>
<li class="chapter" data-level="13.4" data-path="make.html"><a href="make.html#快速上手make"><i class="fa fa-check"></i><b>13.4</b> 快速上手make</a></li>
<li class="chapter" data-level="13.5" data-path="make.html"><a href="make.html#make的工作方式"><i class="fa fa-check"></i><b>13.5</b> make的工作方式</a></li>
<li class="chapter" data-level="13.6" data-path="make.html"><a href="make.html#makefile-的高级写法"><i class="fa fa-check"></i><b>13.6</b> Makefile 的高级写法</a>
<ul>
<li class="chapter" data-level="13.6.1" data-path="make.html"><a href="make.html#特殊目标"><i class="fa fa-check"></i><b>13.6.1</b> 特殊目标</a></li>
<li class="chapter" data-level="13.6.2" data-path="make.html"><a href="make.html#使用变量"><i class="fa fa-check"></i><b>13.6.2</b> 使用变量</a></li>
<li class="chapter" data-level="13.6.3" data-path="make.html"><a href="make.html#分支与循环结构"><i class="fa fa-check"></i><b>13.6.3</b> 分支与循环结构</a></li>
<li class="chapter" data-level="13.6.4" data-path="make.html"><a href="make.html#函数-1"><i class="fa fa-check"></i><b>13.6.4</b> 函数</a></li>
</ul></li>
<li class="chapter" data-level="13.7" data-path="make.html"><a href="make.html#make的高级语法"><i class="fa fa-check"></i><b>13.7</b> Make的高级语法</a>
<ul>
<li class="chapter" data-level="13.7.1" data-path="make.html"><a href="make.html#并行计算"><i class="fa fa-check"></i><b>13.7.1</b> 并行计算</a></li>
</ul></li>
<li class="chapter" data-level="13.8" data-path="make.html"><a href="make.html#参考资料"><i class="fa fa-check"></i><b>13.8</b> 参考资料</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="net.html"><a href="net.html"><i class="fa fa-check"></i><b>14</b> 图数据分析</a></li>
<li class="appendix"><span><b>附录</b></span></li>
<li class="chapter" data-level="A" data-path="sound.html"><a href="sound.html"><i class="fa fa-check"></i><b>A</b> 余音绕梁</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>参考文献</a></li>
<li class="chapter" data-level="B" data-path="date.html"><a href="date.html"><i class="fa fa-check"></i><b>B</b> R日期时间</a>
<ul>
<li class="chapter" data-level="B.1" data-path="date.html"><a href="date.html#日期-时间数据类型"><i class="fa fa-check"></i><b>B.1</b> 日期-时间数据类型</a></li>
<li class="chapter" data-level="B.2" data-path="date.html"><a href="date.html#lubridate包"><i class="fa fa-check"></i><b>B.2</b> lubridate包</a>
<ul>
<li class="chapter" data-level="B.2.1" data-path="date.html"><a href="date.html#定义日期-时间变量"><i class="fa fa-check"></i><b>B.2.1</b> 定义日期-时间变量</a></li>
</ul></li>
<li class="chapter" data-level="B.3" data-path="date.html"><a href="date.html#从日期-时间中取出元素"><i class="fa fa-check"></i><b>B.3</b> 从日期-时间中取出元素</a></li>
<li class="chapter" data-level="B.4" data-path="date.html"><a href="date.html#日期-时间取整"><i class="fa fa-check"></i><b>B.4</b> 日期-时间取整</a></li>
<li class="chapter" data-level="B.5" data-path="date.html"><a href="date.html#日期-时间的数学运算"><i class="fa fa-check"></i><b>B.5</b> 日期-时间的数学运算</a>
<ul>
<li class="chapter" data-level="B.5.1" data-path="date.html"><a href="date.html#时间长度"><i class="fa fa-check"></i><b>B.5.1</b> 时间长度</a></li>
<li class="chapter" data-level="B.5.2" data-path="date.html"><a href="date.html#时间周期"><i class="fa fa-check"></i><b>B.5.2</b> 时间周期</a></li>
<li class="chapter" data-level="B.5.3" data-path="date.html"><a href="date.html#时间区间"><i class="fa fa-check"></i><b>B.5.3</b> 时间区间</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">本书由 bookdown 强力驱动</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">数据工程讲义：经济学分册</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="cml" class="section level1 hasAnchor" number="10">
<h1><span class="header-section-number">第 10 章</span> 命令行<a href="cml.html#cml" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<blockquote>
<p>上下无常，刚柔相易，不可为典要，唯变所适。–《周易》</p>
</blockquote>
<p>命令行对于初学者而言就像是一个黑色的魔法界面，但实际上命令行才是计算机系统的母语。当我们使用命令行的时候，我们可以清楚的看到程序的输入、输出与执行过程，所以最接近数据工程的“透明原则”。与此同时，命令行脚本可以形成非常灵活的轻量级工具，可以把不同任务连接起来，是“天然胶水”。因此，熟练掌握命令行界面对于数据处理至关重要。</p>
<p>在命令行里，我们需要给计算机以非常精准的指令，这对我们的逻辑思考能力是一个质的改变。在日常生活中，“我以为我知道”和“我确定真的知道”是两个完全不一样的概念，尤其对于经济学家而言，很多时候我们经常处于前者的状态而不自知。在命令行中，我们被迫要达到第二种状态。</p>
<p>命令行普遍存在于几乎所有的操作系统，包括但不限于GNU/Linux，Unix，macOS，Windows WSL，以及各种超级计算机。掌握一套命令行工具，可以让我们在各类系统上穿梭自如。</p>
<p>我们不可能通过一章的篇幅帮助读者成为玩转命令行的专家，因此，本章的目的在于介绍最基本的命令行语法，希望借助本章的内容，为读者在未来研究与工作中使用和学习命令行工具留下合格的学习接口。</p>
<div id="命令的基本概念" class="section level2 hasAnchor" number="10.1">
<h2><span class="header-section-number">10.1</span> 命令的基本概念<a href="cml.html#命令的基本概念" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>操作系统是一个内核（kernel），是内部与硬件交互的；外部是人机交互的部分，叫做壳（shell），是人类到操作系统的桥梁。shell有两种，命令行（Command Line Interface, CLI）和图形（Graphical User Interface, GUI）。最典型的命令行shell是GNU Bourne-Again Shell（bash）。</p>
<p>bash是GNU运动的一部分，是目前使用最广泛的shell，但它是一个基础的shell，可配置的选项有限，限制了使用时的便捷性。</p>
<p>zsh是另一个使用广泛的shell，搭配”Oh My Zsh”插件，可以将shell的功能配置的非常丰富，例如丰富的主题，语法高亮与命令补全等。2019年，Apple的macOS Catalina将zsh作为默认shell，取代了bash。但是，zsh的复杂性会让初学者感到不知所措，其丰富的配置选项会让初学者感到困惑。</p>
<p>我们推荐初学者一个介于bash与zsh之间的选择-fish，推荐脚本使用bash，命令行交互可以使用fish。</p>
<div id="fish" class="section level3 hasAnchor" number="10.1.1">
<h3><span class="header-section-number">10.1.1</span> fish<a href="cml.html#fish" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>fish，全称“friendly interactive shell”，首次发布于2005年2月13日，原作者为 Axel Liljencrantz，是一个专注于交互性和可用性的 Unix shell。它最大的优点是在不需要配置的情况下，就提供了大部分的功能，非常适合不想学习一大堆语法，或者花费很多时间配置的初学者。</p>
<div id="fish的安装" class="section level4 hasAnchor" number="10.1.1.1">
<h4><span class="header-section-number">10.1.1.1</span> fish的安装<a href="cml.html#fish的安装" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>debian用户使用apt安装，macos使用brew命令安装。</p>
<pre><code>apt install fish</code></pre>
<pre><code>brew install fish</code></pre>
<p>安装完成后，直接通过<code>fish</code>命令可以启动fish。</p>
</div>
<div id="设置fish为默认shell" class="section level4 hasAnchor" number="10.1.1.2">
<h4><span class="header-section-number">10.1.1.2</span> 设置fish为默认shell<a href="cml.html#设置fish为默认shell" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>在文件<code>/etc/shells</code>中添加<code>/usr/local/bin/fish</code>，之后，运行命令<code>chsh -s /usr/local/bin/fish</code>，可以将fish设置成默认shell。</p>
</div>
<div id="fish的常用功能" class="section level4 hasAnchor" number="10.1.1.3">
<h4><span class="header-section-number">10.1.1.3</span> fish的常用功能<a href="cml.html#fish的常用功能" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>相对于需要进行大量的配置才能获得良好体验的 zsh，fish原生附带有最为广泛使用的特性，比如：自动提示、语法高亮等等。同时其配置设置的语法清晰明了，通过模块化和 Web 可视化配置。</p>
<ul>
<li><p>自动提示：fish 会通过显示灰色提示，提醒最近浏览历史，和可能希望浏览的内容。如果命令有误，则会将命令设置为红色。</p></li>
<li><p>文件和命令高亮：fish 会将文件设置为绿色，目录设置为蓝色。</p></li>
<li><p>生成数据制表页：fish 可以解析各种格式的工具手册页，假如你不知道该命令下有什么作用，可以通过输入<code>tab</code>键获得提示</p></li>
<li><p>自动补全：输入命令时，Fish 会自动显示上一次使用该命令历史记录（如果还希望查看之前的历史，还可以通过按”up”向上键查看）</p></li>
</ul>
</div>
<div id="fish的配置文件" class="section level4 hasAnchor" number="10.1.1.4">
<h4><span class="header-section-number">10.1.1.4</span> fish的配置文件<a href="cml.html#fish的配置文件" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>fish的配置文件位于<code>~/.config/fish/config.fish</code>，也可以通过修改配置文件来对fish进行修改。</p>
<p>fish还提供了可视化Web配置页面，输入<code>fish_config</code>命令可以在浏览器打开一个配置页面，可以便捷的配置fish。</p>
</div>
</div>
<div id="常用命令" class="section level3 hasAnchor" number="10.1.2">
<h3><span class="header-section-number">10.1.2</span> 常用命令<a href="cml.html#常用命令" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>命令有五种类型：可执行程序、脚本、Shell内建命令、Shell函数还有别名。使用<code>type</code>命令可以查看其他命令的类型。</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="cml.html#cb3-1" tabindex="-1"></a><span class="bu">type</span> echo</span>
<span id="cb3-2"><a href="cml.html#cb3-2" tabindex="-1"></a><span class="bu">type</span> cat</span></code></pre></div>
<pre><code>## echo is a shell builtin
## cat is /bin/cat</code></pre>
<p>特别地，命令行命令并不需要特别记忆，我们只需要了解常用命令，对于经常使用的命令，在使用的过程中很快就可以记下来</p>
<table>
<thead>
<tr class="header">
<th>命令</th>
<th>功能</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>ls</code></td>
<td>查看目录内的文件</td>
</tr>
<tr class="even">
<td><code>cd</code></td>
<td>改变路径</td>
</tr>
<tr class="odd">
<td><code>rm</code></td>
<td>删除文件或文件夹</td>
</tr>
<tr class="even">
<td><code>git</code></td>
<td>版本控制相关的命令</td>
</tr>
<tr class="odd">
<td><code>less</code></td>
<td>以分页方式查看文件内容</td>
</tr>
<tr class="even">
<td><code>man</code></td>
<td>查看命令文档</td>
</tr>
<tr class="odd">
<td><code>info</code></td>
<td>GNU的命令详细介绍文件</td>
</tr>
<tr class="even">
<td><code>cat</code></td>
<td>将多个文件连接起来输出</td>
</tr>
<tr class="odd">
<td><code>pwd</code></td>
<td>打印当前路径</td>
</tr>
<tr class="even">
<td><code>seq</code></td>
<td>生成等差数列</td>
</tr>
<tr class="odd">
<td><code>grep</code></td>
<td>筛选符合条件的行</td>
</tr>
<tr class="even">
<td><code>wc</code></td>
<td>计数</td>
</tr>
<tr class="odd">
<td><code>echo</code></td>
<td>打印字符到输出</td>
</tr>
<tr class="even">
<td><code>find</code></td>
<td>查找文件</td>
</tr>
<tr class="odd">
<td><code>touch</code></td>
<td>新建文件/改变文件修改时间</td>
</tr>
<tr class="even">
<td><code>mkdir</code></td>
<td>新建文件夹</td>
</tr>
<tr class="odd">
<td><code>tee</code></td>
<td>显示程序的输出并将其复制到一个文件中</td>
</tr>
<tr class="even">
<td><code>bc</code></td>
<td>计算器</td>
</tr>
<tr class="odd">
<td><code>uname</code></td>
<td>查看系统基本信息</td>
</tr>
<tr class="even">
<td><code>hostname</code></td>
<td>用户信息</td>
</tr>
<tr class="odd">
<td><code>id</code></td>
<td>用户id信息</td>
</tr>
<tr class="even">
<td><code>date</code></td>
<td>当前日期时间</td>
</tr>
<tr class="odd">
<td><code>uptime</code></td>
<td>机器运行时间</td>
</tr>
<tr class="even">
<td><code>dmesg</code></td>
<td>显示内核环缓冲区信息</td>
</tr>
<tr class="odd">
<td><code>head</code></td>
<td>文件头部若干行</td>
</tr>
<tr class="even">
<td><code>tail</code></td>
<td>文件尾部若干行</td>
</tr>
<tr class="odd">
<td><code>cut</code></td>
<td>按列剪切输出</td>
</tr>
<tr class="even">
<td><code>paste</code></td>
<td>合并文件的列，<code>cut</code>的反函数</td>
</tr>
<tr class="odd">
<td><code>find</code></td>
<td>查找路径下的文件</td>
</tr>
<tr class="even">
<td><code>file</code></td>
<td>识别文件类型</td>
</tr>
<tr class="odd">
<td><code>chmod</code></td>
<td>修改文件权限</td>
</tr>
<tr class="even">
<td><code>sed</code></td>
<td>文件流编辑器，macOS需要使用<code>gsed</code></td>
</tr>
</tbody>
</table>
</div>
<div id="标准输入与输出" class="section level3 hasAnchor" number="10.1.3">
<h3><span class="header-section-number">10.1.3</span> 标准输入与输出<a href="cml.html#标准输入与输出" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>执行一个shell命令行时通常会自动打开三个标准文件，即标准输入文件（stdin），通常对应终端的键盘；标准输出文件（stdout）和标准错误输出文件（stderr），这两个文件都对应终端的屏幕。进程将从标准输入文件中得到输入数据，将正常输出数据输出到标准输出文件，而将错误信息送到标准错误文件中。命令行逐行读入输入文件。</p>
<p>例如，<code>echo</code>命令的功能是将参数中的字符串直接送到标准输出。</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="cml.html#cb5-1" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;I am using the command line&quot;</span></span></code></pre></div>
<pre><code>## I am using the command line</code></pre>
</div>
<div id="管道与进程管理" class="section level3 hasAnchor" number="10.1.4">
<h3><span class="header-section-number">10.1.4</span> 管道与进程管理<a href="cml.html#管道与进程管理" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><em>管道</em>可将前一个程序的标准输出和后一个程序的标准输入连接起来，从而将多个程序无线串联起来。默认情况下，键盘是标准输入的端口，屏幕是标准输出的端口。</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="cml.html#cb7-1" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;I am using the command line&quot;</span> <span class="kw">|</span> <span class="fu">wc</span> <span class="at">-c</span></span></code></pre></div>
<pre><code>##       28</code></pre>
<p><em>重定向</em>通过<code>&lt;</code>号将标准输入重定向到文件，<code>&gt;</code>将标准输出重定向到文件</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb9-1"><a href="cml.html#cb9-1" tabindex="-1"></a><span class="fu">seq</span> 100 <span class="op">&gt;</span> s100</span></code></pre></div>
<p><em>自由管道</em>命令<code>mkfifo</code>可以定义命名管道，后续命令中可以把命名管道作为输出和输入使用。下列代码中，第一行生成命名管道<code>filter</code>，第二行使用<code>tee</code>将<code>seq</code>和<code>grep</code>的结果存入名字为<code>filter</code>的管道中，第三行调出管道，并计算其中包含8的字符。</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb10-1"><a href="cml.html#cb10-1" tabindex="-1"></a><span class="fu">mkfifo</span> filter.pipe <span class="co"># 生成新的命名管道</span></span>
<span id="cb10-2"><a href="cml.html#cb10-2" tabindex="-1"></a><span class="fu">seq</span> 100<span class="kw">|</span><span class="fu">grep</span> 7<span class="kw">|</span> <span class="fu">tee</span> filter.pipe<span class="kw">|</span> <span class="fu">wc</span> <span class="at">-c</span> <span class="kw">&amp;</span></span>
<span id="cb10-3"><a href="cml.html#cb10-3" tabindex="-1"></a><span class="fu">grep</span> 8 <span class="op">&lt;</span> filter.pipe</span></code></pre></div>
<pre><code>## mkfifo: filter.pipe: File exists
##       56
## 78
## 87</code></pre>
<p>上述命令中，我们使用了<code>&amp;</code>来将命令挂起（即后台运行）。使用<code>jobs</code>命令可以查看后台运行的进程，<code>fg</code>命令可以将后台进程拉至前台，<code>bg</code>命令可以将进程挂起到后台，<code>kill</code>加进程号可以杀死任务。</p>
<p><code>awk</code>与<code>sed</code>命令的学习放在正则表达式之后，正则表达式的例子要单独拿出来分析。</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="cml.html#cb12-1" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Hello Python!&quot;</span>)</span></code></pre></div>
<pre><code>## Hello Python!</code></pre>
<p><strong>快捷键</strong></p>
<p>ctrl+c
ctrl+d 结束文件</p>
</div>
<div id="别名" class="section level3 hasAnchor" number="10.1.5">
<h3><span class="header-section-number">10.1.5</span> 别名<a href="cml.html#别名" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="脚本" class="section level3 hasAnchor" number="10.1.6">
<h3><span class="header-section-number">10.1.6</span> 脚本<a href="cml.html#脚本" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>把命令储存在拓展名为<code>.sh</code>的文件中，就形成了脚本文件。<code>bash</code>命令可以运行<code>Shell</code>脚本。</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb14-1"><a href="cml.html#cb14-1" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;seq 100 | paste -s -d + -| bc&quot;</span> <span class="op">&gt;</span> add_up_100.sh</span>
<span id="cb14-2"><a href="cml.html#cb14-2" tabindex="-1"></a><span class="fu">bash</span> add_up_100.sh</span></code></pre></div>
<pre><code>## 5050</code></pre>
<p>在第一行填加脚本解释器 <code>#!/bin/bash</code>，可以告知脚本执行时候要使用<code>/bin/bash</code>
解释执行。此处，<code>#!</code>是约定好的关键字，当它在脚本文件的第一行时，内核会寻找它后面的解释器来执行脚本。</p>
<p>使用<code>chmod +x</code>赋予脚本文件可执行权限之后，就可以直接运行脚本文件。</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb16-1"><a href="cml.html#cb16-1" tabindex="-1"></a><span class="ex">gsed</span> <span class="st">&#39;1i#!/bin/bash&#39;</span> <span class="at">-i</span> add_up_100.sh <span class="co"># gsed是mac里面的GNU sed</span></span>
<span id="cb16-2"><a href="cml.html#cb16-2" tabindex="-1"></a><span class="fu">cat</span> add_up_100.sh</span>
<span id="cb16-3"><a href="cml.html#cb16-3" tabindex="-1"></a><span class="fu">chmod</span> +x add_up_100.sh</span>
<span id="cb16-4"><a href="cml.html#cb16-4" tabindex="-1"></a><span class="ex">./add_up_100.sh</span></span></code></pre></div>
<pre><code>## #!/bin/bash
## seq 100 | paste -s -d + -| bc
## 5050</code></pre>
</div>
<div id="传参" class="section level3 hasAnchor" number="10.1.7">
<h3><span class="header-section-number">10.1.7</span> 传参<a href="cml.html#传参" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Bash脚本可以在执行时传递参数，参数以空格分隔，在脚本中可以通过<code>$n</code>来调用第n个参数，<code>$0</code>表示调用脚本名称。例如，脚本<code>args.sh</code>命令如下，</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb18-1"><a href="cml.html#cb18-1" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb18-2"><a href="cml.html#cb18-2" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Bash 传递参数实例！&quot;</span><span class="kw">;</span></span>
<span id="cb18-3"><a href="cml.html#cb18-3" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;执行的文件名：</span><span class="va">$0</span><span class="st">&quot;</span><span class="kw">;</span></span>
<span id="cb18-4"><a href="cml.html#cb18-4" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;第一个参数为：</span><span class="va">$1</span><span class="st">&quot;</span><span class="kw">;</span></span>
<span id="cb18-5"><a href="cml.html#cb18-5" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;第二个参数为：</span><span class="va">$2</span><span class="st">&quot;</span><span class="kw">;</span></span>
<span id="cb18-6"><a href="cml.html#cb18-6" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;第三个参数为：</span><span class="va">$3</span><span class="st">&quot;</span><span class="kw">;</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb19-1"><a href="cml.html#cb19-1" tabindex="-1"></a><span class="ex">./args.sh</span> a1 b2 c3</span></code></pre></div>
<pre><code>## Shell 传递参数实例！
## 执行的文件名：./args.sh
## 第一个参数为：a1
## 第二个参数为：b2
## 第三个参数为：c3</code></pre>
<p>另外，脚本中还有一些特殊的参数调用方式。</p>
<table>
<thead>
<tr class="header">
<th align="left">参数调用</th>
<th align="left">作用</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>$#</code></td>
<td align="left">传递到脚本的参数个数</td>
</tr>
<tr class="even">
<td align="left"><code>$*</code></td>
<td align="left">以单字符串显示所有参数</td>
</tr>
<tr class="odd">
<td align="left"><code>$$</code></td>
<td align="left">脚本运行的当前进程ID号</td>
</tr>
<tr class="even">
<td align="left"><code>$@</code></td>
<td align="left">逐个显示所有参数</td>
</tr>
<tr class="odd">
<td align="left"><code>$?</code></td>
<td align="left">显示最后命令的退出状态，0表示没有错误</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="变量与数据结构" class="section level2 hasAnchor" number="10.2">
<h2><span class="header-section-number">10.2</span> 变量与数据结构<a href="cml.html#变量与数据结构" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Bash脚本中以<code>var=value</code>的形式定义变量。由于Bash中约定空格的作用是区分参数，因此在变量赋值的等号前后不能有空格。如果需要把空格作为字符串处理，则需要引号。Bash中约定一切都是字符串，因此需要以<code>${var}</code>的方式来调用变量。Bash中单引号和双引号的区别在于，单引号中<code>$</code>会被当做字符串处理，而双引号中<code>$</code>被当做变量取值符号。</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb21-1"><a href="cml.html#cb21-1" tabindex="-1"></a><span class="va">a</span><span class="op">=</span><span class="st">&quot;hello world&quot;</span></span>
<span id="cb21-2"><a href="cml.html#cb21-2" tabindex="-1"></a><span class="bu">echo</span> <span class="va">${a}</span></span>
<span id="cb21-3"><a href="cml.html#cb21-3" tabindex="-1"></a><span class="va">b</span><span class="op">=</span>1</span>
<span id="cb21-4"><a href="cml.html#cb21-4" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;</span><span class="va">$b</span><span class="st"> =   1&quot;</span></span>
<span id="cb21-5"><a href="cml.html#cb21-5" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&#39;$b    = 1&#39;</span></span></code></pre></div>
<pre><code>## hello world
## 1 =   1
## $b    = 1</code></pre>
<p><code>$()</code>可以把命令运行的标准输出复制给变量，按行分隔的列表转换为空格分隔。<code>()</code>的含义其实是把命令的结果变成一个字符串。<code>${#}</code>可以返回变量字符个数。</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb23-1"><a href="cml.html#cb23-1" tabindex="-1"></a><span class="va">n_list</span><span class="op">=</span><span class="va">$(</span><span class="fu">seq</span> 10<span class="va">)</span></span>
<span id="cb23-2"><a href="cml.html#cb23-2" tabindex="-1"></a><span class="bu">echo</span> <span class="va">${n_list}</span></span>
<span id="cb23-3"><a href="cml.html#cb23-3" tabindex="-1"></a><span class="bu">echo</span> <span class="va">${</span><span class="op">#</span><span class="va">n_list}</span></span></code></pre></div>
<pre><code>## 1 2 3 4 5 6 7 8 9 10
## 20</code></pre>
<div id="路径变量" class="section level3 hasAnchor" number="10.2.1">
<h3><span class="header-section-number">10.2.1</span> 路径变量<a href="cml.html#路径变量" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>系统中有一组特定的由操作系统或用户设置的环境变量，用来配置Shell 的行为和影响其执行环境。其中最常用的是路径（PATH）变量，它包含了操作系统搜索可执行文件的路径。</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb25-1"><a href="cml.html#cb25-1" tabindex="-1"></a><span class="bu">echo</span> <span class="va">${PATH}</span></span></code></pre></div>
<pre><code>## /usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/opt/X11/bin:/usr/local/go/bin:/Applications/quarto/bin:/Library/TeX/texbin:/Users/birdstone/Applications/quarto/bin:/usr/texbin:/Applications/RStudio.app/Contents/Resources/app/bin/postback</code></pre>
<p>使用<code>echo</code>查看路径变量，可以发现执行路径以<code>:</code>分割。只有一个命令存在于执行路径中时，相关命令才能被执行，否则会报错<code>command not found</code>。</p>
<p>临时修改路径变量使用export命令。例如，如果希望将<code>/usr/local/bin</code>路径添加到路径变量中，可使用下面的命令。此更改只是临时的，仅在当前的Shell会话中有效。</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb27-1"><a href="cml.html#cb27-1" tabindex="-1"></a><span class="bu">export</span> <span class="va">PATH</span><span class="op">=</span><span class="st">&quot;/usr/local/bin&quot;</span></span></code></pre></div>
<p>通过配置文件设置PATH环境变量可以永久修改路径变量。在大多数Linux发行版中，当系统启动时，将从<code>/etc/environment</code>和<code>/etc/profile</code>以及<code>~/.bashrc</code>文件中读取环境变量。</p>
<p>全局的配置文件是<code>/etc/environment</code>和<code>/etc/profile</code>。如果要为系统所有用户设置PATH环境变量，请在这两个文件中修改。</p>
<p>为指定的用户设置PATH环境变量时，只需要在<code>~/.bashrc</code>文件修改PATH变量；如果使用的是zsh，则文件是<code>~/.zshrc</code>；如果使用的是fish，则是<code>~/.config/fish/config.fish</code>。</p>
<p>例如，</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb28-1"><a href="cml.html#cb28-1" tabindex="-1"></a><span class="bu">echo</span> PATH=<span class="st">&quot;/usr/local/bin&quot;</span> <span class="kw">|</span> <span class="fu">sudo</span> tee <span class="at">-a</span> ~/.bashrc</span></code></pre></div>
<p>修改完成之后，使用运行source命令将加载环境变量到当前的shell会话，<code>source ~/.bashrc</code>。</p>
</div>
<div id="数组" class="section level3 hasAnchor" number="10.2.2">
<h3><span class="header-section-number">10.2.2</span> 数组<a href="cml.html#数组" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>bash</code>数组类似于<code>python</code>里面的list，可以储存任意元素，有序，用<code>+=</code>符号添加元素，数组下标从零开始编号。</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb29-1"><a href="cml.html#cb29-1" tabindex="-1"></a><span class="va">stdnt</span><span class="op">=</span><span class="va">()</span></span>
<span id="cb29-2"><a href="cml.html#cb29-2" tabindex="-1"></a><span class="va">stdnt</span><span class="op">+=</span><span class="va">(</span>张三 李四 王五<span class="va">)</span></span>
<span id="cb29-3"><a href="cml.html#cb29-3" tabindex="-1"></a><span class="bu">echo</span> <span class="va">${stdnt}</span></span>
<span id="cb29-4"><a href="cml.html#cb29-4" tabindex="-1"></a><span class="bu">echo</span> <span class="va">${stdnt</span><span class="op">[@]</span><span class="va">}</span></span>
<span id="cb29-5"><a href="cml.html#cb29-5" tabindex="-1"></a><span class="bu">echo</span> <span class="va">${stdnt</span><span class="op">[</span><span class="dv">2</span><span class="op">]</span><span class="va">}</span></span>
<span id="cb29-6"><a href="cml.html#cb29-6" tabindex="-1"></a><span class="bu">echo</span> <span class="va">${</span><span class="op">#</span><span class="va">stdnt</span><span class="op">[@]</span><span class="va">}</span></span></code></pre></div>
<pre><code>## 张三
## 张三 李四 王五
## 王五
## 3</code></pre>
</div>
<div id="字典-1" class="section level3 hasAnchor" number="10.2.3">
<h3><span class="header-section-number">10.2.3</span> 字典<a href="cml.html#字典-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>bash</code>中也有字典结构，又叫关联数组（associative array）。</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb31-1"><a href="cml.html#cb31-1" tabindex="-1"></a><span class="bu">declare</span> <span class="at">-A</span> <span class="va">stdnt</span> <span class="co"># 声明 cargo 是字典</span></span>
<span id="cb31-2"><a href="cml.html#cb31-2" tabindex="-1"></a><span class="va">stdnt</span><span class="op">[</span>age<span class="op">]=</span>23</span>
<span id="cb31-3"><a href="cml.html#cb31-3" tabindex="-1"></a><span class="va">stdnt</span><span class="op">[</span>gender<span class="op">]=</span>male</span>
<span id="cb31-4"><a href="cml.html#cb31-4" tabindex="-1"></a><span class="bu">echo</span> <span class="va">${stdnt</span><span class="op">[</span>age<span class="op">]</span><span class="va">}</span></span>
<span id="cb31-5"><a href="cml.html#cb31-5" tabindex="-1"></a><span class="bu">echo</span> <span class="va">${</span><span class="op">!</span><span class="va">stdnt</span><span class="op">[@]</span><span class="va">}</span> <span class="co"># 取字典key</span></span>
<span id="cb31-6"><a href="cml.html#cb31-6" tabindex="-1"></a><span class="bu">echo</span> <span class="va">${stdnt</span><span class="op">[@]</span><span class="va">}</span> <span class="co"># 取字典值</span></span></code></pre></div>
<pre><code>## 23
## gender age
## male 23</code></pre>
</div>
</div>
<div id="运算-1" class="section level2 hasAnchor" number="10.3">
<h2><span class="header-section-number">10.3</span> 运算<a href="cml.html#运算-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><code>$((expr))</code>用于计算表达式<code>expr</code>的结果，例如，</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb33-1"><a href="cml.html#cb33-1" tabindex="-1"></a><span class="bu">echo</span> <span class="va">$((</span><span class="dv">1</span><span class="op">+</span><span class="dv">2</span><span class="va">))</span></span>
<span id="cb33-2"><a href="cml.html#cb33-2" tabindex="-1"></a><span class="bu">echo</span> <span class="va">$((</span><span class="dv">1</span><span class="op">%</span><span class="dv">2</span><span class="va">))</span> <span class="co">#取余数</span></span>
<span id="cb33-3"><a href="cml.html#cb33-3" tabindex="-1"></a><span class="bu">echo</span> <span class="va">$((</span><span class="dv">4</span><span class="op">/</span><span class="dv">2</span><span class="va">))</span> <span class="co">#整除</span></span></code></pre></div>
<pre><code>## 3
## 1
## 2</code></pre>
</div>
<div id="控制流程" class="section level2 hasAnchor" number="10.4">
<h2><span class="header-section-number">10.4</span> 控制流程<a href="cml.html#控制流程" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="选择结构" class="section level3 hasAnchor" number="10.4.1">
<h3><span class="header-section-number">10.4.1</span> 选择结构<a href="cml.html#选择结构" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>bash</code>的选择结构如下：</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb35-1"><a href="cml.html#cb35-1" tabindex="-1"></a><span class="cf">if</span> <span class="bu">[</span> 3 <span class="ot">-gt</span> 2 <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb35-2"><a href="cml.html#cb35-2" tabindex="-1"></a>  <span class="bu">echo</span> <span class="st">&quot;3&gt;2&quot;</span></span>
<span id="cb35-3"><a href="cml.html#cb35-3" tabindex="-1"></a><span class="cf">else</span></span>
<span id="cb35-4"><a href="cml.html#cb35-4" tabindex="-1"></a>  <span class="bu">echo</span> <span class="st">&quot;3&lt;=2&quot;</span></span>
<span id="cb35-5"><a href="cml.html#cb35-5" tabindex="-1"></a><span class="cf">fi</span></span></code></pre></div>
<pre><code>## 3&gt;2</code></pre>
<p>上述代码中，<code>[...]</code>是一个程序（更准确地说，<code>[</code>是命令，<code>]</code>是这个命令的参数），正式的命令为test，即<code>test 3 -gt 2</code>。由于<code>bash</code>中没有逻辑值，程序执行成功就是<code>TRUE</code>，执行失败则对应<code>FALSE</code>，因此真假判断的依据来执行程序的返回值，命令执行成功时返回值为<code>0</code>，执行失败返回<code>非0</code>。这里正好与<code>Python</code>相反。<code>$?</code>或<code>${?}</code>变量值可以得到前一条命令的返回值。</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb37-1"><a href="cml.html#cb37-1" tabindex="-1"></a><span class="bu">type</span> [</span>
<span id="cb37-2"><a href="cml.html#cb37-2" tabindex="-1"></a><span class="bu">test</span> 3 <span class="at">-gt</span> 2</span>
<span id="cb37-3"><a href="cml.html#cb37-3" tabindex="-1"></a><span class="bu">echo</span> <span class="va">$?</span></span></code></pre></div>
<pre><code>## [ is a shell builtin
## 0</code></pre>
<p><code>test</code>其他内建的判断参数：</p>
<table>
<thead>
<tr class="header">
<th align="left">参数</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>[ INTEGER1 -eq INTEGER2 ]</code></td>
<td align="left">相等</td>
</tr>
<tr class="even">
<td align="left"><code>[ INTEGER1 -ge INTEGER2 ]</code></td>
<td align="left">大于等于</td>
</tr>
<tr class="odd">
<td align="left"><code>[ INTEGER1 -lt INTEGER2 ]</code></td>
<td align="left">小于</td>
</tr>
<tr class="even">
<td align="left"><code>[ INTEGER1 -ne INTEGER2 ]</code></td>
<td align="left">不等</td>
</tr>
<tr class="odd">
<td align="left"><code>[ ! EXPRESSION ]</code></td>
<td align="left">取否</td>
</tr>
<tr class="even">
<td align="left"><code>[ EXPRESSION1 -a EXPRESSION2 ]</code></td>
<td align="left">取和</td>
</tr>
<tr class="odd">
<td align="left"><code>[ EXPRESSION1 -o EXPRESSION2 ]</code></td>
<td align="left">取或</td>
</tr>
<tr class="even">
<td align="left"><code>-e file</code></td>
<td align="left">file文件是否存在</td>
</tr>
<tr class="odd">
<td align="left"><code>-d dir</code></td>
<td align="left">dir路径是否存在</td>
</tr>
<tr class="even">
<td align="left"><code>-s file</code></td>
<td align="left">file文件是否存在且非空</td>
</tr>
</tbody>
</table>
<p>使用<code>man [</code>查看更多参数。</p>
<p>上述代码可以用一种简洁的方式来写：</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb39-1"><a href="cml.html#cb39-1" tabindex="-1"></a><span class="kw">[[</span> 3 <span class="ot">-gt</span> 2 <span class="kw">]]</span> <span class="kw">&amp;&amp;</span> <span class="bu">echo</span> <span class="st">&quot;3&gt;2&quot;</span> <span class="kw">||</span> <span class="bu">echo</span> <span class="st">&quot;3&lt;=2&quot;</span></span></code></pre></div>
<pre><code>## 3&gt;2</code></pre>
<p>下面的脚本可以用于判断第一个参数的路径是否存在，若不存在则生成相应的路径。</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb41-1"><a href="cml.html#cb41-1" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb41-2"><a href="cml.html#cb41-2" tabindex="-1"></a><span class="cf">if</span> <span class="bu">[</span> <span class="ot">!</span> <span class="ot">-d</span> <span class="va">$1</span> <span class="bu">]</span></span>
<span id="cb41-3"><a href="cml.html#cb41-3" tabindex="-1"></a><span class="cf">then</span></span>
<span id="cb41-4"><a href="cml.html#cb41-4" tabindex="-1"></a>        <span class="fu">mkdir</span> <span class="va">$1</span></span>
<span id="cb41-5"><a href="cml.html#cb41-5" tabindex="-1"></a><span class="cf">fi</span></span></code></pre></div>
</div>
<div id="循环-2" class="section level3 hasAnchor" number="10.4.2">
<h3><span class="header-section-number">10.4.2</span> 循环<a href="cml.html#循环-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="for循环-1" class="section level4 hasAnchor" number="10.4.2.1">
<h4><span class="header-section-number">10.4.2.1</span> for循环<a href="cml.html#for循环-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>以计算Fabonacci数列为例，<code>for</code>循环的结构如下，</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb42-1"><a href="cml.html#cb42-1" tabindex="-1"></a><span class="va">x</span><span class="op">=</span>1</span>
<span id="cb42-2"><a href="cml.html#cb42-2" tabindex="-1"></a><span class="va">y</span><span class="op">=</span>1</span>
<span id="cb42-3"><a href="cml.html#cb42-3" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="va">$(</span><span class="fu">seq</span> 10<span class="va">)</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb42-4"><a href="cml.html#cb42-4" tabindex="-1"></a>  <span class="va">s</span><span class="op">=</span><span class="va">$(($x</span><span class="op">+</span><span class="va">$y))</span></span>
<span id="cb42-5"><a href="cml.html#cb42-5" tabindex="-1"></a>  <span class="va">x</span><span class="op">=</span><span class="va">${y}</span></span>
<span id="cb42-6"><a href="cml.html#cb42-6" tabindex="-1"></a>  <span class="va">y</span><span class="op">=</span><span class="va">${s}</span></span>
<span id="cb42-7"><a href="cml.html#cb42-7" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb42-8"><a href="cml.html#cb42-8" tabindex="-1"></a><span class="bu">echo</span> <span class="va">${y}</span></span></code></pre></div>
<pre><code>## 144</code></pre>
<p>再举一个例子，把一个行数很多的文件拆分拆分成每一万行一组，可以使用下面的脚本。第一个参数和第二个参数为循环起止数，第三个参数为被拆分文件，第四个参数为储存文件路径与文件名称前缀。</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb44-1"><a href="cml.html#cb44-1" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb44-2"><a href="cml.html#cb44-2" tabindex="-1"></a><span class="cf">for</span> a <span class="kw">in</span> <span class="va">$(</span><span class="fu">seq</span> <span class="va">$1</span> <span class="va">$2)</span></span>
<span id="cb44-3"><a href="cml.html#cb44-3" tabindex="-1"></a><span class="cf">do</span></span>
<span id="cb44-4"><a href="cml.html#cb44-4" tabindex="-1"></a>        <span class="ex">gsed</span> <span class="at">-n</span> <span class="va">$((${a}</span><span class="op">*</span><span class="dv">10000</span><span class="op">+</span><span class="dv">1</span><span class="va">))</span>,<span class="va">$((</span>(<span class="va">${a}</span><span class="op">+</span><span class="dv">1</span>)<span class="op">*</span><span class="dv">10000</span><span class="va">))</span>p <span class="va">$3</span> <span class="op">&gt;</span> <span class="va">$4${a}</span>.txt</span>
<span id="cb44-5"><a href="cml.html#cb44-5" tabindex="-1"></a>        <span class="bu">echo</span> <span class="va">${a}</span></span>
<span id="cb44-6"><a href="cml.html#cb44-6" tabindex="-1"></a><span class="cf">done</span></span></code></pre></div>
</div>
<div id="while循环-1" class="section level4 hasAnchor" number="10.4.2.2">
<h4><span class="header-section-number">10.4.2.2</span> while循环<a href="cml.html#while循环-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>上述代码可以改成如下的<code>while</code>循环。</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb45-1"><a href="cml.html#cb45-1" tabindex="-1"></a><span class="va">x</span><span class="op">=</span>1</span>
<span id="cb45-2"><a href="cml.html#cb45-2" tabindex="-1"></a><span class="va">y</span><span class="op">=</span>1</span>
<span id="cb45-3"><a href="cml.html#cb45-3" tabindex="-1"></a><span class="va">n</span><span class="op">=</span>0</span>
<span id="cb45-4"><a href="cml.html#cb45-4" tabindex="-1"></a><span class="cf">while</span><span class="kw">((</span><span class="va">$n</span><span class="op">&lt;</span><span class="dv">10</span><span class="kw">));</span> <span class="cf">do</span></span>
<span id="cb45-5"><a href="cml.html#cb45-5" tabindex="-1"></a>  <span class="va">s</span><span class="op">=</span><span class="va">$(($x</span><span class="op">+</span><span class="va">$y))</span></span>
<span id="cb45-6"><a href="cml.html#cb45-6" tabindex="-1"></a>  <span class="va">x</span><span class="op">=</span><span class="va">${y}</span></span>
<span id="cb45-7"><a href="cml.html#cb45-7" tabindex="-1"></a>  <span class="va">y</span><span class="op">=</span><span class="va">${s}</span></span>
<span id="cb45-8"><a href="cml.html#cb45-8" tabindex="-1"></a>  <span class="bu">let</span> <span class="va">n</span><span class="op">++</span></span>
<span id="cb45-9"><a href="cml.html#cb45-9" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb45-10"><a href="cml.html#cb45-10" tabindex="-1"></a><span class="bu">echo</span> <span class="va">${y}</span></span></code></pre></div>
<pre><code>## 144</code></pre>
<p>特别地，<code>while</code>循环不需要迭代器，只要条件判断为真，就会循环。因此可以构造一个流，结合<code>read line</code>命令将文件中内容传输给<code>while</code>循环。<code>read line</code>的作用是读入管道的标准输出。</p>
<p>下面的代码先生成一个包括四个中国专利公开号的文件，然后将文件逐行读入到<code>while</code>循环中，最后通过<code>curl</code>命令从谷歌专利中下载该专利的文本内容。</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb47-1"><a href="cml.html#cb47-1" tabindex="-1"></a><span class="cf">if</span> <span class="bu">[</span> <span class="ot">-s</span> patent.txt <span class="bu">]</span><span class="kw">;</span><span class="cf">then</span></span>
<span id="cb47-2"><a href="cml.html#cb47-2" tabindex="-1"></a>  <span class="fu">rm</span> patent.txt</span>
<span id="cb47-3"><a href="cml.html#cb47-3" tabindex="-1"></a><span class="cf">fi</span></span>
<span id="cb47-4"><a href="cml.html#cb47-4" tabindex="-1"></a></span>
<span id="cb47-5"><a href="cml.html#cb47-5" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&#39;CN102572430A</span></span>
<span id="cb47-6"><a href="cml.html#cb47-6" tabindex="-1"></a><span class="st">CN102414031A</span></span>
<span id="cb47-7"><a href="cml.html#cb47-7" tabindex="-1"></a><span class="st">CN104327221B</span></span>
<span id="cb47-8"><a href="cml.html#cb47-8" tabindex="-1"></a><span class="st">CN104735795B&#39;</span> <span class="op">&gt;</span> patent.txt</span>
<span id="cb47-9"><a href="cml.html#cb47-9" tabindex="-1"></a></span>
<span id="cb47-10"><a href="cml.html#cb47-10" tabindex="-1"></a><span class="fu">cat</span> patent.txt<span class="kw">|</span><span class="cf">while</span> <span class="bu">read</span> <span class="va">line</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb47-11"><a href="cml.html#cb47-11" tabindex="-1"></a>   <span class="ex">curl</span> <span class="at">-ks</span> https://patents.google.com/patent/<span class="va">${line}</span> <span class="op">&gt;</span> <span class="va">${line}</span>.html</span>
<span id="cb47-12"><a href="cml.html#cb47-12" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb47-13"><a href="cml.html#cb47-13" tabindex="-1"></a></span>
<span id="cb47-14"><a href="cml.html#cb47-14" tabindex="-1"></a><span class="fu">head</span> CN104735795B.html</span></code></pre></div>
</div>
<div id="until循环" class="section level4 hasAnchor" number="10.4.2.3">
<h4><span class="header-section-number">10.4.2.3</span> until循环<a href="cml.html#until循环" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><code>until</code>循环与<code>while</code>循环在处理方式上刚好相反。一般<code>while</code>循环优于 <code>until</code>循环。</p>
</div>
<div id="break与continue" class="section level4 hasAnchor" number="10.4.2.4">
<h4><span class="header-section-number">10.4.2.4</span> break与continue<a href="cml.html#break与continue" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><code>break</code>终止循环、 <code>continue</code>跳入下一轮循环，这一点与<code>Python</code>的用法是一致的。此处不做展开。</p>
</div>
</div>
</div>
<div id="函数" class="section level2 hasAnchor" number="10.5">
<h2><span class="header-section-number">10.5</span> 函数<a href="cml.html#函数" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><code>bash</code>函数是五种命令之一。通过下面的代码结构可以定义<code>bash</code>函数。</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb48-1"><a href="cml.html#cb48-1" tabindex="-1"></a><span class="kw">function</span><span class="fu"> greet()</span> <span class="kw">{</span></span>
<span id="cb48-2"><a href="cml.html#cb48-2" tabindex="-1"></a>  <span class="bu">echo</span> <span class="st">&quot;Hello, </span><span class="va">$1</span><span class="st">&quot;</span></span>
<span id="cb48-3"><a href="cml.html#cb48-3" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb48-4"><a href="cml.html#cb48-4" tabindex="-1"></a></span>
<span id="cb48-5"><a href="cml.html#cb48-5" tabindex="-1"></a><span class="ex">greet</span> 大佬</span></code></pre></div>
<pre><code>## Hello, 大佬</code></pre>
<p><code>bash</code>函数可以有return关键字指定返回结果，也可以默认将最后一行的运行结果作为返回值。</p>
</div>
<div id="linux文件与目录管理" class="section level2 hasAnchor" number="10.6">
<h2><span class="header-section-number">10.6</span> Linux文件与目录管理<a href="cml.html#linux文件与目录管理" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="linux-链接" class="section level3 hasAnchor" number="10.6.1">
<h3><span class="header-section-number">10.6.1</span> Linux 链接<a href="cml.html#linux-链接" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Linux链接分两种，一种被称为硬链接（Hard Link），另一种被称为符号链接（Symbolic Link，也叫软链接）。在Linux文件系统中，所有保存在磁盘分区中的文件都会被分配一个编号，称为索引节点号（Inode Index）。</p>
<p>硬链接指的是，多个文件名指向同一个索引节点，文件之间是平等的。默认情况下，<code>ln f1 f2</code>命令创建f1的一个硬链接文件f2硬链接。例如，</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb50-1"><a href="cml.html#cb50-1" tabindex="-1"></a><span class="fu">touch</span> link_f1</span>
<span id="cb50-2"><a href="cml.html#cb50-2" tabindex="-1"></a><span class="fu">ln</span> link_f1 link_f2 <span class="co"># </span></span>
<span id="cb50-3"><a href="cml.html#cb50-3" tabindex="-1"></a><span class="fu">ls</span> <span class="at">-li</span> <span class="kw">|</span> <span class="fu">grep</span> <span class="st">&#39;link_f&#39;</span> <span class="co"># -i参数显示文件的inode节点信息</span></span></code></pre></div>
<pre><code>## 525329738 -rw-r--r--@   2 birdstone  staff        0 Feb  1 11:11 link_f1
## 525329738 -rw-r--r--@   2 birdstone  staff        0 Feb  1 11:11 link_f2
## 521855736 lrwxr-xr-x    1 birdstone  staff        7 Jan  2 17:30 link_f3 -&gt; link_f1</code></pre>
<p>可以看到link_f1与link_f2的节点都是521852386，如果我们修改其中一个文件的内容，另一个文件也会被修改（实际上是同一个文件）。</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb52-1"><a href="cml.html#cb52-1" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&#39;I am file 1&#39;</span> <span class="op">&gt;&gt;</span> link_f1</span>
<span id="cb52-2"><a href="cml.html#cb52-2" tabindex="-1"></a><span class="fu">cat</span> link_f2</span></code></pre></div>
<pre><code>## I am file 1</code></pre>
<p>删除其中一个文件，不会影响另一个文件，只有删除所有相关的硬链接才能将文件真正删除。</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb54-1"><a href="cml.html#cb54-1" tabindex="-1"></a><span class="fu">rm</span> link_f1</span>
<span id="cb54-2"><a href="cml.html#cb54-2" tabindex="-1"></a><span class="fu">cat</span> link_f2</span>
<span id="cb54-3"><a href="cml.html#cb54-3" tabindex="-1"></a><span class="fu">rm</span> link_f2</span>
<span id="cb54-4"><a href="cml.html#cb54-4" tabindex="-1"></a><span class="fu">cat</span> link_f2</span></code></pre></div>
<pre><code>## I am file 1
## cat: link_f2: No such file or directory</code></pre>
<p>符号连接，类似于Windows系统的快捷方式，是一种特殊的文本文件，文件中储存了另一个文件的位置信息。<code>ln -s f1 f3</code>命令创建f1的一个硬链接文件f3软链接，此时，f1和f3的节点号是不同的，执行不同的数据块，f3中储存的是f1的路径名称，当初删除f1时，f3会指向一个无效的位置。</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb56-1"><a href="cml.html#cb56-1" tabindex="-1"></a><span class="fu">touch</span> link_f1</span>
<span id="cb56-2"><a href="cml.html#cb56-2" tabindex="-1"></a><span class="fu">ln</span> <span class="at">-s</span> link_f1 link_f3 </span>
<span id="cb56-3"><a href="cml.html#cb56-3" tabindex="-1"></a><span class="fu">ls</span> <span class="at">-li</span> <span class="kw">|</span> <span class="fu">grep</span> <span class="st">&#39;link_f&#39;</span> <span class="co"># -i参数显示文件的inode节点信息</span></span>
<span id="cb56-4"><a href="cml.html#cb56-4" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&#39;I am file 1&#39;</span> <span class="op">&gt;&gt;</span> link_f1</span>
<span id="cb56-5"><a href="cml.html#cb56-5" tabindex="-1"></a><span class="fu">cat</span> link_f3</span>
<span id="cb56-6"><a href="cml.html#cb56-6" tabindex="-1"></a><span class="fu">rm</span> link_f1</span>
<span id="cb56-7"><a href="cml.html#cb56-7" tabindex="-1"></a><span class="fu">cat</span> link_f3</span></code></pre></div>
<pre><code>## ln: link_f3: File exists
## 525329741 -rw-r--r--@   1 birdstone  staff        0 Feb  1 11:11 link_f1
## 521855736 lrwxr-xr-x    1 birdstone  staff        7 Jan  2 17:30 link_f3 -&gt; link_f1
## I am file 1
## cat: link_f3: No such file or directory</code></pre>
</div>
</div>
<div id="应用案例" class="section level2 hasAnchor" number="10.7">
<h2><span class="header-section-number">10.7</span> 应用案例<a href="cml.html#应用案例" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>在获取谷歌专利文本时，如果把所有输出文件都放在同一个路径当中，将会给文件系统带来沉重的负担，甚至无法方便打开文件夹，更别说后续操作。因此，我们需要把任务设计地更细致。我们设计一个文件储存的架构，每100个文件储存在一个路径中，然后每100个文件夹再组成上一级目录，以此类推。下面的脚本可以实现这个功能。</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb58-1"><a href="cml.html#cb58-1" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb58-2"><a href="cml.html#cb58-2" tabindex="-1"></a><span class="cf">if</span> <span class="bu">[</span> <span class="ot">!</span> <span class="ot">-d</span> <span class="st">&quot;./description/</span><span class="va">$2</span><span class="st">&quot;</span> <span class="bu">]</span></span>
<span id="cb58-3"><a href="cml.html#cb58-3" tabindex="-1"></a><span class="cf">then</span></span>
<span id="cb58-4"><a href="cml.html#cb58-4" tabindex="-1"></a>        <span class="fu">mkdir</span> ./description/<span class="va">$2</span></span>
<span id="cb58-5"><a href="cml.html#cb58-5" tabindex="-1"></a><span class="cf">fi</span></span>
<span id="cb58-6"><a href="cml.html#cb58-6" tabindex="-1"></a></span>
<span id="cb58-7"><a href="cml.html#cb58-7" tabindex="-1"></a><span class="cf">if</span> <span class="bu">[</span> <span class="ot">!</span> <span class="ot">-d</span> <span class="st">&quot;./description/</span><span class="va">$2</span><span class="st">/</span><span class="va">$3</span><span class="st">&quot;</span> <span class="bu">]</span></span>
<span id="cb58-8"><a href="cml.html#cb58-8" tabindex="-1"></a><span class="cf">then</span></span>
<span id="cb58-9"><a href="cml.html#cb58-9" tabindex="-1"></a>        <span class="fu">mkdir</span> ./description/<span class="va">$2</span>/<span class="va">$3</span></span>
<span id="cb58-10"><a href="cml.html#cb58-10" tabindex="-1"></a><span class="cf">fi</span></span>
<span id="cb58-11"><a href="cml.html#cb58-11" tabindex="-1"></a></span>
<span id="cb58-12"><a href="cml.html#cb58-12" tabindex="-1"></a><span class="va">c</span><span class="op">=</span>0</span>
<span id="cb58-13"><a href="cml.html#cb58-13" tabindex="-1"></a><span class="fu">cat</span> <span class="va">$1</span> <span class="kw">|</span> <span class="cf">while</span> <span class="bu">read</span> <span class="va">line</span></span>
<span id="cb58-14"><a href="cml.html#cb58-14" tabindex="-1"></a><span class="cf">do</span></span>
<span id="cb58-15"><a href="cml.html#cb58-15" tabindex="-1"></a>        <span class="bu">echo</span> <span class="st">&quot;Downloading:</span><span class="va">${line}</span><span class="st">&quot;</span></span>
<span id="cb58-16"><a href="cml.html#cb58-16" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">[</span> <span class="ot">!</span> <span class="ot">-d</span> <span class="st">&quot;./description/</span><span class="va">$2</span><span class="st">/</span><span class="va">$3</span><span class="st">/</span><span class="va">$((c</span><span class="op">/</span><span class="dv">100</span><span class="va">))</span><span class="st">&quot;</span> <span class="bu">]</span></span>
<span id="cb58-17"><a href="cml.html#cb58-17" tabindex="-1"></a>        <span class="cf">then</span></span>
<span id="cb58-18"><a href="cml.html#cb58-18" tabindex="-1"></a>                <span class="fu">mkdir</span> ./description/<span class="va">$2</span>/<span class="va">$3</span>/<span class="va">$((c</span><span class="op">/</span><span class="dv">100</span><span class="va">))</span></span>
<span id="cb58-19"><a href="cml.html#cb58-19" tabindex="-1"></a>        <span class="cf">fi</span></span>
<span id="cb58-20"><a href="cml.html#cb58-20" tabindex="-1"></a>        <span class="ex">curl</span> <span class="at">-k</span> https://patents.google.com/patent/<span class="va">${line}</span> <span class="op">&gt;</span> ./description/<span class="va">$2</span>/<span class="va">$3</span>/<span class="va">$((c</span><span class="op">/</span><span class="dv">100</span><span class="va">))</span>/<span class="va">${line}</span>.html</span>
<span id="cb58-21"><a href="cml.html#cb58-21" tabindex="-1"></a>        <span class="bu">let</span> <span class="va">c</span><span class="op">++</span></span>
<span id="cb58-22"><a href="cml.html#cb58-22" tabindex="-1"></a><span class="cf">done</span></span></code></pre></div>
</div>
<div id="通配符与bash内建正则表达式" class="section level2 hasAnchor" number="10.8">
<h2><span class="header-section-number">10.8</span> 通配符与bash内建正则表达式<a href="cml.html#通配符与bash内建正则表达式" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>通配符可以按照规则匹配，用于构造简单的匹配模式，批量匹配。<code>*</code>匹配任意多个任意字符；<code>？</code>匹配一个任意字符。但是通配符可以匹配的空间比较有限，这就需要使用正则表达式。</p>
<p>在<code>bash</code>里面也内建了正则表达式的匹配，效率远远高于使用<code>egrep</code>。</p>
<p>由<code>[[ EXPR =~ REGEX ]]</code> 可以判断<code>EXPR</code> 是否能被<code>REGEX</code>匹配。运算支持扩展正则表达式，匹配结果由<code>BASH_REMATCH</code>列表给出。</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb59-1"><a href="cml.html#cb59-1" tabindex="-1"></a><span class="fu">seq</span> 1000 <span class="kw">|</span> <span class="cf">until</span> <span class="ot">! </span><span class="bu">read</span> <span class="va">line</span></span>
<span id="cb59-2"><a href="cml.html#cb59-2" tabindex="-1"></a><span class="cf">do</span></span>
<span id="cb59-3"><a href="cml.html#cb59-3" tabindex="-1"></a>  <span class="cf">if</span> <span class="kw">[[</span> <span class="va">$line</span> <span class="ot">=~</span> <span class="pp">^</span><span class="ss">23</span><span class="pp">+</span><span class="op">$</span> <span class="kw">]];</span> <span class="cf">then</span></span>
<span id="cb59-4"><a href="cml.html#cb59-4" tabindex="-1"></a>    <span class="bu">echo</span> <span class="va">${line}</span></span>
<span id="cb59-5"><a href="cml.html#cb59-5" tabindex="-1"></a>    <span class="bu">echo</span> <span class="va">${BASH_REMATCH</span><span class="op">[</span><span class="dv">0</span><span class="op">]</span><span class="va">}</span></span>
<span id="cb59-6"><a href="cml.html#cb59-6" tabindex="-1"></a>  <span class="cf">fi</span></span>
<span id="cb59-7"><a href="cml.html#cb59-7" tabindex="-1"></a><span class="cf">done</span></span></code></pre></div>
<pre><code>## 23
## 23
## 233
## 233</code></pre>
</div>
<div id="grep命令-1" class="section level2 hasAnchor" number="10.9">
<h2><span class="header-section-number">10.9</span> grep命令<a href="cml.html#grep命令-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><code>grep</code>、<code>sed</code>与<code>awk</code>并称Linux文件处理三剑客。<code>grep</code>的全称为“Global search Regular Expression and Print out the line”，顾名思义，<code>grep</code>命令实现的功能是
查找，四舍五入等同于Windows中的“ctrl+F”实现的功能。工作时，逐行检验输入是否与正则表达式匹配，若是则输出该行。</p>
<p><code>grep</code>命令使用基本正则表达式，<code>grep -E</code>可以指定使用扩展正则表达式。由于，该命令使用频率很高，因此直接被封装为<code>egrep</code>命令。<code>-n</code>参数可以输出匹配结果所在行数，<code>-v</code>参数表示返回不包括后续正则表达式的行。</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb61-1"><a href="cml.html#cb61-1" tabindex="-1"></a><span class="fu">seq</span> 10000 <span class="kw">|</span> <span class="fu">egrep</span> <span class="at">-n</span> <span class="st">&#39;^23{2,4}$&#39;</span></span></code></pre></div>
<pre><code>## 233:233
## 2333:2333</code></pre>
<p>在实践中，<code>egrep</code>经常会配合其他命令使用，例如找出当前进程中的python进程。</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb63-1"><a href="cml.html#cb63-1" tabindex="-1"></a><span class="fu">seq</span> 10000 <span class="kw">|</span> <span class="fu">egrep</span> <span class="at">-n</span> <span class="st">&#39;^23{2,4}$&#39;</span></span></code></pre></div>
<pre><code>## 233:233
## 2333:2333</code></pre>
<p><code>grep</code>常用的参数含义如下：</p>
<table>
<colgroup>
<col width="22%" />
<col width="77%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">参数</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">–color</td>
<td align="left">表示对匹配到的文本着色显示</td>
</tr>
<tr class="even">
<td align="left">-i</td>
<td align="left">在搜索的时候忽略大小写</td>
</tr>
<tr class="odd">
<td align="left">-n</td>
<td align="left">显示结果所在行号</td>
</tr>
<tr class="even">
<td align="left">-c</td>
<td align="left">统计匹配到的行数，注意，是匹配到的总行数，不是匹配到的次数</td>
</tr>
<tr class="odd">
<td align="left">-o</td>
<td align="left">只显示符合条件的字符串，但是不整行显示，每个符合条件的字符串单独显示一行</td>
</tr>
<tr class="even">
<td align="left">-v</td>
<td align="left">输出不带关键字的行（反向匹配）</td>
</tr>
<tr class="odd">
<td align="left">-w</td>
<td align="left">匹配整个单词，如果是字符串中包含这个单词，则不作匹配</td>
</tr>
<tr class="even">
<td align="left">-e</td>
<td align="left">实现多个选项的匹配，逻辑or关系</td>
</tr>
<tr class="odd">
<td align="left">-q</td>
<td align="left">静默模式，不输出任何信息，当我们只关心有没有匹配到，却不关心匹配到什么内容时，我们可以使用此命令，然后，使用”echo $?”查看是否匹配到，0表示匹配到，1表示没有匹配到</td>
</tr>
<tr class="even">
<td align="left">-P</td>
<td align="left">表示使用兼容perl的正则引擎</td>
</tr>
<tr class="odd">
<td align="left">-E</td>
<td align="left">使用扩展正则表达式，而不是基本正则表达式，在使用”-E”选项时，相当于使用egrep</td>
</tr>
</tbody>
</table>
</div>
<div id="sed命令-1" class="section level2 hasAnchor" number="10.10">
<h2><span class="header-section-number">10.10</span> sed命令<a href="cml.html#sed命令-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><code>sed</code>是流编辑器（stream editor）的简称，它由Lee E. McMahon 在1973-1974年编写，最初出现在 Unix版本7中。今年刚好五十岁了，是本书介绍到的最古老的工具之一，历经半个世纪依然被大家使用，<code>sed</code>一定尤其独到的优势。</p>
<p><code>sed</code>的工作原理如下图所示。<code>sed</code>继承自打印机<code>ed</code>命令，因此保留了很多<code>ed</code>的传统。它每次从输入文件读入一行数据（同时删除换行符）到临时缓冲区的模式空间，然后根据脚本中定义的动作对数据进行处理，处理完成后添加换行符，同时输出到输出文件，当前工作周期结束。然后开始处理下一行数据，直到文件末尾。</p>
<p>为了实现相对复杂的任务，临时缓冲区又分为两个空间，模式空间（pattern space）用于储存当前处理的数据，保持空间（hold space）不同处理周期之间的的数据。</p>
<p>在<code>macOS</code>中，<code>GNU sed</code>的命令是<code>gsed</code>，使用时需要注意下，不要搞混。</p>
<p><img src="images/cml/sed.png" width="90%" /></p>
<div id="应用情景-1" class="section level3 hasAnchor" number="10.10.1">
<h3><span class="header-section-number">10.10.1</span> 应用情景<a href="cml.html#应用情景-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>sed</code>是一个微型编程语言，它最基本的功能是文本替换，类似于windows的ctrl+F。仔细阅读sed的手册（<code>info sed</code>）之后会发现，<code>sed</code>的保持空间使其可以实现很多复杂的功能，例如对调文本的奇数行与偶数行，但是实现这些功能的脚本也同样更加复杂，不好理解，为了掌握这些功能需要投入过多的学习时间，导致边际收益小于边际成本，不经济。</p>
<p>因此，<code>sed</code>的适用范围一直存在争议，<code>sed</code>的拥趸认为要优先使用<code>sed</code>，除非<code>sed</code>实现不了相应的功能；另一方面的观点则认为，<code>sed</code>只用保留替换命令即可，其他功能都应该使用更复杂的语言（例如awk，perl或者python）。</p>
<p>我们认为学习<code>sed</code>的所有细节是没有必要的。在这里将介绍<code>sed</code>最常用的知识，并将其分为三个等级：基础功能、进阶功能、以及复杂功能。对于初学者只用掌握“基础功能”部分就可以满足大部分的数据工程需求。</p>
<ul>
<li><p><code>s///, d, n, p</code>属于基础功能；</p></li>
<li><p><code>=, a, c, i, l, q, Q,  y///, z</code> 属于进阶功能；</p></li>
<li><p><code>:, b, h, H, g, G, P, t, T, x</code>属于复杂功能；</p></li>
<li><p><code>F, r, R, v, w, W</code>则是不常用功能</p></li>
</ul>
<p><code>sed</code>的经典使用场景包括：（1）一文多改，一个文件上投入多个改动；（2）一脚多文，一个脚本用在多个文件；（3）高级<code>grep</code>，在查找关键词之前，先对待找的文本进行清洗；（4）管道过滤，直接对着标准输入过滤，给到标准输出。</p>
<p><code>sed</code>最常见的使用方式是所谓的“一句话编程”（one-liner programming），即在一行命令中来实现<code>sed</code>的功能。如果脚本已经非常复杂的话，建议考虑使用更复杂的语言（例如<code>awk</code>，<code>perl</code>或者<code>python</code>）。</p>
</div>
<div id="sed命令基本结构" class="section level3 hasAnchor" number="10.10.2">
<h3><span class="header-section-number">10.10.2</span> sed命令基本结构<a href="cml.html#sed命令基本结构" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>sed</code>的命令格式如下：</p>
<pre><code>sed [-Options] [&#39;Commands&#39;] filename</code></pre>
<p>其中<code>[-Options]</code>为<code>sed</code>的选项；<code>['Commands']</code>为<code>sed</code>命令，需要用单引号包裹，以免被<code>bash</code>解释，命令也可以是一个脚本文件；filename是被处理的文件。</p>
<p><code>sed</code>可以被用在管道中，管道上一个命令的标注输出被作为处理文件。例如，下面的管道中使用<code>sed</code>把“2”替换成“3”。</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb66-1"><a href="cml.html#cb66-1" tabindex="-1"></a><span class="fu">seq</span> 10<span class="kw">|</span> <span class="ex">gsed</span> <span class="st">&#39;s/2/3/&#39;</span></span></code></pre></div>
<pre><code>## 1
## 3
## 3
## 4
## 5
## 6
## 7
## 8
## 9
## 10</code></pre>
<div id="sed选项" class="section level4 hasAnchor" number="10.10.2.1">
<h4><span class="header-section-number">10.10.2.1</span> sed选项<a href="cml.html#sed选项" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><code>sed</code>有很多命令行选项，此处列出最常用的。</p>
<table>
<colgroup>
<col width="27%" />
<col width="72%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">选项</th>
<th align="left">作用</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">-e SCRIPT</td>
<td align="left">指定SCRIPT中的文本为命令而非被处理文件，适用于多组命令的场景</td>
</tr>
<tr class="even">
<td align="left">-f SCRIPTFILE</td>
<td align="left">制定使用脚本文件SCRIPTFILE作为命令集</td>
</tr>
<tr class="odd">
<td align="left">-i</td>
<td align="left">直接修改输入文件，通过创建一个临时文件并将输出发送到这个文件而不是标准输出来完成这项工作</td>
</tr>
<tr class="even">
<td align="left">-n</td>
<td align="left">默认情况下，<code>sed</code>在每个循环结束时通过脚本打印出模式空间。-n将禁用自动打印，并且 sed 只在通过 p 命令明确告知时才生成输出。</td>
</tr>
<tr class="odd">
<td align="left">-r, -E</td>
<td align="left">使用扩展正则表达式而不是基本正则表达式</td>
</tr>
</tbody>
</table>
<p>值得注意的是，<code>-i</code>选项会对原数据文件进行修改，可能造成原数据不可逆的变化，使用该选项的时候一定要慎重，</p>
</div>
<div id="sed命令-2" class="section level4 hasAnchor" number="10.10.2.2">
<h4><span class="header-section-number">10.10.2.2</span> sed命令<a href="cml.html#sed命令-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><code>sed</code>命令的基本结构如下：</p>
<pre><code>[ADDR]X[OPTIONS]</code></pre>
<p>其中，<code>[ ADDR ]</code>是一个可选项的地址规范，用于确定命令执行的范围（哪些行），<code>[ ADDR ]</code>可以是单个行号、正则表达式或行的范围；<code>X</code>代表单字母命令，其实质是一个bash函数；<code>[OPTIONS]</code>则是命令对应的选项。</p>
</div>
<div id="sed脚本" class="section level4 hasAnchor" number="10.10.2.3">
<h4><span class="header-section-number">10.10.2.3</span> <code>sed</code>脚本<a href="cml.html#sed脚本" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>多个命令可以通过<code>{}</code>压缩在一行使用，例如<code>{ X; Y; Z }</code>；也按行分割存入一个脚本文件，通过<code>-f</code>选项在<code>sed</code>命令中调用。</p>
</div>
<div id="sed命令清单" class="section level4 hasAnchor" number="10.10.2.4">
<h4><span class="header-section-number">10.10.2.4</span> sed命令清单<a href="cml.html#sed命令清单" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
</div>
<div id="s命令substitute" class="section level3 hasAnchor" number="10.10.3">
<h3><span class="header-section-number">10.10.3</span> s命令（substitute）<a href="cml.html#s命令substitute" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>s命令是<code>sed</code>最常用的命令，基本形式如下：</p>
<pre><code>s/REGEXP/REPLACEMENT/[FLAGS]</code></pre>
<p>其中，<code>/</code>为默认的分隔符，s命令将模式空间与提供的正则表达式<code>REGEXP</code> 进行匹配; 如果匹配成功，则将匹配的模式空间部分替换为<code>REPLACEMENT</code>。</p>
<p>例如：</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb70-1"><a href="cml.html#cb70-1" tabindex="-1"></a><span class="bu">echo</span> hello <span class="kw">|</span> <span class="ex">gsed</span> <span class="st">&#39;s/lo/do/&#39;</span></span></code></pre></div>
<pre><code>## heldo</code></pre>
<div id="替换分隔符" class="section level4 hasAnchor" number="10.10.3.1">
<h4><span class="header-section-number">10.10.3.1</span> 替换分隔符<a href="cml.html#替换分隔符" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>如果正则表达式本身包含<code>/</code>字符，则通常使用不同的分隔符。<code>sed</code> 接受任何字符作为替换分隔符。</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb72-1"><a href="cml.html#cb72-1" tabindex="-1"></a><span class="bu">echo</span> hello <span class="kw">|</span> <span class="ex">gsed</span> <span class="st">&#39;s!lo!do!&#39;</span></span></code></pre></div>
<pre><code>## heldo</code></pre>
</div>
<div id="分组引用" class="section level4 hasAnchor" number="10.10.3.2">
<h4><span class="header-section-number">10.10.3.2</span> 分组引用<a href="cml.html#分组引用" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>当使用扩展正则表达式时，<code>sed</code>支持分组与引用。</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb74-1"><a href="cml.html#cb74-1" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&#39;Dongbo Shi&#39;</span> <span class="kw">|</span> <span class="fu">sed</span> <span class="at">-E</span> <span class="st">&#39;s/(.*) (.*)/The family name is \2, \1 \2./&#39;</span></span></code></pre></div>
<pre><code>## The family name is Shi, Dongbo Shi.</code></pre>
<p>下一节，我们会看到这个例子使用<code>awk</code>会非常简洁。</p>
<p><code>&amp;</code>则可以表示所有匹配上的字符，例如下面的例子将一个空格变成两个空格。</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb76-1"><a href="cml.html#cb76-1" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&#39;a b c&#39;</span> <span class="kw">|</span> <span class="ex">gsed</span> <span class="st">&#39;s/ /&amp;&amp;/&#39;</span></span></code></pre></div>
<pre><code>## a  b c</code></pre>
</div>
<div id="大小写转换" class="section level4 hasAnchor" number="10.10.3.3">
<h4><span class="header-section-number">10.10.3.3</span> 大小写转换<a href="cml.html#大小写转换" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>下面的扩展可以支持字符间的大小写转换。</p>
<table>
<thead>
<tr class="header">
<th align="left">字符</th>
<th align="left">功能</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>\L</code></td>
<td align="left">将替换项转换为小写，直到<code>\U</code>或<code>\E</code></td>
</tr>
<tr class="even">
<td align="left"><code>\l</code></td>
<td align="left">将下一个字符转换为小写</td>
</tr>
<tr class="odd">
<td align="left"><code>\U</code></td>
<td align="left">将替换项转换为大写，直到<code>\L</code>或<code>E</code></td>
</tr>
<tr class="even">
<td align="left"><code>\u</code></td>
<td align="left">将下一个字符转换为大写</td>
</tr>
<tr class="odd">
<td align="left"><code>\E</code></td>
<td align="left">停止大小写转换</td>
</tr>
</tbody>
</table>
<p>下面的例子中将单词的首字母转换成大写</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb78-1"><a href="cml.html#cb78-1" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;hello world&quot;</span> <span class="kw">|</span> <span class="ex">gsed</span> <span class="at">-E</span> <span class="st">&#39;s/([a-zA-Z]+\s?)/\u\1/g&#39;</span></span></code></pre></div>
<pre><code>## Hello World</code></pre>
</div>
<div id="标识flags" class="section level4 hasAnchor" number="10.10.3.4">
<h4><span class="header-section-number">10.10.3.4</span> 标识（flags）<a href="cml.html#标识flags" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>上面的例子中的<code>g</code>属于<code>s</code>命令的标识，表示替换所有匹配成功的模式。<code>s</code>的常用标识如下：</p>
<table>
<thead>
<tr class="header">
<th align="left">标识</th>
<th align="left">功能</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">g</td>
<td align="left">全局替换</td>
</tr>
<tr class="even">
<td align="left">NUMBER</td>
<td align="left">制定替换数目</td>
</tr>
<tr class="odd">
<td align="left">p</td>
<td align="left">如果进行了替换，则打印新的模式空间</td>
</tr>
<tr class="even">
<td align="left">w FILENAME</td>
<td align="left">如果进行了替换，则将结果写入指定的文件</td>
</tr>
<tr class="odd">
<td align="left">I</td>
<td align="left">以不区分大小写的方式匹配</td>
</tr>
<tr class="even">
<td align="left">M, m</td>
<td align="left">多行模式下匹配正则表达式</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb80"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb80-1"><a href="cml.html#cb80-1" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;a=b=c=d&quot;</span> <span class="kw">|</span> <span class="ex">gsed</span> <span class="st">&#39;s/=/ /2g&#39;</span></span></code></pre></div>
<pre><code>## a=b c d</code></pre>
</div>
</div>
<div id="d命令deletep命令print和n命令next" class="section level3 hasAnchor" number="10.10.4">
<h3><span class="header-section-number">10.10.4</span> d命令（delete）、p命令（print）和n命令（next）<a href="cml.html#d命令deletep命令print和n命令next" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>d</code>命令用于删除模式空间，并立即开始下一个循环。例如，</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb82-1"><a href="cml.html#cb82-1" tabindex="-1"></a><span class="fu">seq</span> 20<span class="kw">|</span><span class="ex">gsed</span> <span class="st">&#39;/[2-3]/d&#39;</span> </span></code></pre></div>
<pre><code>## 1
## 4
## 5
## 6
## 7
## 8
## 9
## 10
## 11
## 14
## 15
## 16
## 17
## 18
## 19</code></pre>
<p><code>p</code>命令将模式空间打印到标准输出，P通常只与<code>-n</code>选项结合使用。否则，打印每一行就是<code>sed</code>的默认行为。</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb84-1"><a href="cml.html#cb84-1" tabindex="-1"></a><span class="fu">seq</span> 10<span class="kw">|</span> <span class="ex">gsed</span> <span class="at">-n</span> 1,3p</span></code></pre></div>
<pre><code>## 1
## 2
## 3</code></pre>
<p><code>n</code>命令的行为取决于是否启用了<code>-n</code>选项。启用<code>-n</code>时，只需将模式空间替换为下一行输入。未启用<code>-n</code>时，则打印模式空间，然后用下一行输入替换它。</p>
<p>例如，下面的命令中会依次打印3之后的两行：</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb86-1"><a href="cml.html#cb86-1" tabindex="-1"></a><span class="fu">seq</span> 10 <span class="kw">|</span> <span class="ex">gsed</span> <span class="at">-n</span> <span class="st">&#39;/3/{p;n;p;n;p;}&#39;</span></span></code></pre></div>
<pre><code>## 3
## 4
## 5</code></pre>
<p>下面的例子，每隔3行执行一次替换：</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb88-1"><a href="cml.html#cb88-1" tabindex="-1"></a><span class="fu">seq</span> 6 <span class="kw">|</span> <span class="ex">gsed</span> <span class="st">&#39;n;n;s/./x/&#39;</span></span></code></pre></div>
<pre><code>## 1
## 2
## x
## 4
## 5
## x</code></pre>
</div>
<div id="地址规范" class="section level3 hasAnchor" number="10.10.5">
<h3><span class="header-section-number">10.10.5</span> 地址规范<a href="cml.html#地址规范" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>在讲其他进阶命令之前，我们先介绍一下如何在<code>sed</code>定位要处理的行。</p>
<p>第一种方法是直接指定文件中所需的实际行号。例如，从文件中删除第二行：</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb90-1"><a href="cml.html#cb90-1" tabindex="-1"></a><span class="fu">seq</span> 6 <span class="kw">|</span> <span class="ex">gsed</span> <span class="st">&#39;2d&#39;</span></span></code></pre></div>
<pre><code>## 1
## 3
## 4
## 5
## 6</code></pre>
<p>最后一行指定为$，删除最后一行：</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb92-1"><a href="cml.html#cb92-1" tabindex="-1"></a><span class="fu">seq</span> 6 <span class="kw">|</span> <span class="ex">gsed</span> <span class="st">&#39;$d&#39;</span></span></code></pre></div>
<pre><code>## 1
## 2
## 3
## 4
## 5</code></pre>
<p>第二种方法是使用<code>~</code>来定义行间隔，例如以间隔2来输出文件的偶数行。</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb94-1"><a href="cml.html#cb94-1" tabindex="-1"></a><span class="fu">seq</span> 10 <span class="kw">|</span> <span class="ex">gsed</span> <span class="at">-n</span> <span class="st">&#39;0~2p&#39;</span></span></code></pre></div>
<pre><code>## 2
## 4
## 6
## 8
## 10</code></pre>
<p>第三种方法是通过正则表达式<code>/regexp/</code>来定位行，此处<code>/</code>为分隔符，也可以使用其他符号替代。例如输出前一百个整数中以1开头的数字。</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb96-1"><a href="cml.html#cb96-1" tabindex="-1"></a><span class="fu">seq</span> 100 <span class="kw">|</span> <span class="ex">gsed</span> <span class="at">-n</span> <span class="st">&#39;/^1/p&#39;</span></span></code></pre></div>
<pre><code>## 1
## 10
## 11
## 12
## 13
## 14
## 15
## 16
## 17
## 18
## 19
## 100</code></pre>
<p>第四种方法是指定行号或者模式间的范围，起始行用<code>,</code>分割。例如：</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb98-1"><a href="cml.html#cb98-1" tabindex="-1"></a><span class="fu">seq</span> 10 <span class="kw">|</span> <span class="ex">gsed</span> <span class="at">-n</span> <span class="st">&#39;1,3p&#39;</span></span></code></pre></div>
<pre><code>## 1
## 2
## 3</code></pre>
<div class="sourceCode" id="cb100"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb100-1"><a href="cml.html#cb100-1" tabindex="-1"></a><span class="fu">seq</span> 10 <span class="kw">|</span> <span class="ex">gsed</span> <span class="at">-n</span> <span class="st">&#39;/6/,/8/p&#39;</span></span></code></pre></div>
<pre><code>## 6
## 7
## 8</code></pre>
<p>第五种方法是匹配模式之后，添加偏移量。例如，要选择与模式匹配的一行后面的两行。</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb102-1"><a href="cml.html#cb102-1" tabindex="-1"></a><span class="fu">seq</span> 10 <span class="kw">|</span> <span class="ex">gsed</span> <span class="at">-n</span> <span class="st">&#39;/6/,+2p&#39;</span></span></code></pre></div>
<pre><code>## 6
## 7
## 8</code></pre>
<p>第六种方法是匹配模式之后，到整除关系的行。例如，可以从一个模式匹配的行中选择一个可以被3整除的行号。</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb104-1"><a href="cml.html#cb104-1" tabindex="-1"></a><span class="fu">seq</span> 30 <span class="kw">|</span> <span class="ex">gsed</span> <span class="at">-n</span> /5/,~3p</span></code></pre></div>
<pre><code>## 5
## 6
## 15
## 16
## 17
## 18
## 25
## 26
## 27</code></pre>
<p>最后如果<code>!</code>位于地址或地址范围之后，则只选择与地址不匹配的行。</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb106-1"><a href="cml.html#cb106-1" tabindex="-1"></a><span class="fu">seq</span> 6 <span class="kw">|</span> <span class="ex">gsed</span> <span class="at">-n</span> <span class="st">&#39;/3/,/4/!p&#39;</span></span></code></pre></div>
<pre><code>## 1
## 2
## 5
## 6</code></pre>
</div>
<div id="q和q命令quit" class="section level3 hasAnchor" number="10.10.6">
<h3><span class="header-section-number">10.10.6</span> q和Q命令（quit）<a href="cml.html#q和q命令quit" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>这组命令用于退出<code>sed</code>并停止打印，q 打印行然后退出，而 Q 不打印就退出。例如，</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb108-1"><a href="cml.html#cb108-1" tabindex="-1"></a><span class="fu">seq</span> 10 <span class="kw">|</span> <span class="ex">gsed</span> <span class="st">&#39;0,/3/d;/7/Q&#39;</span></span>
<span id="cb108-2"><a href="cml.html#cb108-2" tabindex="-1"></a><span class="fu">seq</span> 10 <span class="kw">|</span> <span class="ex">gsed</span> <span class="st">&#39;0,/3/d;/7/q&#39;</span></span></code></pre></div>
<pre><code>## 4
## 5
## 6
## 4
## 5
## 6
## 7</code></pre>
</div>
<div id="y命令" class="section level3 hasAnchor" number="10.10.7">
<h3><span class="header-section-number">10.10.7</span> y命令<a href="cml.html#y命令" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>Y/SRC/DST/</code>命令在模式空间中替换匹配任何SRC和DST中对应字符的字符。例如，将所有大写字母转换为小写字母：</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb110-1"><a href="cml.html#cb110-1" tabindex="-1"></a><span class="va">uc</span><span class="op">=</span><span class="st">&#39;ABCDEFGHIJKLMNOPQRSTUVWXYZ&#39;</span></span>
<span id="cb110-2"><a href="cml.html#cb110-2" tabindex="-1"></a><span class="va">lc</span><span class="op">=</span><span class="st">&#39;abcdefghijklmnopqrstuvwxyz&#39;</span></span>
<span id="cb110-3"><a href="cml.html#cb110-3" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&#39;Hello WoRLD&#39;</span> <span class="kw">|</span> <span class="ex">gsed</span> <span class="st">&quot;y/</span><span class="va">$uc</span><span class="st">/</span><span class="va">$lc</span><span class="st">/&quot;</span></span></code></pre></div>
<pre><code>## hello world</code></pre>
</div>
<div id="ia和c命令insert-append-change" class="section level3 hasAnchor" number="10.10.8">
<h3><span class="header-section-number">10.10.8</span> i、a和c命令（insert, append, change）<a href="cml.html#ia和c命令insert-append-change" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>使用<code>i</code>、<code>a</code>和<code>c</code>命令可以在前面插入、后面追加和替换（更改）匹配模式或满足条件的行。</p>
</div>
<div id="命令l命令和z命令zap" class="section level3 hasAnchor" number="10.10.9">
<h3><span class="header-section-number">10.10.9</span> =命令、l命令和z命令（zap）<a href="cml.html#命令l命令和z命令zap" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>使用<code>=</code>命令可以打印行号，有点像 cat-n 的替代品。<code>l</code>命令以明确的方式打印文本，显示隐藏的和不可打印的字符。<code>z</code> (zap)命令可以作为<code>s/.*//</code>的更可靠、更有效的替代方法，清空模式空间。</p>
<p>掌握以上知识就可以流畅的使用sed来处理数据了，更多复杂的功能可以参考<code>sed</code>的官方文档，但是不建议花时间深入学习。</p>
</div>
</div>
<div id="awk命令-1" class="section level2 hasAnchor" number="10.11">
<h2><span class="header-section-number">10.11</span> awk命令<a href="cml.html#awk命令-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><code>awk</code>是Alfred Aho 、Peter Weinberger和Brian Kernighan于1977年开发的，最早出现在Unix7版本中。也是一个将近50年的工具。<code>awk</code>是一个报告生成器，它拥有强大的文本格式化的能力。通俗来说，我们使用<code>awk</code>命令，将一些文本整理成我们想要的样子，比如把一些文本整理成”表”的样子，然后再展示出来。</p>
<p><code>awk</code>是一种模式匹配语言，它更贴近人类的思维习惯。在<code>awk</code>看来，每个文本文件都是一个数据仓库，在文本处理的同时集成算术运算。其工作方式是先用<code>awk</code>描述数据中的规律，然后再根据这个规律来提取信息。与<code>sed</code>一样，单行的<code>awk</code>程序可以直接从命令行输入，对于多行的<code>awk</code>程序可以写成脚本。</p>
<p>从<code>grep</code>到<code>sed</code>再到<code>awk</code>的复杂度和能力是逐步提升的，我们最佳工具原则推荐大家同一个人任务，优先选择简单的工具。</p>
<div id="awk入门" class="section level3 hasAnchor" number="10.11.1">
<h3><span class="header-section-number">10.11.1</span> awk入门<a href="cml.html#awk入门" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>awk</code>的基本结构如下：</p>
<pre><code>awk [options] &#39;Pattern{Action}&#39; file1, file2</code></pre>
<p>其中，<code>[options]</code>是选项，用于指定<code>awk</code>工作的方式；<code>‘Pattern{Action}’</code>合在一起是<code>awk</code>程序，Pattern通过模式匹配来确定<code>awk</code>程序工作的行，<code>action</code>是动作，最常用的是<code>print</code>与<code>printf</code>；file1和fil2是文件。</p>
<p>我们用一个简单的例子来说明，<code>filelist.txt</code>中储存的是某个磁盘下的文件目录。</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb113-1"><a href="cml.html#cb113-1" tabindex="-1"></a><span class="fu">head</span> filelist.txt</span></code></pre></div>
<pre><code>## drwxrwxr-x     4 ZLab  staff   136B Jan 31  2022 __MACOSX
## -rw-r-----     1 ZLab  staff   2.7M Aug 27  2021 accounting.csv
## -rw-r--r--     1 ZLab  staff   2.9G Aug 19  2021 disruption_final.csv
## drwxr-xr-x    18 ZLab  staff   612B Dec 26  2019 feature
## -rw-r-----     1 ZLab  staff   134M Aug 27  2021 firminvention.csv
## drwxr-xr-x  1099 ZLab  staff    36K Jun  4  2023 gp</code></pre>
<p>提取出来文件日期的信息，并修改成年月日的格式。</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb115-1"><a href="cml.html#cb115-1" tabindex="-1"></a><span class="fu">gawk</span> <span class="st">&#39;{ print $8,$6,$7 }&#39;</span> filelist.txt</span></code></pre></div>
<pre><code>## 2022 Jan 31
## 2021 Aug 27
## 2021 Aug 19
## 2019 Dec 26
## 2021 Aug 27
## 2023 Jun 4</code></pre>
<p>在上面的命令中，使用了<code>print</code>输出动作，<code>$n</code>表示文件的第n列是<code>awk</code>的内置变量，<code>$0</code>表示整行，<code>$NF</code>表示最后一列。</p>
<p>此外，还可以添加列：</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb117-1"><a href="cml.html#cb117-1" tabindex="-1"></a><span class="fu">gawk</span> <span class="st">&#39;{ print &quot;Date&quot;, $8, $6, $7 }&#39;</span> filelist.txt</span></code></pre></div>
<pre><code>## Date 2022 Jan 31
## Date 2021 Aug 27
## Date 2021 Aug 19
## Date 2019 Dec 26
## Date 2021 Aug 27
## Date 2023 Jun 4</code></pre>
<p><code>awk</code>有两类特殊模式：BEGIN和END。<code>BEGIN</code>模式指定了处理文本之前需要执行的操作，常用于添加表头；<code>END</code>模式指定了处理完所有行之后所需要执行的操作，常用于添加表尾。</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb119-1"><a href="cml.html#cb119-1" tabindex="-1"></a><span class="bu">echo</span> <span class="kw">|</span> <span class="fu">gawk</span> <span class="st">&#39;BEGIN{ print &quot;hello world&quot; }&#39;</span></span></code></pre></div>
<pre><code>## hello world</code></pre>
<div class="sourceCode" id="cb121"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb121-1"><a href="cml.html#cb121-1" tabindex="-1"></a><span class="fu">gawk</span> <span class="st">&#39;BEGIN{ print &quot;Year&quot;, &quot;Month&quot;, &quot;Day&quot; } { print $8, $6, $7 }&#39;</span> filelist.txt</span></code></pre></div>
<pre><code>## Year Month Day
## 2022 Jan 31
## 2021 Aug 27
## 2021 Aug 19
## 2019 Dec 26
## 2021 Aug 27
## 2023 Jun 4</code></pre>
<p><code>awk</code>的一个功能是整合了数值计算：</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb123-1"><a href="cml.html#cb123-1" tabindex="-1"></a><span class="fu">seq</span> 100 <span class="kw">|</span> <span class="fu">gawk</span> <span class="st">&#39;{total+=$NF} END {print total}&#39;</span></span></code></pre></div>
<pre><code>## 5050</code></pre>
</div>
<div id="awk工作原理" class="section level3 hasAnchor" number="10.11.2">
<h3><span class="header-section-number">10.11.2</span> awk工作原理<a href="cml.html#awk工作原理" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>awk</code>的工作原理如下图所示，第一步是执行BEGIN模式中的脚本，第二步针对文件逐行执行脚本，循环结束后执行END模式。</p>
<p><img src="images/cml/awk.png" width="90%" /></p>
<p>作为数据驱动的命令，没有文件输入的时候，是无法驱动<code>awk</code>的。</p>
<pre><code>awk &#39;{ print &quot;hello world&quot; }&#39;</code></pre>
</div>
<div id="awk分隔符" class="section level3 hasAnchor" number="10.11.3">
<h3><span class="header-section-number">10.11.3</span> awk分隔符<a href="cml.html#awk分隔符" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>awk</code>的输入输出默认使用空格作为文件的分割符，也可以指定其他符号为分隔符。</p>
<p><code>-F</code>选项用于指定输入分隔符，输出分隔符可以在程序中直接制定。</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb126-1"><a href="cml.html#cb126-1" tabindex="-1"></a><span class="fu">gawk</span> <span class="at">-F\t</span> <span class="st">&#39;{ print $47&quot;|&quot;$NF }&#39;</span> qje.txt <span class="kw">|</span> <span class="fu">head</span></span></code></pre></div>
<pre><code>## |﻿PT AU  BA  BE  GP  AF  BF  CA  TI  SO  SE  BS  LA  DT  CT  CY  CL  SP  HO  DE  ID  AB  C1  C3  RP  EM  RI  OI  FU  FP  FX  CR  NR  TC  Z9  U1  U2  PU  PI  PA  SN  EI  BN  J9  JI  PD  PY  VL  IS  PN  SU  SI  MA  BP  EP  AR  DI  DL  D2  EA  PG  WC  WE  SC  GA  PM  OA  HC  HP  DA  UT
## ed gender norms. Firs|ed         2023-11-07  WOS:000988607500001
## eres|ion Index (SSCI)    Business &amp; Economics    8H6OL                   2023-11-07  WOS:000868979600001
## ween managers and workers.   [Cai, Jing] Univ Maryland, NBER, College Pk, MD 20742 USA; Bur Res &amp; Econ Anal Dev, Sui|ion Index (SSCI)    Business &amp; Economics    4Q8QX       Green Published         2023-11-07  WOS:000813226900001
## ribu|ion Index (SSCI)    Business &amp; Economics    2Y8SI       Green Published         2023-11-07  WOS:000784752700001
## -currency safe asse|ion Index (SSCI) Business &amp; Economics    RQ3PS       Green Published         2023-11-07  WOS:000642334600003
## . I find s|ion Index (SSCI)  Business &amp; Economics    PY7CB                   2023-11-07  WOS:000612198000011
## ion of grocery re|ion Index (SSCI)   Business &amp; Economics    JC3FH           Y   N   2023-11-07  WOS:000489163400003
## e-level macroeconomic ou|ion Index (SSCI)    Business &amp; Economics    JC3EP       Green Published         2023-11-07  WOS:000489161300005
## ax and pos|ion Index (SSCI)  Business &amp; Economics    GK1JR       Green Published, hybrid Y   N   2023-11-07  WOS:000435871300001</code></pre>
<p>另一种方式是<code>-v</code>选项来修改内置变量，FS(Field Separator)对应输入分隔符，OFS(Output Field Separator)对应输出分隔符。</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb128-1"><a href="cml.html#cb128-1" tabindex="-1"></a><span class="fu">gawk</span> <span class="at">-v</span> FS=<span class="st">&quot;\t&quot;</span> <span class="at">-v</span> OFS=<span class="st">&quot;|&quot;</span> <span class="st">&#39;{ print $47,$NF }&#39;</span> qje.txt <span class="kw">|</span> <span class="fu">head</span></span></code></pre></div>
<pre><code>## PY|UT
## 2023|WOS:000988607500001
## 2022|WOS:000868979600001
## 2022|WOS:000813226900001
## 2022|WOS:000784752700001
## 2021|WOS:000642334600003
## 2021|WOS:000612198000011
## 2019|WOS:000489163400003
## 2019|WOS:000489161300005
## 2018|WOS:000435871300001</code></pre>
</div>
<div id="awk变量" class="section level3 hasAnchor" number="10.11.4">
<h3><span class="header-section-number">10.11.4</span> awk变量<a href="cml.html#awk变量" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>awk</code>变量又分为内置变量和自定义变量，前面使用的FS和OFS都属于内置变量。内置变量就是awk预定义好的、内置在awk内部的变量，而自定义变量就是用户定义的变量。</p>
<div id="内置变量" class="section level4 hasAnchor" number="10.11.4.1">
<h4><span class="header-section-number">10.11.4.1</span> 内置变量<a href="cml.html#内置变量" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><code>awk</code>常用内置变量包括：</p>
<table>
<colgroup>
<col width="23%" />
<col width="76%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">变量</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">FS</td>
<td align="left">输入字段分隔符，默认为空白字符</td>
</tr>
<tr class="even">
<td align="left">OFS</td>
<td align="left">输出字段分隔符，默认为空白字符</td>
</tr>
<tr class="odd">
<td align="left">RS</td>
<td align="left">输入记录分隔符(输入换行符)，指定输入时的换行符</td>
</tr>
<tr class="even">
<td align="left">ORS</td>
<td align="left">输出记录分隔符（输出换行符），输出时用指定符号代替换行符</td>
</tr>
<tr class="odd">
<td align="left">NF(Number of Field)</td>
<td align="left">当前行的字段的个数(即当前行被分割成了几列)，字段数量</td>
</tr>
<tr class="even">
<td align="left">NR</td>
<td align="left">行号，当前处理的文本行的行号</td>
</tr>
<tr class="odd">
<td align="left">FNR</td>
<td align="left">各文件分别计数的行号</td>
</tr>
<tr class="even">
<td align="left">FILENAME</td>
<td align="left">当前文件名</td>
</tr>
<tr class="odd">
<td align="left">ARGC</td>
<td align="left">命令行参数的个数</td>
</tr>
<tr class="even">
<td align="left">ARGV</td>
<td align="left">数组，保存的是命令行所给定的各参数</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb130"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb130-1"><a href="cml.html#cb130-1" tabindex="-1"></a><span class="fu">gawk</span> <span class="st">&#39;{ print NR,NF,FNR }&#39;</span> filelist.txt filelist.txt</span></code></pre></div>
<pre><code>## 1 9 1
## 2 9 2
## 3 9 3
## 4 9 4
## 5 9 5
## 6 9 6
## 7 9 1
## 8 9 2
## 9 9 3
## 10 9 4
## 11 9 5
## 12 9 6</code></pre>
</div>
<div id="自定义变量" class="section level4 hasAnchor" number="10.11.4.2">
<h4><span class="header-section-number">10.11.4.2</span> 自定义变量<a href="cml.html#自定义变量" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>两种方法可以自定义<code>awk</code>变量：第一种是通过<code>-v varname=value</code>，变量名区分字符大小写；第二种是在program中直接定义。</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb132-1"><a href="cml.html#cb132-1" tabindex="-1"></a><span class="fu">gawk</span> <span class="at">-v</span> var=<span class="st">&quot;hello&quot;</span> <span class="st">&#39;BEGIN{ print var,&quot;world&quot; }&#39;</span></span>
<span id="cb132-2"><a href="cml.html#cb132-2" tabindex="-1"></a><span class="fu">gawk</span> <span class="st">&#39;BEGIN{ var=&quot;hello&quot;; print var,&quot;world&quot; }&#39;</span></span>
<span id="cb132-3"><a href="cml.html#cb132-3" tabindex="-1"></a><span class="va">var2</span><span class="op">=</span><span class="st">&quot;Hello&quot;</span></span>
<span id="cb132-4"><a href="cml.html#cb132-4" tabindex="-1"></a><span class="fu">gawk</span> <span class="at">-v</span> var=<span class="va">$var2</span> <span class="st">&#39;BEGIN{ print var,&quot;world&quot; }&#39;</span></span></code></pre></div>
<pre><code>## hello world
## hello world
## Hello world</code></pre>
</div>
</div>
<div id="printf输出格式化" class="section level3 hasAnchor" number="10.11.5">
<h3><span class="header-section-number">10.11.5</span> printf输出格式化<a href="cml.html#printf输出格式化" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>printf</code>类似于<code>python</code>中的<code>fstring</code>，用以指定的格式输出文本。</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb134-1"><a href="cml.html#cb134-1" tabindex="-1"></a><span class="ex">gsed</span> <span class="at">-n</span> <span class="st">&#39;2,6p&#39;</span> qje.txt <span class="op">&gt;</span> qjeh.txt</span>
<span id="cb134-2"><a href="cml.html#cb134-2" tabindex="-1"></a><span class="fu">gawk</span> <span class="at">-v</span> FS=<span class="st">&quot;\t&quot;</span> <span class="st">&#39;{ printf &quot;出版年:%s,入藏号:%s\n&quot;, $47,$NF }&#39;</span> qjeh.txt</span></code></pre></div>
<pre><code>## 出版年:2023,入藏号:WOS:000988607500001
## 出版年:2022,入藏号:WOS:000868979600001
## 出版年:2022,入藏号:WOS:000813226900001
## 出版年:2022,入藏号:WOS:000784752700001
## 出版年:2021,入藏号:WOS:000642334600003</code></pre>
<p>格式替换符<code>%s</code>表示字符串，如果是浮点格式可以使用<code>%f</code>。</p>
<p>注意，<code>printf</code>动作输出的文本不会换行，如果需要换行，可以在对应的“格式替换符”后加入<code>\n</code>进行转义；使用<code>printf</code>动作时，“指定的格式” 与 “被格式化的文本” 之间，需要用”逗号”隔开；使用<code>printf</code>动作时，“格式”中的”格式替换符”必须与 “被格式化的文本” 一一对应。</p>
<p><code>printf</code>还可以指定输出宽度，以及对齐方式。</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb136-1"><a href="cml.html#cb136-1" tabindex="-1"></a><span class="fu">gawk</span> <span class="at">-v</span> FS=<span class="st">&quot;\t&quot;</span> <span class="st">&#39;{ printf &quot;出版年:%10s,入藏号:%s\n&quot;, $47,$NF }&#39;</span> qjeh.txt</span></code></pre></div>
<pre><code>## 出版年:      2023,入藏号:WOS:000988607500001
## 出版年:      2022,入藏号:WOS:000868979600001
## 出版年:      2022,入藏号:WOS:000813226900001
## 出版年:      2022,入藏号:WOS:000784752700001
## 出版年:      2021,入藏号:WOS:000642334600003</code></pre>
</div>
<div id="awk模式" class="section level3 hasAnchor" number="10.11.6">
<h3><span class="header-section-number">10.11.6</span> awk模式<a href="cml.html#awk模式" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>前文中已经介绍了两类特殊的模式：BEGIN与END。此外，在<code>awk</code>进行逐行处理文件的时候，会把模式作为条件，判断将要被处理的行是否满足条件，是否能跟”模式”进行匹配，如果匹配，则处理，如果不匹配，则不进行处理。其作用与<code>sed</code>中的定位行类似。</p>
<div id="关系运算模式" class="section level4 hasAnchor" number="10.11.6.1">
<h4><span class="header-section-number">10.11.6.1</span> 关系运算模式<a href="cml.html#关系运算模式" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>如果只处理文件的第三行，可以使用：</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb138-1"><a href="cml.html#cb138-1" tabindex="-1"></a><span class="fu">gawk</span> <span class="st">&#39;NR==3 { print $8,$6,$7 }&#39;</span> filelist.txt</span></code></pre></div>
<pre><code>## 2021 Aug 19</code></pre>
</div>
<div id="正则表达式模式" class="section level4 hasAnchor" number="10.11.6.2">
<h4><span class="header-section-number">10.11.6.2</span> 正则表达式模式<a href="cml.html#正则表达式模式" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>还可以使用正则表达式模式，同<code>sed</code>一样，正则表达式要放入<code>//</code>中，例如我们只想查看csv文件。</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb140-1"><a href="cml.html#cb140-1" tabindex="-1"></a><span class="fu">gawk</span> <span class="st">&#39;/csv$/ { print $0 }&#39;</span> filelist.txt</span></code></pre></div>
<pre><code>## -rw-r-----     1 ZLab  staff   2.7M Aug 27  2021 accounting.csv
## -rw-r--r--     1 ZLab  staff   2.9G Aug 19  2021 disruption_final.csv
## -rw-r-----     1 ZLab  staff   134M Aug 27  2021 firminvention.csv</code></pre>
<p>当使用<code>{m,n}</code>这种次数匹配的正则表达式时，需要配合<code>–posix</code>选项或者<code>–re-interval</code>选项。</p>
</div>
<div id="行范围模式" class="section level4 hasAnchor" number="10.11.6.3">
<h4><span class="header-section-number">10.11.6.3</span> 行范围模式<a href="cml.html#行范围模式" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>与<code>sed</code>类似，可以使用<code>,</code>连接两种模式来确定行范围。</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb142-1"><a href="cml.html#cb142-1" tabindex="-1"></a><span class="fu">gawk</span> <span class="st">&#39;/Jan/,/Dec/ { print $0 }&#39;</span> filelist.txt</span></code></pre></div>
<pre><code>## drwxrwxr-x     4 ZLab  staff   136B Jan 31  2022 __MACOSX
## -rw-r-----     1 ZLab  staff   2.7M Aug 27  2021 accounting.csv
## -rw-r--r--     1 ZLab  staff   2.9G Aug 19  2021 disruption_final.csv
## drwxr-xr-x    18 ZLab  staff   612B Dec 26  2019 feature</code></pre>
<p>或者联合使用关系运算符来确定行范围：</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb144-1"><a href="cml.html#cb144-1" tabindex="-1"></a><span class="fu">gawk</span> <span class="st">&#39;NR&gt;2 &amp;&amp; NR&lt;=4 { print $0 }&#39;</span> filelist.txt</span></code></pre></div>
<pre><code>## -rw-r--r--     1 ZLab  staff   2.9G Aug 19  2021 disruption_final.csv
## drwxr-xr-x    18 ZLab  staff   612B Dec 26  2019 feature</code></pre>
</div>
<div id="通过列来确定范围" class="section level4 hasAnchor" number="10.11.6.4">
<h4><span class="header-section-number">10.11.6.4</span> 通过列来确定范围<a href="cml.html#通过列来确定范围" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>我们可以通过特定列的模式来确定行范围，<code>~</code>表示匹配正则表达式，<code>~!</code>表示不匹配。</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb146-1"><a href="cml.html#cb146-1" tabindex="-1"></a><span class="fu">gawk</span> <span class="at">-v</span> FS=<span class="st">&quot;\t&quot;</span> <span class="at">-v</span> OFS=<span class="st">&quot;|&quot;</span> <span class="st">&#39;$47==2020 { print $47,$NF }&#39;</span> qje.txt <span class="kw">|</span> <span class="fu">head</span></span></code></pre></div>
<pre><code>## 2020|WOS:000507362800004
## 2020|WOS:000544015700001
## 2020|WOS:000507362800002
## 2020|WOS:000507362800010
## 2020|WOS:000593217300010
## 2020|WOS:000593217300004
## 2020|WOS:000544015700007
## 2020|WOS:000507362800008
## 2020|WOS:000593217300002
## 2020|WOS:000544017700007</code></pre>
<div class="sourceCode" id="cb148"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb148-1"><a href="cml.html#cb148-1" tabindex="-1"></a><span class="fu">gawk</span> <span class="at">-v</span> FS=<span class="st">&quot;\t&quot;</span> <span class="at">-v</span> OFS=<span class="st">&quot;|&quot;</span> <span class="st">&#39;$23~/Harvard/ { print $23,$NF }&#39;</span> qje.txt <span class="kw">|</span> <span class="fu">head</span></span></code></pre></div>
<pre><code>## [Gopinath, Gita; Stein, Jeremy C.] Harvard Univ, Cambridge, MA 02138 USA; [Gopinath, Gita; Stein, Jeremy C.] NBER, Cambridge, MA 02138 USA|WOS:000642334600003
## [Chodorow-Reich, Gabriel] Harvard Univ, Cambridge, MA 02138 USA; Natl Bur Econ Res, Cambridge, MA 02138 USA; [Coglianese, John] Fed Reserve Board Governors, Washington, DC USA; [Karabarbounis, Loukas] Univ Minnesota, Minneapolis, MN 55455 USA; [Karabarbounis, Loukas] Fed Reserve Bank, Minneapolis, MN USA|WOS:000489161300005
## [Polborn, Mattias K.] Vanderbilt Univ, Dept Econ, 221 Kirkland Hall, Nashville, TN 37235 USA; Vanderbilt Univ, Dept Polit Sci, 221 Kirkland Hall, Nashville, TN 37235 USA; Harvard Univ, Dept Govt, Cambridge, MA 02138 USA; NBER, Cambridge, MA 02138 USA|WOS:000406177000010
## [Gabaix, Xavier; Maggiori, Matteo] Harvard Univ, NYU, Stern Sch Business, Cambridge, MA 02138 USA|WOS:000359638900008
## [Beraja, Martin] MIT, Cambridge, MA 02139 USA; [Beraja, Martin; Yang, David Y.] Natl Bur Econ Res, Cambridge, MA 02138 USA; [Kao, Andrew; Yang, David Y.] Harvard Univ, Cambridge, MA USA; [Yang, David Y.] Canadian Inst Adv Res, Toronto, ON, Canada; [Yuchtman, Noam] London Sch Econ, London, England; [Yuchtman, Noam] Ctr Econ Policy Res, London, England; [Yuchtman, Noam] CESIFO, Munich, Germany|WOS:000999692200001
## [Farhi, Emmanuel] Harvard Univ, NBER, Dept Econ, Cambridge, MA 02138 USA; CEPR, Cambridge, MA USA|WOS:000423802600006
## [Edelman, Benjamin; Wright, Julian] Natl Univ Singapore, Harvard Univ, Sch Business, Dept Econ, Singapore 117548, Singapore|WOS:000359638900006
## [De Loecker, Jan] Katholieke Univ Leuven, Leuven, Belgium; NBER, Cambridge, MA 02138 USA; Ctr Econ Policy Res, London, England; [Eeckhout, Jan] Univ Pompeu Fabra Barcelona, Catalan Inst Res &amp; Adv Studies, Grad Sch Econ, Barcelona, Spain; [Unger, Gabriel] Harvard Univ, Cambridge, MA 02138 USA|WOS:000544015700001
## [Deming, David J.] Harvard Univ, Cambridge, MA 02138 USA; [Deming, David J.] NBER, Cambridge, MA 02138 USA|WOS:000412764300002
## [Fryer, Roland G., Jr.] Harvard Univ, Dept Econ, Cambridge, MA 02138 USA; [Fryer, Roland G., Jr.] NBER, Cambridge, MA 02138 USA; [Fryer, Roland G., Jr.] Harvard Univ, Educ Innovat Lab, Cambridge, MA 02138 USA|WOS:000342236000007</code></pre>
</div>
</div>
<div id="流程控制-2" class="section level3 hasAnchor" number="10.11.7">
<h3><span class="header-section-number">10.11.7</span> 流程控制<a href="cml.html#流程控制-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="条件判断-2" class="section level4 hasAnchor" number="10.11.7.1">
<h4><span class="header-section-number">10.11.7.1</span> 条件判断<a href="cml.html#条件判断-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><code>awk</code>支持条件判断语句，使用方法如下：</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb150-1"><a href="cml.html#cb150-1" tabindex="-1"></a><span class="fu">gawk</span> <span class="st">&#39; {if(NR==1){ print $1 } else if(NR==2) { print $2 } else{ print $0 }}&#39;</span> filelist.txt</span></code></pre></div>
<pre><code>## drwxrwxr-x
## 1
## -rw-r--r--     1 ZLab  staff   2.9G Aug 19  2021 disruption_final.csv
## drwxr-xr-x    18 ZLab  staff   612B Dec 26  2019 feature
## -rw-r-----     1 ZLab  staff   134M Aug 27  2021 firminvention.csv
## drwxr-xr-x  1099 ZLab  staff    36K Jun  4  2023 gp</code></pre>
</div>
<div id="循环-3" class="section level4 hasAnchor" number="10.11.7.2">
<h4><span class="header-section-number">10.11.7.2</span> 循环<a href="cml.html#循环-3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><code>awk</code>循环的格式类似于C语言</p>
<pre><code>#for循环语法格式1
for(初始化; 布尔表达式; 更新) {
//代码语句
}
 
#for循环语法格式2
for(变量 in 数组) {
//代码语句
}
 
#while循环语法
while( 布尔表达式 ) {
//代码语句
}
 
#do...while循环语法
do {
//代码语句
}while(条件)</code></pre>
<div class="sourceCode" id="cb153"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb153-1"><a href="cml.html#cb153-1" tabindex="-1"></a><span class="fu">gawk</span> <span class="st">&#39;BEGIN { for(i=1;i&lt;=5;i++){ print i } }&#39;</span></span></code></pre></div>
<pre><code>## 1
## 2
## 3
## 4
## 5</code></pre>
<p>此外，<code>continue</code>跳出当前循环；<code>break</code>跳出整个循环；<code>exit</code>用于跳出<code>awk</code>程序直接进入END模式；<code>next</code>命令结束当前行。</p>
</div>
</div>
<div id="awk数组" class="section level3 hasAnchor" number="10.11.8">
<h3><span class="header-section-number">10.11.8</span> awk数组<a href="cml.html#awk数组" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>awk</code>的数组与<code>bash</code>关联数组的结构类似，数组元素的下标默认从1开始，也可以从0开始设置下标。</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb155-1"><a href="cml.html#cb155-1" tabindex="-1"></a><span class="fu">gawk</span> <span class="st">&#39;BEGIN {stdnt[0]=&quot;张三&quot;;stdnt[1]=&quot;李四&quot;;stdnt[2]=&quot;王五&quot;;print stdnt[1]}&#39;</span></span></code></pre></div>
<pre><code>## 李四</code></pre>
<p>也可以使用字符作为数组的索引，此时数组是无序的。</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb157-1"><a href="cml.html#cb157-1" tabindex="-1"></a><span class="fu">gawk</span> <span class="st">&#39;BEGIN {stdnt[&quot;zs&quot;]=&quot;张三&quot;;stdnt[&quot;ls&quot;]=&quot;李四&quot;;stdnt[&quot;ww&quot;]=&quot;王五&quot;;for(i in stdnt){print stdnt[i]}}&#39;</span></span></code></pre></div>
<pre><code>## 李四
## 张三
## 王五</code></pre>
<p>在<code>awk</code>的数值运算中，字符串（包括空字符串）被当成0来处理。</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb159-1"><a href="cml.html#cb159-1" tabindex="-1"></a><span class="fu">gawk</span> <span class="st">&#39;BEGIN {a=&quot;&quot;;print a;a+=1;print a;a+=1;print a}&#39;</span></span></code></pre></div>
<pre><code>## 
## 1
## 2</code></pre>
<p>在数组中引用一个不存在的元素时，元素被赋值为空字符串，当对这个元素进行自加运算时，元素的值就变成了1。</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb161-1"><a href="cml.html#cb161-1" tabindex="-1"></a><span class="fu">gawk</span> <span class="st">&#39;BEGIN {print pubnum[&quot;PY&quot;]; print pubnum[&quot;PY&quot;]; pubnum[&quot;PY&quot;]++;print pubnum[&quot;PY&quot;]}&#39;</span></span></code></pre></div>
<pre><code>## 
## 
## 1</code></pre>
<p>利用上述的特性，我们可以进行计数运算：</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb163-1"><a href="cml.html#cb163-1" tabindex="-1"></a><span class="fu">sed</span> <span class="st">&quot;1d&quot;</span> qje.txt <span class="kw">|</span> <span class="fu">gawk</span> <span class="at">-v</span> FS=<span class="st">&quot;\t&quot;</span> <span class="st">&#39;{count[$47]++} END{ for(i in count) print i,count[i]}&#39;</span> </span></code></pre></div>
<pre><code>## 2014 40
## 2015 41
## 2016 40
## 2017 43
## 2018 40
## 2019 40
## 2020 40
## 2021 48
## 2022 60
## 2023 34</code></pre>
<p><code>delete</code>命令可以删除数组元素和整个数组。</p>
</div>
<div id="awk内置函数" class="section level3 hasAnchor" number="10.11.9">
<h3><span class="header-section-number">10.11.9</span> awk内置函数<a href="cml.html#awk内置函数" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>awk</code>内置函数的使用方法类似于<code>sql</code>，大致可以分类为算术函数、字符串函数、时间函数、其他函数等。</p>
<div id="算术函数" class="section level4 hasAnchor" number="10.11.9.1">
<h4><span class="header-section-number">10.11.9.1</span> 算术函数<a href="cml.html#算术函数" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>可以使用<code>rand</code>函数生成随机数，但是使用<code>rand</code>函数时，需要配合<code>srand</code>函数，否则<code>rand</code>函数返回的值将一直不变。</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb165-1"><a href="cml.html#cb165-1" tabindex="-1"></a><span class="fu">gawk</span> <span class="st">&#39;BEGIN { print rand() }&#39;</span></span>
<span id="cb165-2"><a href="cml.html#cb165-2" tabindex="-1"></a><span class="fu">gawk</span> <span class="st">&#39;BEGIN { print rand() }&#39;</span></span>
<span id="cb165-3"><a href="cml.html#cb165-3" tabindex="-1"></a><span class="fu">gawk</span> <span class="st">&#39;BEGIN { srand(); print rand() }&#39;</span></span></code></pre></div>
<pre><code>## 0.924046
## 0.924046
## 0.331276</code></pre>
<p><code>int</code>函数可以取整数：</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb167-1"><a href="cml.html#cb167-1" tabindex="-1"></a><span class="fu">gawk</span> <span class="st">&#39;BEGIN { srand(); print int(100*rand()) }&#39;</span></span></code></pre></div>
<pre><code>## 33</code></pre>
</div>
<div id="字符串函数" class="section level4 hasAnchor" number="10.11.9.2">
<h4><span class="header-section-number">10.11.9.2</span> 字符串函数<a href="cml.html#字符串函数" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><code>gsub</code>函数或<code>sub</code>函数用于替换文本，区别在于前者是全局替换。</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb169-1"><a href="cml.html#cb169-1" tabindex="-1"></a> <span class="fu">head</span> qje.txt <span class="kw">|</span><span class="fu">gawk</span> <span class="at">-v</span> FS=<span class="st">&quot;\t&quot;</span> <span class="at">-v</span> OFS=<span class="st">&quot;|&quot;</span> <span class="st">&#39;{ gsub(&quot;WOS:&quot;,&quot;&quot;,$NF); print $47,$NF }&#39;</span> </span></code></pre></div>
<pre><code>## PY|UT
## 2023|000988607500001
## 2022|000868979600001
## 2022|000813226900001
## 2022|000784752700001
## 2021|000642334600003
## 2021|000612198000011
## 2019|000489163400003
## 2019|000489161300005
## 2018|000435871300001</code></pre>
<p><code>length</code>函数用于获取指定字符串的长度。</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb171-1"><a href="cml.html#cb171-1" tabindex="-1"></a><span class="fu">head</span> qje.txt <span class="kw">|</span><span class="fu">gawk</span> <span class="at">-v</span> FS=<span class="st">&quot;\t&quot;</span> <span class="at">-v</span> OFS=<span class="st">&quot;|&quot;</span> <span class="st">&#39;{ print $47,length($NF) }&#39;</span> </span></code></pre></div>
<pre><code>## PY|3
## 2023|20
## 2022|20
## 2022|20
## 2022|20
## 2021|20
## 2021|20
## 2019|20
## 2019|20
## 2018|20</code></pre>
<p><code>split</code>函数可以将指定的字符串按照指定的分割符切割，将切割后的每一段赋值到数组的元素中，从而动态的创建数组。</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb173-1"><a href="cml.html#cb173-1" tabindex="-1"></a><span class="fu">head</span> qje.txt <span class="kw">|</span><span class="fu">gawk</span> <span class="at">-v</span> FS=<span class="st">&quot;\t&quot;</span> <span class="at">-v</span> OFS=<span class="st">&quot;|&quot;</span> <span class="st">&#39;{split($2,a,&quot;;&quot;);for(i in a){print a[i],$NF}}&#39;</span> </span></code></pre></div>
<pre><code>## AU|UT
## Guarnieri, E|WOS:000988607500001
##  Tur-Prats, A|WOS:000988607500001
## Smith, M|WOS:000868979600001
##  Zidar, O|WOS:000868979600001
##  Zwick, E|WOS:000868979600001
## Cai, J|WOS:000813226900001
##  Wang, SY|WOS:000813226900001
## Adao, R|WOS:000784752700001
##  Carrillo, P|WOS:000784752700001
##  Costinot, A|WOS:000784752700001
##  Donaldson, D|WOS:000784752700001
##  Pomeranz, D|WOS:000784752700001
## Gopinath, G|WOS:000642334600003
##  Stein, JC|WOS:000642334600003
## Kim, R|WOS:000612198000011
## Allcott, H|WOS:000489163400003
##  Diamond, R|WOS:000489163400003
##  Dubé, JP|WOS:000489163400003
##  Handbury, J|WOS:000489163400003
##  Rahkovsky, I|WOS:000489163400003
##  Schnell, M|WOS:000489163400003
## Chodorow-Reich, G|WOS:000489161300005
##  Coglianese, J|WOS:000489161300005
##  Karabarbounis, L|WOS:000489161300005
## Piketty, T|WOS:000435871300001
##  Saez, E|WOS:000435871300001
##  Zucman, G|WOS:000435871300001</code></pre>
</div>
</div>
<div id="排序函数" class="section level3 hasAnchor" number="10.11.10">
<h3><span class="header-section-number">10.11.10</span> 排序函数<a href="cml.html#排序函数" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>asort</code>函数根据元素的值进行排序，经过asort函数排序过后的数组的下标将会被重置为纯数字</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb175-1"><a href="cml.html#cb175-1" tabindex="-1"></a><span class="fu">gawk</span> <span class="st">&#39;BEGIN{t[&quot;a&quot;]=33;t[&quot;b&quot;]=2;t[&quot;c&quot;]=83;asort(t); for(i in t){ print i,t[i]}}&#39;</span> </span></code></pre></div>
<pre><code>## 1 2
## 2 33
## 3 83</code></pre>
<p><code>asorti</code>函数根据元素的下表进行排序，将排序后的下标放置到一个新的数组中。</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb177-1"><a href="cml.html#cb177-1" tabindex="-1"></a><span class="fu">gawk</span> <span class="st">&#39;BEGIN{t[&quot;z&quot;]=33;t[&quot;b&quot;]=2;t[&quot;c&quot;]=83;asorti(t,newt); for(i in newt){ print i,newt[i]}}&#39;</span> </span></code></pre></div>
<pre><code>## 1 b
## 2 c
## 3 z</code></pre>
<p><code>asort</code>函数与<code>asorti</code>函数的返回值均是字符串长度。</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb179-1"><a href="cml.html#cb179-1" tabindex="-1"></a><span class="fu">gawk</span> <span class="st">&#39;BEGIN{t[&quot;z&quot;]=33;t[&quot;b&quot;]=2;t[&quot;c&quot;]=83;l=asorti(t,newt); for(i=1;i&lt;=l;i++){ print i,newt[i]}}&#39;</span> </span></code></pre></div>
<pre><code>## 1 b
## 2 c
## 3 z</code></pre>
</div>
</div>
<div id="数据驱动的编程" class="section level2 hasAnchor" number="10.12">
<h2><span class="header-section-number">10.12</span> 数据驱动的编程<a href="cml.html#数据驱动的编程" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><code>sed</code>与<code>awk</code>都是数据驱动（data-driven）的编程语言。传统的编程思维是将为实现一定目的而进行的一系列“动作”（也可以将动作理解为事件）通过流程控制语句组合成为一段代码，经过编译之后交由计算机执行。在这个过程中，通过不同的数据结构来表示外部世界，动作触发对数据的修改。同一个任务，使用不同的数据结构以及设计不同的动作流程，对应着不同的执行效率。数据驱动的编程反其道而行之，从数据（文件）出发，针对数据的不同模式定义动作来处理数据。相比于设计程序流程，人类更擅长直接处理数据，因此数据驱动的编程变成更符合人类的思维习惯。另一方面，数据驱动的编程实质上是对数据进行逐行的修改，自带循环结构，同时无论数据文件大小，内存中只需要处理一行数据，摆脱了内存的限制，天生适合处理大数据文件。综上，充分利用好数据驱动的编程工具，可以简化代码结构，提升大数据的处理效率。</p>
<p>思考题：数据驱动的编程有哪些弱点？</p>
<p><strong>不同版本的shell可以写一段</strong></p>
<p>这里记录一下</p>
</div>
<div id="r的命令行选项" class="section level2 hasAnchor" number="10.13">
<h2><span class="header-section-number">10.13</span> R的命令行选项<a href="cml.html#r的命令行选项" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>为了能够使用Make来构建完整的数据自动分析流程，我们就需要R代码能够从命令行解析参数并在R代码中使用。argparse包是受到Python中同名包的启发开发的，其用法与Python中接近，可以让我们在跨语言编程的时候更加轻松。</p>
<div id="linuxunix-shebang" class="section level3 hasAnchor" number="10.13.1">
<h3><span class="header-section-number">10.13.1</span> Linux/Unix Shebang<a href="cml.html#linuxunix-shebang" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>在命令行中运行R脚本，可以使用<code>Rscript example.R</code>的方式，其中<code>example.R</code>是我们希望运行的脚本。在Linux和Unix系统中，有一种更简洁的方式，即通过在脚本第一行添加<code>#! /usr/bin/env Rscript</code>的方式，来告诉操作系统这段脚本的要调用Rscript来运行。此时只要进入到<code>example.R</code>所在的路径中，使用命令<code>./exmaple.R</code>便可以直接运行这段代码。类似地，如果是一段Python3脚本的话，我们可以使用`<code>#! /usr/bin/env Python3</code></p>
<p>另外，<code>!#</code>被称作Shebang，翻译过来就是”井号叹号”，上一次我听到这么草率的命名还是我办公室所在的”新建楼”。</p>
</div>
<div id="argparse包实例" class="section level3 hasAnchor" number="10.13.2">
<h3><span class="header-section-number">10.13.2</span> argparse包实例<a href="cml.html#argparse包实例" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>argparse包使用起来非常简洁，也没有太多函数。我们其官方教程中的一个实例来介绍如何使用它。</p>
<p>在命令行中的参数可以完整参数(用<code>--</code>调用)，与短参数(用<code>-</code>调用)，同时每一个参数都有其缺省值，以及对应的帮助文档解释。命令行参数本身有各种灵活的设置方式，感兴趣的读者可以进一步阅读Data Science at the Command Line.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>。详细介绍这部分内容并不是本书的使命。</p>
<p>argparse包分为三个步骤，第一步是使用<code>ArgumentParser()</code>创建一个参数解析对象，第二步是使用<code>add_argument</code>函数为前面的对象增加参数，第三步是通过<code>parse_args()</code>把解析对象赋值并在后续程序中调用。</p>
<p>我们可以先把下面的脚本储存成为<code>example.R</code>，这段脚本的作用是输出若干个随机数，具体的随机分布与输出参数数量由命令行参数决定。</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="cml.html#cb181-1" tabindex="-1"></a><span class="co">#! /usr/bin/env Rscript</span></span>
<span id="cb181-2"><a href="cml.html#cb181-2" tabindex="-1"></a><span class="fu">library</span>(argparse)</span>
<span id="cb181-3"><a href="cml.html#cb181-3" tabindex="-1"></a></span>
<span id="cb181-4"><a href="cml.html#cb181-4" tabindex="-1"></a><span class="co"># 创建参数解析对象</span></span>
<span id="cb181-5"><a href="cml.html#cb181-5" tabindex="-1"></a>parser <span class="ot">&lt;-</span> <span class="fu">ArgumentParser</span>()</span>
<span id="cb181-6"><a href="cml.html#cb181-6" tabindex="-1"></a></span>
<span id="cb181-7"><a href="cml.html#cb181-7" tabindex="-1"></a><span class="co"># 设置参数</span></span>
<span id="cb181-8"><a href="cml.html#cb181-8" tabindex="-1"></a><span class="co"># 设置第一个参数verbose，缩写为v，其作用是告诉脚本是否打印完整的计算过程，其缺省值为TRUE</span></span>
<span id="cb181-9"><a href="cml.html#cb181-9" tabindex="-1"></a>parser<span class="sc">$</span><span class="fu">add_argument</span>(<span class="st">&quot;-v&quot;</span>, <span class="st">&quot;--verbose&quot;</span>, <span class="at">action=</span><span class="st">&quot;store_true&quot;</span>, <span class="at">default=</span><span class="cn">TRUE</span>,</span>
<span id="cb181-10"><a href="cml.html#cb181-10" tabindex="-1"></a>        <span class="at">help=</span><span class="st">&quot;Print extra output [default]&quot;</span>)</span>
<span id="cb181-11"><a href="cml.html#cb181-11" tabindex="-1"></a></span>
<span id="cb181-12"><a href="cml.html#cb181-12" tabindex="-1"></a><span class="co"># 设置第二个参数quietly，缩写为q，其作用是修改verbose参数，当调用改参数时，verbose被修改为FALSE，从而导致不再打印计算过程</span></span>
<span id="cb181-13"><a href="cml.html#cb181-13" tabindex="-1"></a>parser<span class="sc">$</span><span class="fu">add_argument</span>(<span class="st">&quot;-q&quot;</span>, <span class="st">&quot;--quietly&quot;</span>, <span class="at">action=</span><span class="st">&quot;store_false&quot;</span>, </span>
<span id="cb181-14"><a href="cml.html#cb181-14" tabindex="-1"></a>        <span class="at">dest=</span><span class="st">&quot;verbose&quot;</span>, <span class="at">help=</span><span class="st">&quot;Print little output&quot;</span>)</span>
<span id="cb181-15"><a href="cml.html#cb181-15" tabindex="-1"></a></span>
<span id="cb181-16"><a href="cml.html#cb181-16" tabindex="-1"></a><span class="co"># 设置第三个参数count，缩写为c，这是一个整数参数，缺省值5，在后续的代码中被用作确定输出随机数的个数</span></span>
<span id="cb181-17"><a href="cml.html#cb181-17" tabindex="-1"></a>parser<span class="sc">$</span><span class="fu">add_argument</span>(<span class="st">&quot;-c&quot;</span>, <span class="st">&quot;--count&quot;</span>, <span class="at">type=</span><span class="st">&quot;integer&quot;</span>, <span class="at">default=</span><span class="dv">5</span>, </span>
<span id="cb181-18"><a href="cml.html#cb181-18" tabindex="-1"></a>        <span class="at">help=</span><span class="st">&quot;Number of random normals to generate [default %(default)s]&quot;</span>,</span>
<span id="cb181-19"><a href="cml.html#cb181-19" tabindex="-1"></a>        <span class="at">metavar=</span><span class="st">&quot;number&quot;</span>)</span>
<span id="cb181-20"><a href="cml.html#cb181-20" tabindex="-1"></a></span>
<span id="cb181-21"><a href="cml.html#cb181-21" tabindex="-1"></a><span class="co"># 设置第四个参数generator，无缩写，用于确定调用何种随机分布，缺省值rnorm对应于正态分布</span></span>
<span id="cb181-22"><a href="cml.html#cb181-22" tabindex="-1"></a>parser<span class="sc">$</span><span class="fu">add_argument</span>(<span class="st">&quot;--generator&quot;</span>, <span class="at">default=</span><span class="st">&quot;rnorm&quot;</span>, </span>
<span id="cb181-23"><a href="cml.html#cb181-23" tabindex="-1"></a>        <span class="at">help =</span> <span class="st">&quot;Function to generate random deviates [default </span><span class="sc">\&quot;</span><span class="st">%(default)s</span><span class="sc">\&quot;</span><span class="st">]&quot;</span>)</span>
<span id="cb181-24"><a href="cml.html#cb181-24" tabindex="-1"></a></span>
<span id="cb181-25"><a href="cml.html#cb181-25" tabindex="-1"></a><span class="co"># 设置第五个参数mean，无缩写，浮点数，用于确定正态分布的均值，缺省值为0</span></span>
<span id="cb181-26"><a href="cml.html#cb181-26" tabindex="-1"></a>parser<span class="sc">$</span><span class="fu">add_argument</span>(<span class="st">&quot;--mean&quot;</span>, <span class="at">default=</span><span class="dv">0</span>, <span class="at">type=</span><span class="st">&quot;double&quot;</span>,</span>
<span id="cb181-27"><a href="cml.html#cb181-27" tabindex="-1"></a>        <span class="at">help=</span><span class="st">&quot;Mean if generator == </span><span class="sc">\&quot;</span><span class="st">rnorm</span><span class="sc">\&quot;</span><span class="st"> [default %(default)s]&quot;</span>)</span>
<span id="cb181-28"><a href="cml.html#cb181-28" tabindex="-1"></a></span>
<span id="cb181-29"><a href="cml.html#cb181-29" tabindex="-1"></a><span class="co"># 设置第五个参数sd，无缩写，浮点数，用于确定正态分布的标准差，缺省值为1</span></span>
<span id="cb181-30"><a href="cml.html#cb181-30" tabindex="-1"></a>parser<span class="sc">$</span><span class="fu">add_argument</span>(<span class="st">&quot;--sd&quot;</span>, <span class="at">default=</span><span class="dv">1</span>, <span class="at">type=</span><span class="st">&quot;double&quot;</span>,</span>
<span id="cb181-31"><a href="cml.html#cb181-31" tabindex="-1"></a>        <span class="at">metavar=</span><span class="st">&quot;standard deviation&quot;</span>,</span>
<span id="cb181-32"><a href="cml.html#cb181-32" tabindex="-1"></a>        <span class="at">help=</span><span class="st">&quot;Standard deviation if generator == </span><span class="sc">\&quot;</span><span class="st">rnorm</span><span class="sc">\&quot;</span><span class="st"> [default %(default)s]&quot;</span>)</span>
<span id="cb181-33"><a href="cml.html#cb181-33" tabindex="-1"></a></span>
<span id="cb181-34"><a href="cml.html#cb181-34" tabindex="-1"></a><span class="co"># 调用解析器，此时args就被赋值为命令行参数输入的相应值</span></span>
<span id="cb181-35"><a href="cml.html#cb181-35" tabindex="-1"></a>args <span class="ot">&lt;-</span> parser<span class="sc">$</span><span class="fu">parse_args</span>()</span>
<span id="cb181-36"><a href="cml.html#cb181-36" tabindex="-1"></a></span>
<span id="cb181-37"><a href="cml.html#cb181-37" tabindex="-1"></a><span class="co"># 根据verbose确定是否打印计算过程</span></span>
<span id="cb181-38"><a href="cml.html#cb181-38" tabindex="-1"></a><span class="cf">if</span> ( args<span class="sc">$</span>verbose ) { </span>
<span id="cb181-39"><a href="cml.html#cb181-39" tabindex="-1"></a>        <span class="fu">write</span>(<span class="st">&quot;writing some verbose output to standard error...</span><span class="sc">\n</span><span class="st">&quot;</span>, <span class="fu">stderr</span>()) </span>
<span id="cb181-40"><a href="cml.html#cb181-40" tabindex="-1"></a>}</span>
<span id="cb181-41"><a href="cml.html#cb181-41" tabindex="-1"></a></span>
<span id="cb181-42"><a href="cml.html#cb181-42" tabindex="-1"></a><span class="co"># 根据其他参数，确定输出随机数的类型与次数</span></span>
<span id="cb181-43"><a href="cml.html#cb181-43" tabindex="-1"></a><span class="cf">if</span>( args<span class="sc">$</span>generator <span class="sc">==</span> <span class="st">&quot;rnorm&quot;</span>) {</span>
<span id="cb181-44"><a href="cml.html#cb181-44" tabindex="-1"></a>        <span class="fu">cat</span>(<span class="fu">paste</span>(<span class="fu">rnorm</span>(args<span class="sc">$</span>count, <span class="at">mean=</span>args<span class="sc">$</span>mean, <span class="at">sd=</span>args<span class="sc">$</span>sd), <span class="at">collapse=</span><span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>))</span>
<span id="cb181-45"><a href="cml.html#cb181-45" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb181-46"><a href="cml.html#cb181-46" tabindex="-1"></a>        <span class="fu">cat</span>(<span class="fu">paste</span>(<span class="fu">do.call</span>(args<span class="sc">$</span>generator, <span class="fu">list</span>(args<span class="sc">$</span>count)), <span class="at">collapse=</span><span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>))</span>
<span id="cb181-47"><a href="cml.html#cb181-47" tabindex="-1"></a>}</span>
<span id="cb181-48"><a href="cml.html#cb181-48" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<p>之后我们需要首先在命令行修改脚本的权限，为其添加可执行权限</p>
<pre><code>sudo chmod +x example.R</code></pre>
<p>然后便可以执行该脚本，例如我们可以查该脚本对应的帮助，</p>
<pre><code>./example.R --help</code></pre>
<p>输出结果为：
<img src="argparser1.png" width="100%" /></p>
<p>或者使用参数输出3个正态分布随机数。</p>
<pre><code>./example.R --mean=10 --sd=10 --count=3</code></pre>
<p>输出结果如下：
<img src="argparser2.png" width="100%" /></p>
<p>也可以输出均匀分布的随机数，并且选择不打印计算过程。</p>
<pre><code>./example.R --quiet -c 4 --generator=&quot;runif&quot;</code></pre>
<p>输出结果如下：
<img src="argparser3.png" width="100%" /></p>
</div>
</div>
<div id="关于命令行与ide" class="section level2 hasAnchor" number="10.14">
<h2><span class="header-section-number">10.14</span> 关于命令行与IDE<a href="cml.html#关于命令行与ide" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>相信很多人和我一样，一开始接触程序设计语言的时候，都会先接触IDE（Integrated Development Environment），例如<code>Rstudio</code>和<code>Pycharm</code>。每个语言都有一款甚至多款配套的优秀IDE，它们开发了各种效率工具，例如，语法高亮、自动补全、快捷键、错误提醒、编译和调试等，让编程更加丝滑。久而久之，我们也在无形之中产生了对IDE的依赖，一款IDE越是成功，这样的依赖就越强。以至于有一段时间，我离开<code>Rstudio</code>就会手足无措，并且曾一度设想，用<code>Rstudio</code>统一写作所有程序语言。虽然确实可以这么做，但并不是最佳选择。IDE会成为语言切换的障碍，阻碍进一步修炼。我就听有人说过，因为没有找到<code>Rstudio</code>在<code>python</code>总的替代物，因此一直使用<code>R</code>语言从事<code>python</code>更加擅长的工作。</p>
<p>决大多数情形中，我们的工作对象是数据，换句话说就是文件，而命令行天生就是针对文件的语言与环境。在命令行中，我们随手一个小命令就可以对文件进行查看和编辑，效率非常高。命令行作为其他语言的基础环境，可以轻松地连接不同语言的脚本。</p>
<p>回到命令行，才是数据工程最终的归宿。在命令行的黑魔法世界中，更有利于我们从根本上提升生产力，在不远的将来，做到手中无剑，心中有剑，人剑合一。</p>
<p>参考资料：
Data Science at the Command Line</p>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p><a href="https://www.datascienceatthecommandline.com/1e/" class="uri">https://www.datascienceatthecommandline.com/1e/</a><a href="cml.html#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="regexp.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="web.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/yihui/bookdown-chinese/edit/master/10-commandline.Rmd",
"text": "编辑"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["dataengeering.pdf", "dataengeering.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "none"
}
});
});
</script>

</body>

</html>
