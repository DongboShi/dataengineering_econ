\mainmatter

# Python基础 {#py}

> 你总是给自己设置障碍，因为你不敢。*---邪不压正*

## Python简介

本章我们介绍`Python`的基础知识。在这之前，读者可能会好奇，为什么又多了一个语言？我们已经学习了`R语言`和`SQL语言`，接触了`bash`，在未来还要学习`html语言`和`正则表达式`。之所以学习这么多语言是因为数据工程中涵盖了多种多样的任务，针对不同的任务往往有不同的最佳工具。与其追求在一个语言中费劲完成

正如在第三章介绍的，尽管`R语言`非常强大，但是它毕竟不是一个通用语言，在很多任务上，效率并不高。例如，绝大多数的`API`都使用的是`Python`语法，这就极大限制了`R语言`的应用场景。因此，我们需要学习一门通用语言，

`Python`也是一门解释性语言，对于编译型语言如`C/C++`它更容易调试。`Python`的语法如`R语言`一般简洁易懂。`Python`是一个通用语言可，在生活中的方方面面都可以使用。

`Python`的软件库丰富，可以完成非常多其他的功能。`Python`可以将跨语言的程序粘合在一起，是天生的“胶水语言”，非常适合跨语言协作。

由于以上优点，`Python`成为当前最流行的编程语言。`Python`的出现大大降低了编程的门槛，程序员供给数量指数增多。

更重要的是，学习编程语言在总收益不变的情况下，边际成本是断崖式下降的，假设大家在学习`R语言`时候用了100%的努力，在学习`Python`时只用付出25%的努力，就可以快速掌握`Python`，但是编程能力和视野会翻倍。在未来深入学习`bash`时，只用付出10%的努力即可。不同的编程语言更是代表了不同的世界观，在增加技能的同时，让我们的用于更多看待世界的角度。

## Python安装与Pycharm

### 安装
`Python`存在两个版本主要版本，`Python2`和`Python3`。`Python3`是针对`Python2`的一次大规模改进，以至于很多`Python2`的程序无法在`Python3`中运行，因此可以将两者看做是不同的语言，以避免混淆出错。

Windows用户在WSL环境中使用`apt`命令安装`python3`。

```
apt install python3
```

R用户可以通过`brew`或者在`Gentoo prefix`中的`merge`命令安装。

```
brew install python3
```

### 编辑器

`Python`有一个增强式编译环境，`Ipython`可用于交互式编程。还提供了`Jupyter`，是`IPython`发展而来的可以在网页上进行交互式编程的环境。它的交互性更强，可以规避掉命令行，上手容易，适合写教程。但是，网页并不能替代编辑器，不适合写大段程序，也没有批量处理能力。如果是只是学会了`Jupyter`就以为自己学会了编程，到处招摇过市，会暴露自己的无知与傲慢。因此，不推荐大家将其作为编辑器使用。

我们推荐`Pycharm Professional`作为`Python`的编辑器（[下载地址](https://www.jetbrains.com/pycharm/download/?section=mac)），这是一款不逊色于`Rstudio`的编辑器，且为教育机构用户提供免费的权限。`Pycharm`不仅继承了语法高亮、自动补全以及版本控制等基本功能，更是集合了远程服务器编译功能，让远程调试非常便捷，这是一个`Rstudio`都没有的功能。同时，`Pycharm`也支持跨语言编辑。

**这里缺一个pycharm教程（后面补上）**。


此外`Rstudio`也是可以兼容python的，使用`reticulate::repl_python()`即可将`Console`的编译环境变成`python`环境。在做一些小命令尝试的时候，可以直接在Rtudio中编程，而不需要特别转换工作环境。毕竟，任何环境的转换都是需要成本的。

## 变量

`Python`变量使用`=`赋值与修改，变量既可以是最基本的数据类型，也可以是复杂的数据结构，甚至是新的类实体。`print`函数可以将变量输出到屏幕。


```python
a = "hello world"
print(a)
```

```
## hello world
```

## 数据类型

`Python`有物种数据类型：整型（精度无限的整数）、浮点型（64位高精度小数）、字符串和`None`。字符串引号（单引号或双引号）标注、布尔型（`Ture`和`False`）。

`None`是`Python`中一个特别的值，即不是整数也不是浮点数，属于一种独有的类型。可以代表很多含义：“空”或者“没有”，或者“无法表达”，或者“出错了”、“非法”。转换为布尔类型时，None 的赋值为“假”。

`type`函数可以查看的数据类型。


```python
type(1)
```

```
## <class 'int'>
```

```python
type(3.14)
```

```
## <class 'float'>
```

```python
type("hello world")
```

```
## <class 'str'>
```

```python
type(True)
```

```
## <class 'bool'>
```

```python
type(None)
```

```
## <class 'NoneType'>
```

### 类型转换

`int`、`float`、`str`和`bool`函数可以转换数据类型。与`R`一样，不是所有类型都可以互相转换的，转换不及会报错。

### 算术运算

`+-*/`用于四则运算，幂运算使用两个星号，`//`表示整除，`%`为取余数。


```python
3 + 3
```

```
## 6
```

```python
3 - 3
```

```
## 0
```

```python
3 * 3
```

```
## 9
```

```python
3 / 2
```

```
## 1.5
```

```python
3 ** 6
```

```
## 729
```

```python
3 // 2
```

```
## 1
```

```python
4 % 2
```

```
## 0
```

更复杂的运算，可以导入`math`模块，例如阶乘。


```python
import math
math.factorial(10)
```

```
## 3628800
```

注意，在`Python`里面整数是高精度的，具体多少精度，取决于计算机的硬件水平。`Python`会自行做出判断，用计算效率损失来换取人类在编程时候的方便。这样的恰恰适合经济学家，如果能够节省人类的时间，不惜浪费计算机的时间；通过升级硬件来节约计算机的时间。

### 布尔运算

`and`，`or`，`not`是`Python`中的“与或非”运算。


```python
True and False
```

```
## False
```

```python
True or False
```

```
## True
```

```python
not True
```

```
## False
```
`<`、`<=`、`>`、`>=`、`==`，`!=`用于数值比较，生成布尔型。


```python
3 > 2
```

```
## True
```

```python
2 != 2
```

```
## False
```

在`Python`内部，布尔型被储存成整数型的0和1，因此可进行算术运算。


```python
2 + True
```

```
## 3
```

```python
2 > False
```

```
## True
```

### 字符串

`Python`有非常强大的字符串工具库，针对单个字符串，`Python`开发了非常强大的属性与操作。很多操作让R用户眼睛瞪得像铜铃。例如，用加法和乘法，定义字符串的拼接与重复。


```python
"3.14" + "15926"
```

```
## '3.1415926'
```

```python
"重要的话说三次！"*3
```

```
## '重要的话说三次！重要的话说三次！重要的话说三次！'
```
`len`函数可以得到字符串的长度。


```python
len("3.1415")
```

```
## 6
```

### 字符串的替换

`.format`函数可以实现灵活的字符串替换，例如，


```python
"我感觉{}还需要{}，你们毕竟还是{}，你明白这意思吧？我告诉你们我是{}了，见得多了，西方哪一个{}我没有去过？你们要知道，美国的{}，比你们不知道要{}到哪里去了，我跟他{}。".format("你们新闻界","学习","too young","身经百战","国家","华莱士","高","谈笑风生")
```

```
## '我感觉你们新闻界还需要学习，你们毕竟还是too young，你明白这意思吧？我告诉你们我是身经百战了，见得多了，西方哪一个国家我没有去过？你们要知道，美国的华莱士，比你们不知道要高到哪里去了，我跟他谈笑风生。'
```

其中，变的部分用`{}`表示，`.format`中的参数与前面的`{}`一一对应。

`f-string`可以实现同样的功能，在数据输出时经常使用。


```python
a = 3
b = 5
f"{a}乘以{b}等于{a*b}"
```

```
## '3乘以5等于15'
```


### 字符串的切片

直接用`[]`就可以取出字符串的子集，注意`Python`从0开始编号，且使用左闭右开区间，跨语言使用时别出错。


```python
a = "hello world"
a[0],a[2:4]
```

```
## ('h', 'll')
```

### 标准字符串操作

`Python`的官方文档详尽介绍了标准库中字符串的进阶操作，推荐大家自己学一遍。我们介绍一些常用操作。

|操作|作用|
|:----|:------------|
|`.count`|统计字符出现的次数|
|`.startwith`|判断字符串是否由某个子串开头|
|`.split`|将字符串按照给定的分隔符分成列表|
|`.replace`|一一替换字符|


```python
seed = bin(2324)
print(seed)
```

```
## 0b100100010100
```

```python
print(seed.replace('0',"奥").replace('1',"利"))
```

```
## 奥b利奥奥利奥奥奥利奥利奥奥
```

## 标准输入输出

### 标准输入

`input`函数可以键盘得到输入。


```python
x = input()
```
标准输入默认输入数据类型为字符串，因此，当需要数字时，需要进行类型转换。标准输入使程序可与外界交互，输入信息被赋给了变量。输入可以由人给出，也可以由其它程序给出。

### 命令执行

`Python`默认一个命令独立成行，如果需要多个命令写在一行中，需要用分号连接不同的命令。

## 数据结构


## 数据读写

## 流程控制

### 条件判断

### 循环

上面的内容可以本周内完成，然后写作更详细的东西。


## 函数与模块


## 面向对象
